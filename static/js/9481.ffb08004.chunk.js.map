{"version":3,"file":"static/js/9481.ffb08004.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/ImageryTileLayerView3D.js","../node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{unwrap as t,isNone as i}from\"../../../core/maybe.js\";import{whenTrueOnce as s}from\"../../../core/watchUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as o}from\"./LayerView3D.js\";import{TiledLayerView3D as n}from\"./TiledLayerView3D.js\";import{RasterTile as m}from\"../terrain/RasterTile.js\";import{ImageryTileLayerView as p}from\"../../layers/ImageryTileLayerView.js\";import h from\"../../layers/LayerView.js\";import{RefreshableLayerView as c}from\"../../layers/RefreshableLayerView.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";import{getWebGLCapabilities as d}from\"../../webgl/capabilities.js\";import{ContextType as g}from\"../../webgl/context-util.js\";let f=class extends(p(c(n(o(h))))){constructor(){super(...arguments),this.type=\"imagery-tile-3d\",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new r(\"layerview:spatial-reference-incompatible\",\"The layer extent cannot be projected to the view's spatial reference\",{layer:this.layer})));const e=s(this.view,\"basemapTerrain.tilingSchemeLocked\").then((()=>{const e=this.view.basemapTerrain.tilingScheme,{tileInfo:r}=this.layer,t=[\"png\",\"png24\",\"png32\",\"jpg\",\"mixed\"].indexOf(r.format)>-1&&e.compatibleWith(r);this.isAlignedMapTile=t;const i=t?r:e.toTileInfo();this.tileInfo=i,this.updatingHandles.add((()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition]),(()=>this.refresh()))}));this.addResolvingPromise(e)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const e=document.createElement(\"canvas\"),r=e.getContext(\"2d\"),[t,i]=this.tileInfo.size;return e.width=t,e.height=i,r.clearRect(0,0,t,i),r.getImageData(0,0,t,i)}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){const e=this.tileInfo.lods,r=this.layer.tileInfo.lods,t=e[0].scale,i=r[r.length-1].scale;return this.levelRangeFromScaleRange(t,i)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}async fetchTile(e,r,s,a){const l=this.tileInfo,o=this._canSymbolizeInWebGL(),n={tileInfo:l,requestRawData:o,signal:t(a.signal),requestAsImageElement:this.isAlignedMapTile},p=await this.layer.fetchTile(e,r,s,n);if(p instanceof HTMLImageElement)return p;let h=p&&p.pixelBlock;if(i(h))return this._blankTile;if(!o&&(h=await this.layer.applyRenderer(p),i(h)))return this._blankTile;const c=new m([e,r,s],h,l.size[0],l.size[1]);return o?(c.symbolizerRenderer=this.layer.symbolizer.rendererJSON,c.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e)),c.transformGrid=p.transformGrid):c.isRendereredSource=!0,c.interpolation=this.layer.interpolation,c.bandIds=this.layer.bandIds,c}_getSymbolizerOptions(e){const r=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:r,y:r},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}createFetchPopupFeaturesQueryGeometry(e,r){return y(e,r,this.view)}refresh(){this.emit(\"data-changed\")}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_canSymbolizeInWebGL(){const e=d(this.view._stage.renderView.renderingContext.type);return(e.type===g.WEBGL2||e.supportsTextureFloat)&&this.layer.symbolizer.canRenderInWebGL}};e([a({readOnly:!0})],f.prototype,\"_blankTile\",null),e([a({readOnly:!0})],f.prototype,\"imageFormatIsOpaque\",null),e([a({readOnly:!0})],f.prototype,\"hasMixedImageFormats\",null),e([a({readOnly:!0})],f.prototype,\"dataLevelRange\",null),f=e([l(\"esri.views.3d.layers.ImageryTileLayerView3D\")],f);const u=f;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{unwrap as i,isSome as o}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as n}from\"../../layers/support/commonProperties.js\";import{getDefaultDatumTransformationForDataset as l,projectExtent as u}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as p}from\"./support/popupUtils.js\";const m=m=>{let f=class extends m{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return l(i(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(t){return!!this.projectFullExtent(t)}projectFullExtent(t){const e=i(this.layer.fullExtent),r=l(e,t,!1);return u(e,t,r)}async fetchPopupFeatures(t,i){const{layer:s}=this;if(!t)return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const{popupEnabled:a}=s,n=p(s,i);if(!a||!o(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const l=[],{value:u,magdirValue:m}=await s.identify(t,{timeExtent:this.timeExtent});let f=\"\";if(u&&u.length){var c,d;f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((t=>s.getStandardTimeValue(t))).join(\", \"):u.join(\", \");const t={ObjectId:0},r=\"Raster.ServicePixelValue\";t[r]=this._formatAttributeValue(f,r);const i=null==(c=s.rasterInfo)||null==(d=c.attributeTable)?void 0:d.features;if(i&&i.length>0){const e=i.filter((t=>{const e=t.attributes.value||t.attributes.Value||t.attributes.VALUE;return String(e)===f}));if(e.length>0){const r=e[0];if(r)for(const e in r.attributes)if(r.attributes.hasOwnProperty(e)){const i=this._rasterFieldPrefix+e;t[i]=this._formatAttributeValue(r.attributes[e],i)}}}const o=s.rasterInfo.dataType;\"vector-magdir\"!==o&&\"vector-uv\"!==o||(t[\"Raster.Magnitude\"]=null==m?void 0:m[0],t[\"Raster.Direction\"]=null==m?void 0:m[1]);const a=new e(this.fullExtent.clone(),null,t);a.layer=s,a.sourceLayer=a.layer,l.push(a)}return l}_formatAttributeValue(t,e){if(\"string\"==typeof t){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,e),o=i&&i.format;if(o){let e,r;return t.trim().indexOf(\",\")>-1?(e=\",\",r=e+\" \",this._formatDelimitedString(t,e,r,o)):t.trim().indexOf(\" \")>-1?(e=r=\" \",this._formatDelimitedString(t,e,r,o)):this._formatNumberFromString(t,o)}}return t}_getFieldInfo(t,e){if(!t||!t.length||!e)return;const r=e.toLowerCase();let i;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==r&&t.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=t,!0))),i}_formatDelimitedString(t,e,r,i){return t&&e&&r&&i?t.trim().split(e).map((t=>this._formatNumberFromString(t,i))).join(r):t}_formatNumberFromString(t,e){if(!t||!e)return t;const r=Number(t);return isNaN(r)?t:e.format(r)}};return t([s()],f.prototype,\"layer\",void 0),t([s(n)],f.prototype,\"timeExtent\",void 0),t([s()],f.prototype,\"view\",void 0),t([s()],f.prototype,\"fullExtent\",null),t([s()],f.prototype,\"tileInfo\",void 0),t([s({readOnly:!0})],f.prototype,\"hasTilingEffects\",null),f=t([a(\"esri.views.layers.ImageryTileLayerView\")],f),f};export{m as ImageryTileLayerView,m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"names":["f","p","c","n","o","h","constructor","super","arguments","this","type","isAlignedMapTile","initialize","layer","increaseRasterJobHandlerUsage","fullExtent","addResolvingPromise","Promise","reject","r","e","s","view","then","basemapTerrain","tilingScheme","tileInfo","t","indexOf","format","compatibleWith","i","toTileInfo","updatingHandles","add","renderer","interpolation","bandIds","multidimensionalDefinition","refresh","destroy","decreaseRasterJobHandlerUsage","_blankTile","document","createElement","getContext","size","width","height","clearRect","getImageData","imageFormatIsOpaque","hasMixedImageFormats","dataLevelRange","lods","scale","length","levelRangeFromScaleRange","_getfullExtent","projectFullExtent","spatialReference","async","a","l","_canSymbolizeInWebGL","requestRawData","signal","requestAsImageElement","fetchTile","HTMLImageElement","pixelBlock","applyRenderer","m","symbolizerRenderer","symbolizer","rendererJSON","symbolizerParameters","generateWebGLParameters","_getSymbolizerOptions","transformGrid","isRendereredSource","lodAt","resolution","isGCS","isGeographic","x","y","ensureSymbolizerParameters","JSON","stringify","lij","createFetchPopupFeaturesQueryGeometry","emit","suspended","d","_stage","renderView","renderingContext","g","supportsTextureFloat","canRenderInWebGL","readOnly","prototype","u","_rasterFieldPrefix","hasTilingEffects","dynamicRangeAdjustment","datumTransformation","supportsSpatialReference","popupEnabled","popupTemplate","value","magdirValue","identify","timeExtent","hasStandardTime","map","getStandardTimeValue","join","ObjectId","_formatAttributeValue","rasterInfo","attributeTable","features","filter","attributes","Value","VALUE","String","hasOwnProperty","dataType","clone","sourceLayer","push","fieldInfos","_getFieldInfo","trim","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","handles","doRefresh","dataChanged","catch","declaredClass","error","getRequiredFields","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","has","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","xmin","Math","min","ymin","xmax","max","ymax"],"sourceRoot":""}