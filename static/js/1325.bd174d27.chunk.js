"use strict";(globalThis.webpackChunkgeowebmap=globalThis.webpackChunkgeowebmap||[]).push([[1325],{61325:(e,s,i)=>{i.r(s),i.d(s,{default:()=>c});var a=i(27366),t=i(40110),n=(i(93169),i(10064)),l=i(92026),r=i(66978),o=i(49861),y=i(69912),h=i(42069),d=i(67581);const w="analysis-view-handles";let u=class extends((0,h.A)(d.Z)){constructor(e){super(e),this.type="analysis-3d",this.allAnalysisViews=new t.Z,this._creatingViewCount=0,this._analysisViewCreationTasks=new Map,this._analysisModules={"area-measurement":{module:null},"direct-line-measurement":{module:null},"line-of-sight":{module:null},slice:{module:null}}}initialize(){for(const e of this.layer.analyses)this._createAnalysisView(e);this.handles.add([this.layer.analyses.on("after-add",(e=>{this._createAnalysisView(e.item)})),this.layer.analyses.on("after-remove",(e=>{const s=this.allAnalysisViews.removeAt(this.allAnalysisViews.findIndex((s=>s.analysis===e.item)));(0,l.pC)(s)&&s.destroy();const i=this._analysisViewCreationTasks.get(e.item);(0,l.pC)(i)&&(i.abort(),this._analysisViewCreationTasks.delete(e.item))}))],w)}destroy(){this.handles.remove(w),this.allAnalysisViews.drain((e=>e.destroy())),this._analysisViewCreationTasks.clear(),this._creatingViewCount=0}whenAnalysisView(e){const s=this._analysisViewCreationTasks.get(e);if((0,l.pC)(s))return s.promise;const i=new n.Z("layerview:no-analysisview-for-analysis","The analysis has not been added to the AnalysisLayer of this layer view",{analysis:e});return Promise.reject(i)}isUpdating(){return 0!==this._creatingViewCount||this.allAnalysisViews.some((e=>e.updating))}_createAnalysisView(e){this._analysisViewCreationTasks.set(e,(0,r.vr)((s=>this._createAnalysisViewPromise(e,s))))}async _createAnalysisViewPromise(e,s){this._creatingViewCount+=1;const i=e.type,a=this._analysisModules[i];if((0,l.Wi)(a.module)){const e=await this._loadAnalysisModule(i);a.module=e}const t=new a.module.default({analysis:e,view:this.view,parent:this});if(await t.when(),this._creatingViewCount-=1,(0,r.Hc)(s))throw t.destroy(),new n.Z("layerview:no-analysisview-for-analysis","The analysis has not been added to the AnalysisLayer of this layer view",{analysis:e});return this.allAnalysisViews.add(t),t}_loadAnalysisModule(e){switch(e){case"area-measurement":return Promise.all([i.e(9058),i.e(3987),i.e(4328)]).then(i.bind(i,78124));case"direct-line-measurement":return Promise.all([i.e(9058),i.e(3987),i.e(3003)]).then(i.bind(i,43003));case"line-of-sight":return i.e(5755).then(i.bind(i,85755));case"slice":return Promise.all([i.e(9147),i.e(1060)]).then(i.bind(i,41060));default:return null}}};(0,a._)([(0,o.Cb)()],u.prototype,"type",void 0),(0,a._)([(0,o.Cb)()],u.prototype,"layer",void 0),(0,a._)([(0,o.Cb)()],u.prototype,"allAnalysisViews",void 0),(0,a._)([(0,o.Cb)()],u.prototype,"_creatingViewCount",void 0),u=(0,a._)([(0,y.j)("esri.views.3d.layers.AnalysisLayerView3D")],u);const c=u}}]);
//# sourceMappingURL=1325.bd174d27.chunk.js.map