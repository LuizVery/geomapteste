(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[32],{1161:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return g}));r(112);var a=r(2),i=r(3),n=r(4),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Object(i.a)(this,e),this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,r)}return Object(n.a)(e,[{key:"decreaseRefCount",value:function(e,t){var r=e+"/"+t,a=this._cachedBlocks;if(a.has(r)){var i=a.get(r);return i.refCount--,i.refCount<=0&&(a.delete(r),i.controller&&i.controller.abort()),i.refCount}return 0}},{key:"getBlock",value:function(e,t){var r=e+"/"+t,a=this._cachedBlocks;if(a.has(r)){var i=a.get(r);return i.ts=Date.now(),i.refCount++,a.delete(r),a.set(r,i),i.block}return null}},{key:"putBlock",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this._cachedBlocks,n=e+"/"+t;if(i.has(n)){var s=i.get(n);s.ts=Date.now(),s.refCount++}else i.set(n,{block:r,ts:Date.now(),refCount:1,controller:a});this.trim(),this.updateTimer()}},{key:"deleteBlock",value:function(e,t){var r=this._cachedBlocks,a=e+"/"+t;r.has(a)&&r.delete(a)}},{key:"updateMaxSize",value:function(e){this._size=e,this.trim()}},{key:"empty",value:function(){this._cachedBlocks.clear(),this.clearTimer()}},{key:"getCurrentSize",value:function(){return this._cachedBlocks.size}},{key:"updateTimer",value:function(){var e=this;if(null==this._timer){var t=this._cachedBlocks;this._timer=setInterval((function(){for(var r=Array.from(t),a=Date.now(),i=0;i<r.length&&r[i][1].ts<=a-e._duration;i++)t.delete(r[i][0]);0===t.size&&e.clearTimer()}),this._interval)}}},{key:"trim",value:function(){var e=this._cachedBlocks;if(!(-1===this._size||this._size>=e.size))for(var t=Array.from(e),r=0;r<t.length-this._size;r++)e.delete(t[r][0])}},{key:"clearTimer",value:function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}]),e}(),o=r(1015),c=r(56),l=new Map,u=new s;function h(e,t){return null==t?e:"".concat(e,"?sliceId=").concat(t)}function f(e,t){var r={extent:null,rasterInfo:t,cache:new Map};if(l.has(e)){var a=l.get(e);return a.push(r),a.length-1}return l.set(e,[r]),0}function d(e,t){if(l.has(e)){var r=l.get(e);r[t]=null,r.some((function(e){return null!=e}))||l.delete(e)}}function b(e,t,r){if(!l.has(e))return null==t?u.decreaseRefCount(e,r):0;var a=l.get(e);if(null==a[t])return u.decreaseRefCount(e,r);var i=a[t].cache;if(i.has(r)){var n=i.get(r);if(n.refCount--,0===n.refCount){i.delete(r);for(var s=0;s<a.length;s++)a[s]&&a[s].cache.has(r)&&a[s].cache.delete(r);n.controller&&n.controller.abort()}return n.refCount}return 0}function v(e,t,r){if(!l.has(e))return null==t?u.getBlock(e,r):null;var a=l.get(e);if(null==a[t]){for(var i=0;i<a.length;i++)if(a[i]&&a[i].cache.has(r)){var n=a[i].cache.get(r);return n.refCount++,n.block}return u.getBlock(e,r)}var s=a[t].cache;if(s.has(r)){var o=s.get(r);return o.refCount++,o.block}for(var c=0;c<a.length;c++)if(c!==t&&a[c]&&a[c]&&a[c].cache.has(r)){var h=a[c].cache.get(r);return h.refCount++,s.set(r,h),h.block}return null}function p(e,t,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(l.has(e)){var n=l.get(e);if(null!=n[t]){var s={refCount:1,block:a,isResolved:!1,isRejected:!1,controller:i};a.then((function(){return s.isResolved=!0})).catch((function(){return s.isRejected=!0})),n[t].cache.set(r,s)}else u.putBlock(e,r,a,i)}else null==t&&u.putBlock(e,r,a,i)}function y(e,t,r){if(l.has(e)){var a=l.get(e);null!=a[t]?a[t].cache.delete(r):u.deleteBlock(e,r)}else null==t&&u.deleteBlock(e,r)}function m(e,t){if(!l.has(e))return null;var r=l.get(e);return null==r[t]?null:r[t]}function g(e,t,r,i,n,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=m(e,t),h=u.extent,f=u.cache,d=u.rasterInfo;if(!h||h.xmin!==r.xmin||h.xmax!==r.xmax||h.ymin!==r.ymin||h.ymax!==r.ymax){for(var b=r.clone().normalize(),v=d.spatialReference,p=d.transform,y=new Set,g=0;g<b.length;g++){var O=b[g];if(!(O.xmax-O.xmin<=i||O.ymax-O.ymin<=i)){var j=Object(o.g)(O,v,l);Object(a.k)(p)&&(j=p.inverseTransform(j));var k=new c.a({x:i,y:i,spatialReference:O.spatialReference});if(null==n&&!(n=Object(o.i)(k,v,O,l)))return;var _=Object(o.k)(n,d,s||"closest"),w=_.pyramidLevel,x=_.pyramidResolution,P=_.excessiveReading;if(P)return;for(var R=d.storageInfo,I=R.origin,S={x:Math.max(0,Math.floor((j.xmin-I.x)/x.x)),y:Math.max(0,Math.floor((I.y-j.ymax)/x.y))},T=Math.ceil((j.xmax-j.xmin)/x.x-.1),C=Math.ceil((j.ymax-j.ymin)/x.y-.1),M=w>0?R.pyramidBlockWidth:R.blockWidth,z=w>0?R.pyramidBlockHeight:R.blockHeight,U=1,B=Math.max(0,Math.floor(S.x/M)-U),D=Math.max(0,Math.floor(S.y/z)-U),V=Math.floor((S.x+T-1)/M)+U,A=Math.floor((S.y+C-1)/z)+U,L=D;L<=A;L++)for(var F=B;F<=V;F++)y.add("".concat(w,"/").concat(L,"/").concat(F))}}f.forEach((function(e,t){if(!y.has(t)){var r=f.get(t);(null==r||r.isResolved||r.isRejected)&&f.delete(t)}})),u.extent={xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,ymax:r.ymax}}}},1368:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return be}));var a=r(8),i=r.n(a),n=r(15),s=r(3),o=r(4),c=r(6),l=r(7),u=r(0),h=(r(112),r(119)),f=r(16),d=r(2),b=r(23),v=r(30),p=r(27),y=r(1),m=(r(17),r(18),r(9)),g=r(411),O=r(1161),j=r(961),k=r(1015),_=r(897),w=r(31),x=r(35),P=r(47),R=r(44),I=r(45),S=r(155),T=r(926),C=r(267),M=r(1166),z=r(700),U=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e,a,i,n,o){var c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return Object(s.a)(this,r),(c=t.call(this,e,a,i,n,o)).bitmap=new M.a(l,null,null),c.bitmap.coordScale=[n,o],c.bitmap.once("isReady",(function(){return c.ready()})),c}return Object(o.a)(r,[{key:"destroy",value:function(){Object(P.a)(Object(R.a)(r.prototype),"destroy",this).call(this),this.bitmap.destroy(),this.bitmap=null,this.stage=null}},{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(e){this.bitmap.stencilRef=e}},{key:"setTransform",value:function(e,t){Object(P.a)(Object(R.a)(r.prototype),"setTransform",this).call(this,e,t),this.bitmap.transforms.dvs=this.transforms.dvs}},{key:"_createTransforms",value:function(){return{dvs:Object(C.b)(),tileMat3:Object(C.b)()}}},{key:"onAttach",value:function(){this.bitmap.stage=this.stage}},{key:"onDetach",value:function(){this.bitmap.stage=null}}]),r}(z.a),B=r(882),D=r(924),V=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).isCustomTilingScheme=!1,e}return Object(o.a)(r,[{key:"createTile",value:function(e){var t=this._getTileBounds(e),r=Object(w.a)(this._tileInfoView.tileInfo.size,2),a=r[0],i=r[1];return new U(e,t[0],t[3],a,i)}},{key:"destroyTile",value:function(){}},{key:"prepareRenderPasses",value:function(e){var t=this,a=e.registerRenderPass({name:"imagery (tile)",brushes:[T.a.raster],target:function(){return t.children.map((function(e){return e.bitmap}))},drawPhase:B.c.MAP});return[].concat(Object(x.a)(Object(P.a)(Object(R.a)(r.prototype),"prepareRenderPasses",this).call(this,e)),[a])}},{key:"doRender",value:function(e){this.visible&&e.drawPhase===B.c.MAP&&Object(P.a)(Object(R.a)(r.prototype),"doRender",this).call(this,e)}},{key:"_getTileBounds",value:function(e){var t=this._tileInfoView.getTileBounds(Object(I.l)(),e);if(this.isCustomTilingScheme&&e.world){var r=this._tileInfoView.tileInfo,a=Object(S.o)(r.spatialReference);if(a){var i=r.lodAt(e.level).resolution,n=a/i%r.size[0],s=n?(r.size[0]-n)*i:0;t[0]-=s*e.world,t[2]-=s*e.world}}return t}}]),r}(D.a),A=r(32),L=r(981),F=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._emptyTilePixelBlock=null,e.container=null,e.layer=null,e.tileSize=null,e.useWebGLForProcessing=!0,e}return Object(o.a)(r,[{key:"fetchTile",value:function(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}},{key:"createEmptyTilePixelBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null==e||e.join(",")===this.tileSize.join(",");if(t&&Object(d.k)(this._emptyTilePixelBlock))return this._emptyTilePixelBlock;var r=e=e||this.tileSize,a=Object(w.a)(r,2),i=a[0],n=a[1],s=new L.a({width:i,height:n,pixels:[new Uint8Array(i*n)],mask:new Uint8Array(i*n),pixelType:"u8"});return t&&(this._emptyTilePixelBlock=s),s}}]),r}(A.a);Object(u.a)([Object(y.b)()],F.prototype,"container",void 0),Object(u.a)([Object(y.b)()],F.prototype,"layer",void 0),Object(u.a)([Object(y.b)()],F.prototype,"tileSize",void 0),Object(u.a)([Object(y.b)()],F.prototype,"type",void 0),Object(u.a)([Object(y.b)()],F.prototype,"useWebGLForProcessing",void 0);var q=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).container=null,e.layer=null,e.tileSize=null,e.type="raster",e.useWebGLForProcessing=!0,e}return Object(o.a)(r,[{key:"canUseWebGLForProcessing",value:function(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!("majority"===this.layer.interpolation&&this._canUseMajorityInterpolationOnDataSource())}},{key:"fetchTile",value:function(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}},{key:"updateTileSource",value:function(){var e=Object(n.a)(i.a.mark((function e(t,r){var a,n,s,o,c,l,u,h,f,b,v,p,y,m,g;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.layer.bandIds,o=this._getLayerInterpolation(),c=this.canUseWebGLForProcessing(),l=r.source,u=r.symbolizerParams,h=r.globalSymbolizerParams,f=r.suspended,b=r.coords,v=r.resolution,p=t.bitmap,a=b,n=Object(w.a)(a,2),p.x=n[0],p.y=n[1],p.resolution=v,!(l&&Object(d.k)(l)&&Object(d.k)(l.pixelBlock))){e.next=14;break}if(y={extent:l.extent,pixelBlock:l.pixelBlock},p.rawPixelData=y,!c){e.next=7;break}p.source=l.pixelBlock,p.isRendereredSource=!1,e.next=11;break;case 7:return e.next=9,this.layer.applyRenderer(y,"stretch"===(null==h?void 0:h.type)?h:null);case 9:m=e.sent,p.source=m,p.isRendereredSource=!0;case 11:p.symbolizerParameters=c?u:null,c?p.transformGrid||(p.transformGrid=l.transformGrid):p.transformGrid=null,e.next=16;break;case 14:g=this.createEmptyTilePixelBlock(),p.source=g,p.symbolizerParameters=c?u:null,p.transformGrid=null;case 16:p.bandIds=c?s:null,p.width=this.tileSize[0],p.height=this.tileSize[1],p.interpolation=o,p.suspended=f,p.invalidateTexture();case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateTileSymbolizerParameters",value:function(){var e=Object(n.a)(i.a.mark((function e(t,r){var a,n,s,o,c,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.local,n=r.global,s=this.layer.bandIds,o=this._getLayerInterpolation(),c=this.canUseWebGLForProcessing(),l=t.bitmap,u=l.rawPixelData,c||!Object(d.k)(u)){e.next=8;break}return e.next=4,this.layer.applyRenderer(u,"stretch"===(null==n?void 0:n.type)?n:null);case 4:l.source=e.sent,l.isRendereredSource=!0,e.next=9;break;case 8:l.isRendereredSource&&Object(d.k)(u)&&(l.source=u.pixelBlock),l.isRendereredSource=!1;case 9:l.symbolizerParameters=c?n||a:null,l.bandIds=c?s:null,l.interpolation=o,l.suspended=!1;case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"install",value:function(e,t){this.container=new V(t.tileInfoView),this.container.isCustomTilingScheme=t.isCustomTilingScheme,e.addChild(this.container)}},{key:"uninstall",value:function(){this.container.removeAllChildren(),this.container.remove()}},{key:"_canUseMajorityInterpolationOnDataSource",value:function(){var e=this.layer.rasterInfo,t=e.bandCount,r=e.attributeTable,a=e.colormap,i=e.pixelType;return 1===t&&(null!=r||null!=a||"u8"===i||"s8"===i)}},{key:"_getLayerInterpolation",value:function(){var e=this.layer.renderer.type;if("raster-colormap"===e||"unique-value"===e||"class-breaks"===e)return"nearest";var t=this.layer.interpolation,r=this.layer.renderer;return"raster-stretch"===r.type&&null!=r.colorRamp?"bilinear"===t||"cubic"===t?"bilinear":"nearest":t}}]),r}(F=Object(u.a)([Object(m.a)("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],F));Object(u.a)([Object(y.b)()],q.prototype,"container",void 0),Object(u.a)([Object(y.b)()],q.prototype,"layer",void 0),Object(u.a)([Object(y.b)()],q.prototype,"tileSize",void 0),Object(u.a)([Object(y.b)()],q.prototype,"type",void 0),Object(u.a)([Object(y.b)()],q.prototype,"useWebGLForProcessing",void 0);var G=q=Object(u.a)([Object(m.a)("esri.views.2d.layers.imagery.ImageryTileView2D")],q),E=r(995),W=r(70),H=r(92),N=(r(113),r(142),r(129),r(284),r(40),r(65),r(115)),Q=r(691),J=r(885),K=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(s.a)(this,r),(e=t.call(this))._source=null,e._symbolizerParameters=null,e._vaoInvalidated=!0,e.coordScale=[1,1],e.height=null,e.stencilRef=0,e.rawPixelData=null,e.width=null,e.source=a,e}return Object(o.a)(r,[{key:"destroy",value:function(){var e,t;Object(d.k)(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null)}},{key:"symbolizerParameters",get:function(){return this._symbolizerParameters},set:function(e){JSON.stringify(this._symbolizerParameters)!==JSON.stringify(e)&&(this._symbolizerParameters=e,this.invalidateVAO())}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.invalidateVAO()}},{key:"invalidateVAO",value:function(){var e,t;!this._vaoInvalidated&&Object(d.k)(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null,this._vaoInvalidated=!0,this.requestRender())}},{key:"updateVectorFieldVAO",value:function(e){if(this._vaoInvalidated){if(this._vaoInvalidated=!1,Object(d.k)(this.source)&&!Object(d.k)(this.vaoData))switch(this.symbolizerParameters.style){case"beaufort_ft":case"beaufort_km":case"beaufort_kn":case"beaufort_m":case"beaufort_mi":case"classified_arrow":case"ocean_current_kn":case"ocean_current_m":case"single_arrow":var t=Object(E.c)(this.source,this.symbolizerParameters),r=this._createVectorFieldVAO(e.context,t);this.vaoData={magdir:r};break;case"simple_scalar":var a=Object(E.d)(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,a);this.vaoData={scalar:i};break;case"wind_speed":var n=Object(E.c)(this.source,this.symbolizerParameters),s=this._createVectorFieldVAO(e.context,n),o=Object(E.d)(this.source,this.symbolizerParameters),c=this._createVectorFieldVAO(e.context,o);this.vaoData={magdir:s,scalar:c}}this.ready(),this.requestRender()}}},{key:"_createTransforms",value:function(){return{dvs:Object(C.b)()}}},{key:"onAttach",value:function(){this.invalidateVAO()}},{key:"onDetach",value:function(){this.invalidateVAO()}},{key:"_createVectorFieldVAO",value:function(e,t){var r=t.vertexData,a=t.indexData,i=H.a.createVertex(e,35044,new Float32Array(r)),n=H.a.createIndex(e,35044,new Uint32Array(a)),s=Object(J.f)("vector-field",{geometry:[{location:0,name:"a_pos",count:2,type:5126,normalized:!1},{location:1,name:"a_offset",count:2,type:5126,normalized:!1},{location:2,name:"a_vv",count:2,type:5126,normalized:!1}]});return{vao:new N.a(e,s.attributes,s.bufferLayouts,{geometry:i},n),elementCount:a.length}}}]),r}(Q.a),X=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e,a,i,n,o){var c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return Object(s.a)(this,r),(c=t.call(this,e,a,i,n,o)).tileData=new K(l),c.tileData.coordScale=[n,o],c.tileData.once("isReady",(function(){return c.ready()})),c}return Object(o.a)(r,[{key:"destroy",value:function(){Object(P.a)(Object(R.a)(r.prototype),"destroy",this).call(this),this.tileData.destroy(),this.tileData=null,this.stage=null}},{key:"stencilRef",get:function(){return this.tileData.stencilRef},set:function(e){this.tileData.stencilRef=e}},{key:"_createTransforms",value:function(){return{dvs:Object(C.b)(),tileMat3:Object(C.b)()}}},{key:"setTransform",value:function(e,t){Object(P.a)(Object(R.a)(r.prototype),"setTransform",this).call(this,e,t);var a=t/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,n=Object(w.a)(this.tileData.offset,2),s=n[0],o=n[1],c=[this.x+s*t,this.y-o*t],l=e.toScreenNoRotation([0,0],c),u=Object(w.a)(l,2),h=u[0],f=u[1],d=this.tileData.symbolizerParameters.symbolTileSize,b=Math.round((this.width-this.tileData.offset[0])/d)*d,v=Math.round((this.height-this.tileData.offset[1])/d)*d,p=b/this.rangeX*a,y=v/this.rangeY*a;Object(W.n)(i,p,0,0,0,y,0,h,f,1),Object(W.k)(this.transforms.dvs,e.displayViewMat3,i),this.tileData.transforms.dvs=this.transforms.dvs}},{key:"onAttach",value:function(){this.tileData.stage=this.stage}},{key:"onDetach",value:function(){this.tileData.stage=null}}]),r}(z.a),Y=r(1167),Z=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).isCustomTilingScheme=!1,e.symbolTypes=["triangle"],e}return Object(o.a)(r,[{key:"createTile",value:function(e){var t=this._tileInfoView.getTileBounds(Object(I.l)(),e),r=Object(w.a)(this._tileInfoView.tileInfo.size,2),a=r[0],i=r[1];return new X(e,t[0],t[3],a,i)}},{key:"destroyTile",value:function(){}},{key:"prepareRenderPasses",value:function(e){var t=this,a=e.registerRenderPass({name:"imagery (vf tile)",brushes:[Y.a],target:function(){return t.children.map((function(e){return e.tileData}))},drawPhase:B.c.MAP});return[].concat(Object(x.a)(Object(P.a)(Object(R.a)(r.prototype),"prepareRenderPasses",this).call(this,e)),[a])}},{key:"doRender",value:function(e){var t=this;this.visible&&e.drawPhase===B.c.MAP&&this.symbolTypes.forEach((function(a){e.renderPass=a,Object(P.a)(Object(R.a)(r.prototype),"doRender",t).call(t,e)}))}}]),r}(D.a),$=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._handle=null,e.container=null,e.layer=null,e.tileSize=null,e.type="rasterVF",e.useWebGLForProcessing=!0,e}return Object(o.a)(r,[{key:"canUseWebGLForProcessing",value:function(){return!1}},{key:"fetchTile",value:function(){var e=Object(n.a)(i.a.mark((function e(t,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.layer.fetchTile(t.level,t.row,t.col,r);case 2:if(a=e.sent,e.t0="vector-magdir"===this.layer.rasterInfo.dataType&&null!=a&&a.pixelBlock,!e.t0){e.next=8;break}return e.next=7,this.layer.convertVectorFieldData(a.pixelBlock,r);case 7:a.pixelBlock=e.sent;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateTileSource",value:function(e,t){var r=t.symbolizerParams,a=e.tileData;a.key=e.key,a.width=this.tileSize[0],a.height=this.tileSize[1];var i=r.symbolTileSize,n=t.source;if(a.offset=this._getTileSymbolOffset(a.key,i),Object(d.k)(n)&&Object(d.k)(n.pixelBlock)){var s={extent:n.extent,pixelBlock:n.pixelBlock};a.rawPixelData=s,a.source=this._sampleVectorFieldData(n.pixelBlock,r,a.offset),a.symbolizerParameters=r}else{var o=[Math.round((this.tileSize[0]-a.offset[0])/i),Math.round((this.tileSize[1]-a.offset[1])/i)],c=this.createEmptyTilePixelBlock(o);a.source=c,a.symbolizerParameters=r}return a.invalidateVAO(),Promise.resolve(null)}},{key:"updateTileSymbolizerParameters",value:function(e,t){var r,a=t.local,i=a.symbolTileSize,n=e.tileData;n.offset=this._getTileSymbolOffset(n.key,i);var s=n.symbolizerParameters.symbolTileSize;return n.symbolizerParameters=a,Object(d.k)(null==(r=n.rawPixelData)?void 0:r.pixelBlock)&&s!==i&&(n.source=this._sampleVectorFieldData(n.rawPixelData.pixelBlock,n.symbolizerParameters,n.offset)),Promise.resolve(null)}},{key:"install",value:function(e,t){var r=this;this.container=new Z(t.tileInfoView),this.container.isCustomTilingScheme=t.isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=this.layer.watch("renderer",(function(e){return r._updateSymbolType(e)})),e.addChild(this.container)}},{key:"uninstall",value:function(){this.container.removeAllChildren(),this._handle.remove(),this._handle=null,this.container.remove()}},{key:"_getTileSymbolOffset",value:function(e,t){var r=e.col*this.tileSize[0]%t,a=e.row*this.tileSize[1]%t;return[r>t/2?t-r:-r,a>t/2?t-a:-a]}},{key:"_sampleVectorFieldData",value:function(e,t,r){var a=t.symbolTileSize;return Object(E.f)(e,"vector-uv",a,r)}},{key:"_updateSymbolType",value:function(e){"vector-field"===e.type&&(this.container.symbolTypes="wind-barb"===e.style?["scalar","triangle"]:"simple-scalar"===e.style?["scalar"]:["triangle"])}}]),r}(F);Object(u.a)([Object(y.b)()],$.prototype,"container",void 0),Object(u.a)([Object(y.b)()],$.prototype,"layer",void 0),Object(u.a)([Object(y.b)()],$.prototype,"tileSize",void 0),Object(u.a)([Object(y.b)()],$.prototype,"type",void 0),Object(u.a)([Object(y.b)()],$.prototype,"useWebGLForProcessing",void 0);var ee=$=Object(u.a)([Object(m.a)("esri.views.2d.layers.imagery.VectorFieldTileView2D")],$),te=r(697),re=r(825),ae=r(826),ie=r(1176),ne=r(686),se=r(908),oe=r(947),ce=r(690),le=r(61),ue=r(56),he=f.a.getLogger("esri.views.2d.layers.ImageryTileLayerView2D"),fe=[0,0],de=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._tileStrategy=null,e._tileInfoView=null,e._fetchQueue=null,e._blockCacheRegistryUrl=null,e._blockCacheRegistryId=null,e._srcResolutions=null,e._previousLOD=null,e._needBlockCacheUpdate=!1,e._globalSymbolizerParams=null,e._symbolizerParams=null,e._abortController=null,e._globalUpdateRequested=!1,e._isCustomTilingScheme=!1,e.subview=null,e._redrawOrRefetch=Object(b.j)((function(t,r){return t?e.doRefresh():e._redrawImage(r)})),e}return Object(o.a)(r,[{key:"initialize",value:function(){var e=this.updateFullExtent();this.addResolvingPromise(e)}},{key:"useWebGLForProcessing",get:function(){var e;return null==(e=this._get("useWebGLForProcessing"))||e},set:function(e){this.subview&&(this.subview.useWebGLForProcessing=e),this._set("useWebGLForProcessing",e)}},{key:"useProgressiveUpdate",get:function(){return null==this._get("useProgressiveUpdate")||this._get("useProgressiveUpdate")},set:function(e){var t=this;if(this._tileStrategy&&this.useProgressiveUpdate!==e){var r;this._tileStrategy.destroy(),null==(r=this.subview)||r.container.removeAllChildren();var a=this._getCacheSize(e);this._tileStrategy=new ae.a({cachePolicy:"purge",acquireTile:function(e){return t.acquireTile(e)},releaseTile:function(e){return t.releaseTile(e)},cacheSize:a,tileInfoView:this._tileInfoView}),this._set("useProgressiveUpdate",e),this.requestUpdate()}}},{key:"hitTest",value:function(e,t){if(this.suspended)return Promise.resolve(null);var r=this.view.toMap(Object(v.e)(e,t));return Promise.resolve(new h.a({attributes:{},geometry:r}))}},{key:"update",value:function(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();var t=e.state,r=t.extent,a=t.resolution,i=t.scale,n=this._tileInfoView.getClosestInfoForScale(i);if(this.layer.raster){var s;if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){var o=this._srcResolutions[n.level],c=r.toJSON?r:le.a.fromJSON(r);Object(O.h)(this._blockCacheRegistryUrl,this._blockCacheRegistryId,c,a,o,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1,(null==(s=this._previousLOD)?void 0:s.level)!==n.level&&(this._previousLOD=n,null==this._symbolizerParams||this.hasTilingEffects||this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}this.notifyChange("updating")}},{key:"attach",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage(),Object(ce.a)().supportsTextureFloat||(this.useWebGLForProcessing=!1),this._initializeTileInfo(),this._tileInfoView=new te.a(this.tileInfo,this.fullExtent);var t=this._computeFetchConcurrency();this._fetchQueue=new re.a({tileInfoView:this._tileInfoView,concurrency:t,process:function(t,r){return e.fetchTile(t,r)}});var r=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new ae.a({cachePolicy:"purge",acquireTile:function(t){return e.acquireTile(t)},releaseTile:function(t){return e.releaseTile(t)},cacheSize:r,tileInfoView:this._tileInfoView}),this._updatesubview(),this.handles.add([Object(p.e)(this.layer,["bandIds","renderer","interpolation","multidimensionalDefinition"],(function(t,r,a){var i="multidimensionalDefinition"===a,n="interpolation"===a&&("majority"===t||"majority"===r)&&e._canUseMajorityInterpolationOnDataSource(),s="renderer"===a&&"vector-field"===r.type!=("vector-field"===r.type);s&&e._updatesubview();var o=i||n||s;e._redrawOrRefetch(o).catch((function(e){Object(b.n)(e)||he.error(e)}))})),Object(p.a)(this,["layer.blendMode"],(function(t){e.subview&&(e.subview.container.blendMode=t)}),!0),Object(p.a)(this,["layer.effect"],(function(t){e.subview&&(e.subview.container.effect=t)}),!0)],"attach"),this._updateBlockCacheRegistry()}},{key:"detach",value:function(){var e;this.handles.remove("attach"),this.layer.decreaseRasterJobHandlerUsage(),null==(e=this.subview)||e.uninstall(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null,Object(O.g)(this._blockCacheRegistryUrl,this._blockCacheRegistryId)}},{key:"moveStart",value:function(){this.requestUpdate()}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){var e=this;!this.hasTilingEffects&&this.useProgressiveUpdate||(this._abortController&&this._abortController.abort(),this._abortController=Object(b.e)(),0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then((function(){e._globalUpdateRequested=!1,e.requestUpdate()})));var t=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(t),this.requestUpdate()}},{key:"createFetchPopupFeaturesQueryGeometry",value:function(e,t){return Object(oe.a)(e,t,this.view)}},{key:"doRefresh",value:function(){var e=Object(n.a)(i.a.mark((function e(){var t,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.suspended){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.layer.updateRenderer();case 4:return this._updateSymbolizerParams(),this._updateBlockCacheRegistry(!0),this._fetchQueue.reset(),t=[],this._tileStrategy.tiles.forEach((function(e){return t.push(r._enqueueTileFetch(e))})),e.next=11,Object(b.k)(t);case 11:this.notifyChange("updating");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this._fetchQueue.length>0||this._globalUpdateRequested}},{key:"acquireTile",value:function(e){var t=this.subview.container.createTile(e);return this._enqueueTileFetch(t),this.requestUpdate(),this._needBlockCacheUpdate=!0,this._globalUpdateRequested=this.hasTilingEffects||!this.useProgressiveUpdate,t}},{key:"releaseTile",value:function(e){var t,r=this;this._fetchQueue.abort(e.key.id),null==(t=this.subview)||t.container.removeChild(e),e.once("detach",(function(){e.destroy(),r.requestUpdate()})),this.requestUpdate()}},{key:"fetchTile",value:function(e,t){var r=!Object(d.j)(t)&&t.signal,a=this.subview.canUseWebGLForProcessing(),i={allowPartialFill:!0,tileInfo:this.tileInfo,signal:Object(d.t)(r),registryId:this._blockCacheRegistryId,requestRawData:a,srcResolution:this._srcResolutions[e.level],datumTransformation:this.datumTransformation,interpolation:a?"nearest":this.layer.interpolation};return this.subview.fetchTile(e,i)}},{key:"_updatesubview",value:function(){var e=this._isVectorField()?"rasterVF":"raster";if(this.subview){if(this.subview.type===e)return;this.subview.uninstall()}var t=this.layer,r=new("rasterVF"===e?ee:G)({layer:t,tileSize:this.tileInfo.size,useWebGLForProcessing:this.useWebGLForProcessing});r.install(this.container,{tileInfoView:this._tileInfoView,isCustomTilingScheme:this._isCustomTilingScheme}),r.container.blendMode=t.blendMode,r.container.effect=t.effect,this.subview=r}},{key:"_isVectorField",value:function(){return"vector-field"===this.layer.renderer.type}},{key:"_getCacheSize",value:function(e){return e?40:0}},{key:"_initializeTileInfo",value:function(){var e=this.view.spatialReference,t=new ue.a({x:this.fullExtent.xmin,y:this.fullExtent.ymax,spatialReference:e}),r=Object(k.a)(this.layer.rasterInfo,e),a=r.scales,i=r.srcResolutions,n=r.isCustomTilingScheme,s=g.a.create({spatialReference:e,size:512,scales:a});(0===s.origin.x||s.origin.x>t.x)&&(s.origin=t),this._isCustomTilingScheme=n,this._set("tileInfo",s),this._srcResolutions=null!=i?i:[]}},{key:"_computeFetchConcurrency",value:function(){var e=this.layer.rasterInfo.storageInfo.blockBoundary,t=e[e.length-1];return(t.maxCol-t.minCol+1)*(t.maxRow-t.minRow+1)>64?2:10}},{key:"_enqueueTileFetch",value:function(){var e=Object(n.a)(i.a.mark((function e(t,r){var a,n,s,o,c,l=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._fetchQueue.has(t.key.id)){e.next=30;break}return e.prev=1,e.next=4,this._fetchQueue.push(t.key);case 4:if(a=e.sent,n=this.layer.bandIds,s=!this.useProgressiveUpdate||this.hasTilingEffects&&!this._globalSymbolizerParams,!this._globalUpdateRequested||this.moving||0!==this._fetchQueue.length){e.next=18;break}return s=!1,e.prev=9,e.next=12,this._redrawImage(this._abortController&&this._abortController.signal);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),Object(b.n)(e.t0)&&he.error(e.t0);case 17:this._globalUpdateRequested=!1;case 18:return!this.subview.canUseWebGLForProcessing()&&!this._isVectorField()||this.hasTilingEffects||null!=this._symbolizerParams||this._updateSymbolizerParams(),o=this._tileInfoView.getTileCoords(fe,t.key),c=this._tileInfoView.getTileResolution(t.key),e.next=22,this.subview.updateTileSource(t,{source:a,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:s,bandIds:n,coords:o,resolution:c});case 22:t.once("attach",(function(){return l.requestUpdate()})),this.subview.container.addChild(t),e.next=29;break;case 26:e.prev=26,e.t1=e.catch(1),Object(b.n)(e.t1)||he.error(e.t1);case 29:this.requestUpdate();case 30:case"end":return e.stop()}}),e,this,[[1,26],[9,14]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_redrawImage",value:function(){var e=Object(n.a)(i.a.mark((function e(t){var r,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.subview.container.children.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.layer.updateRenderer();case 4:if(!this.hasTilingEffects){e.next=9;break}return e.next=7,this._updateGlobalSymbolizerParams(t);case 7:e.next=10;break;case 9:this._updateSymbolizerParams(),this._globalSymbolizerParams=null;case 10:return r=this.subview.container.children.map(function(){var e=Object(n.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.subview.updateTileSymbolizerParameters(t,{local:a._symbolizerParams,global:a._globalSymbolizerParams}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=13,Object(b.k)(r);case 13:this.container.requestRender();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateGlobalSymbolizerParams",value:function(){var e=Object(n.a)(i.a.mark((function e(t){var r,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={srcResolution:this._srcResolutions[this._previousLOD.level],registryId:this._blockCacheRegistryId,signal:t},e.next=3,this.layer.fetchPixels(this.view.extent,this.view.width,this.view.height,r);case 3:if((a=e.sent)&&a.pixelBlock){e.next=6;break}return e.abrupt("return");case 6:n=this.layer.symbolizer.generateWebGLParameters({pixelBlock:Object(j.h)(a.pixelBlock,this.layer.bandIds),isGCS:this.view.spatialReference.isGeographic,resolution:{x:this._previousLOD.resolution,y:this._previousLOD.resolution},bandIds:this.layer.bandIds}),!this.subview.canUseWebGLForProcessing()&&n&&"stretch"===n.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(n.factor=n.factor.map((function(e){return 255*e})),n.outMin=Math.round(255*n.outMin),n.outMax=Math.round(255*n.outMax)),this._globalSymbolizerParams=n;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateSymbolizerParams",value:function(){this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.view.spatialReference.isGeographic,resolution:{x:this._previousLOD.resolution,y:this._previousLOD.resolution},bandIds:this.layer.bandIds})}},{key:"_updateBlockCacheRegistry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.layer,r=t.url,a=t.rasterInfo,i=t.multidimensionalDefinition,n=t.raster,s=null!=a&&a.multidimensionalInfo?n.getSliceIndex(i):null,o=Object(O.d)(r,s);if(o!==this._blockCacheRegistryUrl){if(null!=this._blockCacheRegistryUrl&&Object(O.g)(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryId=Object(O.f)(o,this.layer.raster.rasterInfo),e){var c=this._tileInfoView.getClosestInfoForScale(this.view.scale),l=this._srcResolutions[c.level];Object(O.h)(o,this._blockCacheRegistryId,this.view.extent,this.view.resolution,l,this.layer.raster.ioConfig.sampling)}this._blockCacheRegistryUrl=o}}},{key:"_canUseMajorityInterpolationOnDataSource",value:function(){var e=this.layer.rasterInfo,t=e.bandCount,r=e.attributeTable,a=e.colormap,i=e.pixelType;return 1===t&&(null!=r||null!=a||"u8"===i||"s8"===i)}}]),r}(Object(ie.a)(Object(se.a)(Object(_.a)(ne.a))));Object(u.a)([Object(y.b)()],de.prototype,"subview",void 0),Object(u.a)([Object(y.b)()],de.prototype,"useWebGLForProcessing",null),Object(u.a)([Object(y.b)()],de.prototype,"useProgressiveUpdate",null);var be=de=Object(u.a)([Object(m.a)("esri.views.2d.layers.ImageryTileLayerView2D")],de)},897:function(e,t,r){"use strict";r.d(t,"a",(function(){return M}));var a,i=r(3),n=r(4),s=r(47),o=r(44),c=r(6),l=r(7),u=r(0),h=r(49),f=r(186),d=r(27),b=r(1),v=(r(17),r(18),r(16),r(9)),p=r(896),y=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return r}(r(25).a),m=y=Object(u.a)([Object(v.a)("esri.views.layers.support.ClipArea")],y),g=a=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).type="rect",e.left=null,e.right=null,e.top=null,e.bottom=null,e}return Object(n.a)(r,[{key:"clone",value:function(){return new a({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}},{key:"version",get:function(){return(this._get("version")||0)+1}}]),r}(m);Object(u.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],g.prototype,"left",void 0),Object(u.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],g.prototype,"right",void 0),Object(u.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],g.prototype,"top",void 0),Object(u.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],g.prototype,"bottom",void 0),Object(u.a)([Object(b.b)({readOnly:!0})],g.prototype,"version",null);var O,j=g=a=Object(u.a)([Object(v.a)("esri.views.layers.support.ClipRect")],g),k=(r(112),r(173)),_=r(77),w=r(61),x=r(147),P={base:k.a,key:"type",typeMap:{extent:w.a,polygon:x.a}},R=O=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).type="geometry",e.geometry=null,e}return Object(n.a)(r,[{key:"version",get:function(){return(this._get("version")||0)+1}},{key:"clone",value:function(){return new O({geometry:this.geometry.clone()})}}]),r}(m);Object(u.a)([Object(b.b)({types:P,json:{read:_.a,write:!0}})],R.prototype,"geometry",void 0),Object(u.a)([Object(b.b)({readOnly:!0})],R.prototype,"version",null);var I=R=O=Object(u.a)([Object(v.a)("esri.views.layers.support.Geometry")],R),S=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).type="path",e.path=[],e}return Object(n.a)(r,[{key:"version",get:function(){return(this._get("version")||0)+1}}]),r}(m);Object(u.a)([Object(b.b)({type:[[[Number]]],json:{write:!0}})],S.prototype,"path",void 0),Object(u.a)([Object(b.b)({readOnly:!0})],S.prototype,"version",null);var T=S=Object(u.a)([Object(v.a)("esri.views.layers.support.Path")],S),C=h.a.ofType({key:"type",base:m,typeMap:{rect:j,path:T,geometry:I}}),M=function(e){var t=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).clips=new C,e.moving=!1,e.attached=!1,e.lastUpdateId=-1,e.updateRequested=!1,e}return Object(n.a)(r,[{key:"initialize",value:function(){var e,t=this;this.container||(this.container=new p.a),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([Object(d.a)(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),Object(d.a)(this,["layer.opacity","container"],(function(){var e,r;t.container&&(t.container.opacity=null!=(e=null==(r=t.layer)?void 0:r.opacity)?e:1)}),!0),Object(d.a)(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),Object(d.a)(this,["layer.effect"],(function(e){t.container&&(t.container.effect=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))}},{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}},{key:"isVisibleAtScale",value:function(e){var t=!0,r=this.layer,a=r.minScale,i=r.maxScale;if(null!=a&&null!=i){var n=!a,s=!i;!n&&e<=a&&(n=!0),!s&&e>=i&&(s=!0),t=n&&s}return t}},{key:"requestUpdate",value:function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}},{key:"processUpdate",value:function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}},{key:"isUpdating",value:function(){return!1}},{key:"isRendering",value:function(){return!1}},{key:"canResume",value:function(){return!!Object(s.a)(Object(o.a)(r.prototype),"canResume",this).call(this)&&this.isVisibleAtScale(this.view.scale)}}]),r}(e);return Object(u.a)([Object(b.b)({type:C,set:function(e){var t=Object(f.b)(e,this._get("clips"),C);this._set("clips",t)}})],t.prototype,"clips",void 0),Object(u.a)([Object(b.b)()],t.prototype,"moving",void 0),Object(u.a)([Object(b.b)()],t.prototype,"attached",void 0),Object(u.a)([Object(b.b)()],t.prototype,"container",void 0),Object(u.a)([Object(b.b)()],t.prototype,"suspended",void 0),Object(u.a)([Object(b.b)({readOnly:!0})],t.prototype,"updateParameters",void 0),Object(u.a)([Object(b.b)()],t.prototype,"updateRequested",void 0),Object(u.a)([Object(b.b)()],t.prototype,"updating",null),Object(u.a)([Object(b.b)()],t.prototype,"view",void 0),t=Object(u.a)([Object(v.a)("esri.views.2d.layers.LayerView2D")],t)}},902:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var a=r(12),i=r(3),n=r(4),s=r(47),o=r(44),c=r(6),l=r(7),u=(r(17),r(2)),h=r(267),f=r(926),d=r(896),b=r(31),v=r(20),p=r(16),y=r(691),m=r(21),g=r(14),O=r(326),j=r(33),k=r(42),_=r(493),w=r(246),x=r(883),P=r(92),R=p.a.getLogger("esri.views.2d.engine.webgl.Mesh2D"),I=function(e,t,r,a){for(var i=0,n=1;n<r;n++){var s=e[2*(t+n-1)],o=e[2*(t+n-1)+1];i+=(e[2*(t+n)]-s)*(e[2*(t+n)+1]+o)}return a?i>0:i<0},S=function(e,t){for(var r=e.coords,i=e.lengths,n=[],s=0,o=0;s<i.length;o+=i[s],s+=1){for(var c=o,l=[];s<i.length-1&&I(r,o+i[s],i[s+1],t);o+=i[s+=1])l.push(o+i[s]-c);var u,h=r.slice(2*c,2*(o+i[s])),f=Object(O.a)(h,l,2),d=Object(a.a)(f);try{for(d.s();!(u=d.n()).done;){var b=u.value;n.push(b+c)}}catch(v){d.e(v)}finally{d.f()}}return n},T=function(){function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(i.a)(this,e),this._cache={},this.vertices=t,this.indices=r,this.primitiveType=a,this.isMapSpace=n}return Object(n.a)(e,[{key:"destroy",value:function(){for(var e in Object(u.k)(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose(),this._cache.vertexBuffers)Object(u.k)(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}},{key:"elementType",get:function(){return function(e){switch(e.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new v.a("Cannot get DataType of array")}}(this.indices)}},{key:"getIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this._cache.indexBuffer||(this._cache.indexBuffer=P.a.createIndex(e,t,this.indices)),this._cache.indexBuffer}},{key:"getVertexBuffers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((function(a,i){return Object(g.a)(Object(g.a)({},a),{},Object(m.a)({},i,P.a.createVertex(e,r,t.vertices[i])))}),{})),this._cache.vertexBuffers}}],[{key:"fromRect",value:function(t){var r=t.x,a=t.y,i=r+t.width,n=a+t.height;return e.fromScreenExtent({xmin:r,ymin:a,xmax:i,ymax:n})}},{key:"fromPath",value:function(t){for(var r=Object(_.f)(new w.a,t.path,!1,!1),a=r.coords,i=new Uint32Array(S(r,!0)),n=new Uint32Array(a.length/2),s=0;s<n.length;s++)n[s]=Object(x.a)(Math.floor(a[2*s]),Math.floor(a[2*s+1]));return new e({geometry:n},i,4)}},{key:"fromGeometry",value:function(t,r){var a=r.geometry.type;switch(a){case"polygon":return e.fromPolygon(t,r.geometry);case"extent":return e.fromMapExtent(t,r.geometry);default:return R.error(new v.a("mapview-bad-type","Unable to create a mesh from type ".concat(a),r)),e.fromRect({x:0,y:0,width:1,height:1})}}},{key:"fromPolygon",value:function(t,r){for(var a=Object(_.g)(new w.a,r,!1,!1),i=a.coords,n=new Uint32Array(S(a,!1)),s=new Uint32Array(i.length/2),o=Object(k.b)(),c=Object(k.b)(),l=0;l<s.length;l++)Object(j.s)(o,i[2*l],i[2*l+1]),t.toScreen(c,o),s[l]=Object(x.a)(Math.floor(c[0]),Math.floor(c[1]));return new e({geometry:s},n,4,!0)}},{key:"fromScreenExtent",value:function(t){var r=t.xmin,a=t.xmax,i=t.ymin,n=t.ymax;return new e({geometry:new Uint32Array([Object(x.a)(r,i),Object(x.a)(a,i),Object(x.a)(r,n),Object(x.a)(r,n),Object(x.a)(a,i),Object(x.a)(a,n)])},new Uint32Array([0,1,2,3,4,5]),4)}},{key:"fromMapExtent",value:function(t,r){var a=t.toScreen([0,0],[r.xmin,r.ymin]),i=Object(b.a)(a,2),n=i[0],s=i[1],o=t.toScreen([0,0],[r.xmax,r.ymax]),c=Object(b.a)(o,2),l=c[0],u=c[1];return new e({geometry:new Uint32Array([Object(x.a)(n,s),Object(x.a)(l,s),Object(x.a)(n,u),Object(x.a)(n,u),Object(x.a)(l,s),Object(x.a)(l,u)])},new Uint32Array([0,1,2,3,4,5]),4)}}]),e}(),C=r(115),M=p.a.getLogger("esri.views.2d.engine.webgl.ClippingInfo"),z=function(e){return parseFloat(e)/100},U=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e,a){var n;return Object(i.a)(this,r),(n=t.call(this))._clip=a,n._cache={},n.stage=e,n._handle=a.watch("version",(function(){return n._invalidate()})),n.ready(),n}return Object(n.a)(r,[{key:"_destroyGL",value:function(){Object(u.k)(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),Object(u.k)(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}},{key:"destroy",value:function(){this._destroyGL(),this._handle.remove()}},{key:"getVAO",value:function(e,t,r,a){var i=Object(b.a)(t.size,2),n=i[0],s=i[1];if("geometry"!==this._clip.type&&this._lastWidth===n&&this._lastHeight===s||(this._lastWidth=n,this._lastHeight=s,this._destroyGL()),Object(u.j)(this._cache.vao)){var o=this._createMesh(t,this._clip),c=o.getIndexBuffer(e),l=o.getVertexBuffers(e);this._cache.mesh=o,this._cache.vao=new C.a(e,r,a,l,c)}return this._cache.vao}},{key:"_createTransforms",value:function(){return{dvs:Object(h.b)()}}},{key:"_invalidate",value:function(){this._destroyGL(),this.requestRender()}},{key:"_createScreenRect",value:function(e,t){var r=Object(b.a)(e.size,2),a=r[0],i=r[1],n="string"==typeof t.left?z(t.left)*a:t.left,s="string"==typeof t.right?z(t.right)*a:t.right,o="string"==typeof t.top?z(t.top)*i:t.top,c="string"==typeof t.bottom?z(t.bottom)*i:t.bottom,l=n,u=o;return{x:l,y:u,width:Math.max(a-s-l,0),height:Math.max(i-c-u,0)}}},{key:"_createMesh",value:function(e,t){switch(t.type){case"rect":return T.fromRect(this._createScreenRect(e,t));case"path":return T.fromPath(t);case"geometry":return T.fromGeometry(e,t);default:return M.error(new v.a("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),T.fromRect({x:0,y:0,width:1,height:1})}}}],[{key:"fromClipArea",value:function(e,t){return new r(e,t)}}]),r}(y.a),B=r(882),D=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).name=e.constructor.name,e}return Object(n.a)(r,[{key:"clips",set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e})),this._updateClippingInfo()}},{key:"_createTransforms",value:function(){return{dvs:Object(h.b)()}}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),r=t.painter,a=t.globalOpacity,i=t.profiler,n=t.drawPhase===B.c.LABEL?1:a*this.computedOpacity;i.recordContainerStart(this.name),r.beforeRenderLayer(t,this._clippingInfos?255:0,n),this.updateTransforms(e.state),this.renderChildren(t),r.compositeLayer(t,n),i.recordContainerEnd()}},{key:"renderChildren",value:function(e){Object(u.j)(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));var t,r=Object(a.a)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(l){r.e(l)}finally{r.f()}var i,n=Object(a.a)(this._renderPasses);try{for(n.s();!(i=n.n()).done;){var s=i.value;try{s.render(e)}catch(h){}}}catch(l){n.e(l)}finally{n.f()}var o,c=Object(a.a)(this.children);try{for(c.s();!(o=c.n()).done;){o.value.afterRender(e)}}catch(l){c.e(l)}finally{c.f()}}},{key:"createRenderParams",value:function(e){return e.requireFBO=this.requiresDedicatedFBO,e}},{key:"prepareRenderPasses",value:function(e){var t=this;return[e.registerRenderPass({name:"clip",brushes:[f.a.clip],target:function(){return t._clippingInfos},drawPhase:B.c.MAP|B.c.LABEL|B.c.LABEL_ALPHA|B.c.DEBUG|B.c.HIGHLIGHT})]}},{key:"updateTransforms",value:function(e){var t,r=Object(a.a)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.setTransform(e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"onAttach",value:function(){Object(s.a)(Object(o.a)(r.prototype),"onAttach",this).call(this),this._updateClippingInfo()}},{key:"onDetach",value:function(){Object(s.a)(Object(o.a)(r.prototype),"onDetach",this).call(this),this._updateClippingInfo()}},{key:"_updateClippingInfo",value:function(){var e=this;if(Object(u.k)(this._clippingInfos)&&(this._clippingInfos.forEach((function(e){return e.destroy()})),this._clippingInfos=null),this.stage){var t=this._clips;Object(u.k)(t)&&t.length&&(this._clippingInfos=t.items.map((function(t){return U.fromClipArea(e.stage,t)}))),this.requestRender()}}}]),r}(d.a)},924:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r(12),i=r(3),n=r(4),s=r(47),o=r(44),c=r(6),l=r(7),u=r(17),h=r(882),f=r(902),d=r(977),b=r(972),v=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col},p=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this))._tileInfoView=e,a}return Object(n.a)(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"renderChildren",value:function(e){this.sortChildren(v),this.setStencilReference(),Object(s.a)(Object(o.a)(r.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=e.state,a=Object(s.a)(Object(o.a)(r.prototype),"createRenderParams",this).call(this,e);return a.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,a.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),a}},{key:"prepareRenderPasses",value:function(e){var t=this,a=Object(s.a)(Object(o.a)(r.prototype),"prepareRenderPasses",this).call(this,e);return a.push(e.registerRenderPass({name:"stencil",brushes:[b.a],drawPhase:h.c.DEBUG|h.c.MAP|h.c.HIGHLIGHT,target:function(){return t.getStencilTarget()}})),Object(u.a)("esri-tiles-debug")&&a.push(e.registerRenderPass({name:"tileInfo",brushes:[d.a],drawPhase:h.c.DEBUG,target:function(){return t.children}})),a}},{key:"getStencilTarget",value:function(){return this.children}},{key:"updateTransforms",value:function(e){var t,r=Object(a.a)(this.children);try{for(r.s();!(t=r.n()).done;){var i=t.value,n=this._tileInfoView.getTileResolution(i.key);i.setTransform(e,n)}}catch(s){r.e(s)}finally{r.f()}}},{key:"setStencilReference",value:function(){var e,t=1,r=Object(a.a)(this.children);try{for(r.s();!(e=r.n()).done;){e.value.stencilRef=t++}}catch(i){r.e(i)}finally{r.f()}}}]),r}(f.a)},995:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return I})),r.d(t,"d",(function(){return R})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return S})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return d}));var a=r(31),i=r(57),n=r(2),s=r(981),o=r(961),c=new Map;c.set("meter-per-second",1),c.set("kilometer-per-hour",.277778),c.set("knots",.514444),c.set("feet-per-second",.3048),c.set("mile-per-hour",.44704);var l=180/Math.PI,u=new i.a({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function h(e,t){return c.get(e)/c.get(t)||1}function f(e){return(450-e)%360}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=Object(a.a)(e,2),i=r[0],n=r[1],s=Math.sqrt(i*i+n*n),o=Math.atan2(n,i)*l;return o=(360+o)%360,"geographic"===t&&(o=f(o)),[s,o]}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=e[1];"geographic"===t&&(r=f(r)),r%=360;var a=e[0];return[a*Math.cos(r/l),a*Math.sin(r/l)]}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geographic",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!Object(o.i)(e))return e;for(var n=e.pixels,c=e.width,l=e.height,u=c*l,h=n[0],f=n[1],v=s.a.createEmptyBand(e.pixelType,u),p=s.a.createEmptyBand(e.pixelType,u),y=0,m=0;m<l;m++)for(var g=0;g<c;g++){var O,j,k,_;"vector-uv"===t?(O=d([h[y],f[y]],r),j=Object(a.a)(O,2),v[y]=j[0],p[y]=j[1],v[y]*=i):(k=b([h[y],f[y]],r),_=Object(a.a)(k,2),v[y]=_[0],p[y]=_[1],v[y]*=i,p[y]*=i),y++}var w=new s.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[v,p]});return w.updateStatistics(),w}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(1===r||!Object(o.i)(e))return e;for(var a=e.clone(),i=a.pixels,n=a.width,s=a.height,c=i[0],l=i[1],u=0,h=0;h<s;h++)for(var f=0;f<n;f++)"vector-uv"===t?(c[u]*=r,l[u]*=r):c[u]*=r,u++;return a.updateStatistics(),a}function y(e,t,r,a,i){if(!Object(n.k)(i)||!i.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:r,resolution:e.width/t};var s=i.xmin,o=i.ymax;a=Math.max(a||0,30);var c=Math.ceil(t*(1/a)),l=Math.ceil(r*(1/a)),u=((e.xmax-e.xmin)/c+(e.ymax-e.ymin)/l)/2;return e.xmin=s+Math.floor((e.xmin-s)/u)*u,e.xmax=s+Math.ceil((e.xmax-s)/u)*u,e.ymin=o+Math.floor((e.ymin-o)/u)*u,e.ymax=o+Math.ceil((e.ymax-o)/u)*u,{extent:e,width:Math.round(e.width/u),height:Math.round(e.height/u),resolution:u}}var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.PI,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&(r=(2*Math.PI-r)%(2*Math.PI));var n=i?-1:1,s=13*n,o=-7*n,c=-2*n,l=-16*n,u=29,h=O(0,t+s,r,u),f=Object(a.a)(h,2),d=f[0],b=f[1],v=O(e-5.5,t+o,r,u),p=Object(a.a)(v,2),y=p[0],m=p[1],g=O(e+5.5,t+o,r,u),j=Object(a.a)(g,2),k=j[0],_=j[1],w=O(e-1.5,t+c,r,u),x=Object(a.a)(w,2),P=x[0],R=x[1],I=O(e+1.5,t+c,r,u),S=Object(a.a)(I,2),T=S[0],C=S[1],M=O(e-1.5,t+l,r,u),z=Object(a.a)(M,2),U=z[0],B=z[1],D=O(e+1.5,t+l,r,u),V=Object(a.a)(D,2),A=V[0],L=V[1];return[d,b,y,m,P,R,T,C,k,_,U,B,A,L]}(0,0,0);function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r&&(t=(2*Math.PI-t)%(2*Math.PI));var i=10,n=r?-1:1,s=5*n,o=20*n,c=25*n,l=45,u=0,h=0,f=2,d=0,b=f*n,v=u+i/2,p=h-o,y=v+f,m=p,g=y-d,j=m+b,k=u-i/2,_=h-c,w=k+d,x=_-b,P=Math.ceil(e/5),R=Math.floor(P/10);P-=8*R;for(var I=[],S=[],T=0;T<P/2;T++,R--){R<=0&&P%2==1&&T===(P-1)/2&&(w=(k=u)+d,x=(_=(_+p)/2)-b);var C=O(k,_,t,l),M=Object(a.a)(C,2),z=M[0],U=M[1];if(R>0){var B=O(y,_,t,l),D=Object(a.a)(B,2),V=D[0],A=D[1],L=O(v,p,t,l),F=Object(a.a)(L,2),q=F[0],G=F[1];I.push(V),I.push(A),I.push(z),I.push(U),I.push(q),I.push(G)}else{var E=O(y,m,t,l),W=Object(a.a)(E,2),H=W[0],N=W[1],Q=O(g,j,t,l),J=Object(a.a)(Q,2),K=J[0],X=J[1],Y=O(w,x,t,l),Z=Object(a.a)(Y,2),$=Z[0],ee=Z[1];S.push(z),S.push(U),S.push($),S.push(ee),S.push(K),S.push(X),S.push(H),S.push(N)}_+=s,p+=s,m+=s,j+=s,x+=s}var te=O(u+i/2,h+o,t,l),re=Object(a.a)(te,2),ae=re[0],ie=re[1],ne=i/2+f,se=O(u+ne,h+o,t,l),oe=Object(a.a)(se,2),ce=oe[0],le=oe[1],ue=O(u+i/2,h-c,t,l),he=Object(a.a)(ue,2),fe=he[0],de=he[1],be=O(u+ne,h-c,t,l),ve=Object(a.a)(be,2),pe=ve[0],ye=ve[1];return{pennants:I,barbs:S,shaft:[ae,ie,ce,le,fe,de,pe,ye]}}function O(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Math.sqrt(e*e+t*t)/a,n=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[i,(2*Math.PI+n-r)%(2*Math.PI)]}var j=[0,1,3,6,10,16,21,27,33,40,47,55,63],k=[0,.5,1,1.5,2],_=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function w(e,t,r,a){var i,n=h(a||"knots",r);for(i=1;i<t.length;i++)if(i===t.length-1){if(e<t[i]*n)break}else if(e<=t[i]*n)break;return Math.min(i-1,t.length-2)}function x(e,t,r,a,i){var n=0;switch(t){case"beaufort_kn":n=w(e,j,"knots",r);break;case"beaufort_km":n=w(e,j,"kilometer-per-hour",r);break;case"beaufort_ft":n=w(e,j,"feet-per-second",r);break;case"beaufort_m":n=w(e,j,"meter-per-second",r);break;case"classified_arrow":n=w(e,i,a,r);break;case"ocean_current_m":n=w(e,k,"meter-per-second",r);break;case"ocean_current_kn":n=w(e,_,"knots",r)}return n}var P=[];function R(e,t){for(var r=0,a=0,i=e.width,n=e.height,s=e.mask,o=e.pixels[0],c=[],l=[],u="wind_speed"===t.style?5:Number.MAX_VALUE,h=0;h<n;h++)for(var f=0;f<i;f++){var d=h*i+f;if((!s||s[h*i+f])&&o[d]<u){for(var b=0;b<4;b++)c[r++]=(f+.5)/i,c[r++]=(h+.5)/n,c[r++]=b<2?-.5:.5,c[r++]=b%2==0?-.5:.5,c[r++]=0,c[r++]=o[d];var v=4*(r/24-1);l[a++]=v,l[a++]=v+1,l[a++]=v+2,l[a++]=v+1,l[a++]=v+2,l[a++]=v+3}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(l)}}function I(e,t){return"simple_scalar"===t.style?R(e,t):"wind_speed"===t.style?function(e,t){if(0===P.length)for(var r=0;r<30;r++)P.push(g(5*r,0));for(var a=h(u.fromJSON(t.inputUnit),"knots"),i=e.width,n=e.height,s=e.mask,o=e.pixels[0],c=e.pixels[1],l=[],f=[],d=0,b=0,v=0;v<n;v++)for(var p=0;p<i;p++){var y=v*i+p,m=o[y]*a;if((!s||s[v*i+p])&&m>=5){var O,j=null!=(O=(c[y]+360)%360/180*Math.PI)?O:2*Math.PI*Math.random(),k=P[Math.min(Math.floor(m/5),29)],_=k.pennants,w=k.barbs,x=k.shaft;if(_.length+w.length===0)continue;for(var R=l.length/6,I=(p+.5)/i,S=(v+.5)/n,T=0;T<_.length;T+=2)l[d++]=I,l[d++]=S,l[d++]=_[T],l[d++]=_[T+1]+j,l[d++]=0,l[d++]=m;for(var C=0;C<w.length;C+=2)l[d++]=I,l[d++]=S,l[d++]=w[C],l[d++]=w[C+1]+j,l[d++]=0,l[d++]=m;for(var M=0;M<x.length;M+=2)l[d++]=I,l[d++]=S,l[d++]=x[M],l[d++]=x[M+1]+j,l[d++]=0,l[d++]=m;for(var z=0;z<_.length/6;z++)f[b++]=R,f[b++]=R+1,f[b++]=R+2,R+=3;for(var U=0;U<w.length/8;U++)f[b++]=R,f[b++]=R+1,f[b++]=R+2,f[b++]=R+1,f[b++]=R+2,f[b++]=R+3,R+=4;f[b++]=R+0,f[b++]=R+1,f[b++]=R+2,f[b++]=R+1,f[b++]=R+3,f[b++]=R+2,R+=4}}return{vertexData:new Float32Array(l),indexData:new Uint32Array(f)}}(e,t):function(e,t){for(var r=t.style,a=t.inputUnit,i=t.outputUnit,n=t.breakValues,s=u.fromJSON(a),o=u.fromJSON(i),c=0,l=0,h=e.width,f=e.height,d=e.mask,b=e.pixels[0],v=e.pixels[1],p=d?d.filter((function(e){return e>0})).length:h*f,y=new Float32Array(42*p),g=new Uint32Array(15*p),O=0;O<f;O++)for(var j=0;j<h;j++){var k=O*h+j;if(!d||d[O*h+j]){for(var _,w=null!=(_=(v[k]+360)%360/180*Math.PI)?_:2*Math.PI*Math.random(),P=x(b[k],r,s,o,n),R=0;R<m.length;R+=2)y[c++]=(j+.5)/h,y[c++]=(O+.5)/f,y[c++]=m[R],y[c++]=m[R+1]+w,y[c++]=P,y[c++]=b[k];var I=7*(c/42-1);g[l++]=I,g[l++]=I+1,g[l++]=I+2,g[l++]=I+0,g[l++]=I+4,g[l++]=I+3,g[l++]=I+0,g[l++]=I+2,g[l++]=I+3,g[l++]=I+2,g[l++]=I+5,g[l++]=I+3,g[l++]=I+5,g[l++]=I+6,g[l++]=I+3}}return{vertexData:y,indexData:g}}(e,t)}function S(e,t,r){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,o=e.width,c=e.height,l=e.mask,u=Object(a.a)(e.pixels,2),h=u[0],f=u[1],v=Object(a.a)(i,2),p=v[0],y=v[1],m=Math.round((o-p)/r),g=Math.round((c-y)/r),O=m*g,j=new Float32Array(O),k=new Float32Array(O),_=new Uint8Array(O),w="vector-uv"===t,x=0;x<g;x++)for(var P=0;P<m;P++){for(var R=0,I=x*m+P,S=Math.max(0,x*r+y),T=Math.max(0,P*r+p),C=Math.min(c,S+r),M=Math.min(o,T+r),z=S;z<C;z++)for(var U=T;U<M;U++){var B=z*o+U;if(!l||l[B]){R++;var D=w?[h[B],f[B]]:[h[B],(360+f[B])%360],V=w?D:b(D),A=Object(a.a)(V,2),L=A[0],F=A[1];j[I]+=L,k[I]+=F}}if(R>=(C-S)*(M-T)*(1-n)){_[I]=1;var q=d([j[I]/R,k[I]/R]),G=Object(a.a)(q,2),E=G[0],W=G[1];j[I]=E,k[I]=W}else _[I]=0,j[I]=0,k[I]=0}var H=new s.a({width:m,height:g,pixels:[j,k],mask:_});return H.updateStatistics(),H}}}]);
//# sourceMappingURL=32.d389ef2d.chunk.js.map