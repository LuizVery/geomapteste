{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/I3SIndexInfo.js","../node_modules/@arcgis/core/layers/mixins/SceneService.js"],"names":["n","t","s","a","i","d","l","r","o","Math","floor","rootIndex","nodesPerPage","e","query","f","token","responseType","signal","data","lodSelectionMetricType","type","rootPage","pageSize","lodMetric","urlPrefix","warn","p","c","split","pop","rootNode","pageError","nodeError","url","R","getLogger","N","arguments","spatialReference","fullExtent","heightModelInfo","minScale","maxScale","version","major","Number","NaN","minor","versionString","copyright","sublayerTitleMode","title","layerId","indexInfo","_debouncedSaveOperations","_save","_saveAs","this","_readSpatialReference","y","fromJSON","store","indexCRS","geographicCRS","parseInt","substring","lastIndexOf","length","u","extent","Array","isArray","some","O","xmin","ymin","xmax","ymax","toString","portalItem","h","name","v","g","layer","nonStandardUrlAllowed","logger","_set","S","_get","path","x","parsedUrl","apiKey","hasZ","_updateExtent","nodes","obb","center","halfSize","sqrt","zmin","zmax","mbs","test","_fetchFirstLayerId","_fetchServiceLayer","layers","id","ssl","replace","read","origin","validateLayer","load","beforeSave","typeKeywords","getTypeKeywords","push","filter","indexOf","E","j","from","error","Promise","reject","clone","portal","b","getDefault","_ensureLoadBeforeSave","T","messages","writtenProperties","blockedRelativeUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","write","all","_validateAgainstJSONSchema","_updateTypeKeywords","_signIn","user","addItem","item","folder","_","resourceReferences","itemUrl","update","map","message","details","validationOptions","ignoreUnsupported","enabled","U","validate","portalItemLayerType","join","failPolicy","concat","combined","errors","w","prototype","readOnly","m","json","origins","service","source","String","target","isRequired","ignoreOrigin","I"],"mappings":"wMAI+HA,E,wFAAf,WAAiBA,EAAEC,EAAEC,EAAEC,EAAEC,EAAEC,GAA3B,uBAAAF,EAAA,yDAAkCG,EAAE,MAAQC,YAAEL,GAA9C,wBAAwDM,EAAxD,UAA6DR,EAA7D,eAA4EC,EAAEO,EAAEC,KAAKC,MAAMR,EAAES,UAAUT,EAAEU,cAAzG,kBAA8JC,kBAAEZ,EAAE,CAACa,MAAM,CAACC,EAAE,OAAOC,MAAMb,GAAGc,aAAa,OAAOC,OAAOb,IAAvN,0BAA4Nc,KAA5N,KAA2OjB,EAAES,UAA7O,KAAgQT,EAAEU,aAAlQ,KAAyRV,EAAEkB,uBAA3R,KAA4TZ,EAA5T,mBAAkIa,KAAK,OAAOC,SAA9I,KAAiOX,UAAjO,KAAuPY,SAAvP,KAA+QC,UAA/Q,KAAkTC,UAAlT,yCAAwUlB,YAAEH,IAAIA,EAAEsB,KAAK,oBAAoB,iEAAiEzB,EAA5F,MAAiGK,EAAC,KAAhb,WAAwbL,EAAxb,0CAAic,MAAjc,eAA4c0B,EAA5c,UAAid3B,EAAjd,WAA4d4B,EAAED,GAAG1B,GAAGA,EAAE4B,MAAM,KAAKC,OAAjf,oBAA+hBjB,kBAAEe,EAAE,CAACd,MAAM,CAACC,EAAE,OAAOC,MAAMb,GAAGc,aAAa,OAAOC,OAAOb,IAAxlB,2BAA6lBc,KAA7lB,KAA4mBQ,EAA5mB,mBAAmgBN,KAAK,OAAOU,SAA/gB,KAAkmBN,UAAlmB,gDAA8nB,IAAIjB,IAAE,iCAAiC,qBAAqB,CAACwB,UAAU1B,EAAE2B,UAAS,KAAGC,IAAIN,IAAvtB,kE,mWCA6qCO,EAAE3B,IAAE4B,UAAU,mCAAmCC,EAAE,SAAA7B,GAAI,IAAI6B,EAAC,kDAAiB,aAAa,kCAAC,eAASC,YAAgBC,iBAAiB,KAAK,EAAKC,WAAW,KAAK,EAAKC,gBAAgB,KAAK,EAAKC,SAAS,EAAE,EAAKC,SAAS,EAAE,EAAKC,QAAQ,CAACC,MAAMC,OAAOC,IAAIC,MAAMF,OAAOC,IAAIE,cAAc,IAAI,EAAKC,UAAU,KAAK,EAAKC,kBAAkB,aAAa,EAAKC,MAAM,KAAK,EAAKC,QAAQ,KAAK,EAAKC,UAAU,KAAK,EAAKC,yBAAyBrD,YAAC,uCAAE,WAAMW,EAAEZ,EAAEM,GAAV,SAAAJ,EAAA,2DAAsBU,EAAtB,OAA8B,IAA9B,OAA0D,IAA1D,+CAAuC,EAAK2C,MAAMvD,IAAlD,gCAAmE,EAAKwD,QAAQlD,EAAEN,IAAlF,2CAAF,2DAA9U,EAA9B,wDAAuc,SAAqBY,EAAEZ,GAAG,OAAOyD,KAAKC,sBAAsB1D,KAAngB,mCAAsgB,SAAsBY,GAAG,GAAG,MAAMA,EAAE0B,iBAAiB,OAAOqB,IAAEC,SAAShD,EAAE0B,kBAAmB,IAAMtC,EAAEY,EAAEiD,MAAMvD,EAAEN,EAAE8D,UAAU9D,EAAE+D,cAAcxD,EAAED,GAAG0D,SAAS1D,EAAE2D,UAAU3D,EAAE4D,YAAY,KAAK,EAAE5D,EAAE6D,QAAQ,IAAI,OAAO,MAAM5D,EAAE,IAAIoD,IAAEpD,GAAG,OAAruB,4BAA2uB,SAAeK,EAAEZ,EAAEM,GAAG,GAAG,MAAMM,GAAG,iBAAiBA,EAAE,CAAC,IAAML,EAAE,MAAMK,EAAE0B,iBAAR,2BAA6B1B,GAA7B,IAA+B0B,iBAAiBmB,KAAKC,sBAAsB1D,KAAIY,EAAE,OAAOwD,IAAER,SAASrD,EAAED,GAAG,IAAMC,EAAEP,EAAE6D,MAAM1D,EAAEsD,KAAKC,sBAAsB1D,GAAG,OAAO,MAAMG,GAAG,MAAMI,GAAG,MAAMA,EAAE8D,SAASC,MAAMC,QAAQhE,EAAE8D,SAAS9D,EAAE8D,OAAOG,MAAM,SAAA5D,GAAC,OAAEA,EAAE6D,KAAI,KAAK,IAAIL,IAAE,CAACM,KAAKnE,EAAE8D,OAAO,GAAGM,KAAKpE,EAAE8D,OAAO,GAAGO,KAAKrE,EAAE8D,OAAO,GAAGQ,KAAKtE,EAAE8D,OAAO,GAAG/B,iBAAiBnC,MAA7nC,yBAAioC,SAAYS,EAAEZ,GAAG,IAAMM,EAAEN,EAAE6D,MAAMtD,EAAE,MAAMD,EAAEqC,QAAQrC,EAAEqC,QAAQmC,WAAW,GAAG3E,EAAE,CAACyC,MAAMC,OAAOC,IAAIC,MAAMF,OAAOC,IAAIE,cAAczC,GAAGN,EAAEM,EAAEqB,MAAM,KAAK,OAAO3B,EAAEkE,QAAQ,IAAIhE,EAAEyC,MAAMoB,SAAS/D,EAAE,GAAG,IAAIE,EAAE4C,MAAMiB,SAAS/D,EAAE,GAAG,KAAKE,IAA31C,iCAA61C,SAAoBS,GAAG,MAAM,eAAe6C,KAAKP,uBAAkB,EAAOtC,IAAv6C,8BAAy6C,SAAiBA,EAAEZ,GAAG,IAAMM,EAAEmD,KAAKsB,YAAYtB,KAAKsB,WAAW5B,MAAM,GAAG,eAAeM,KAAKP,kBAAkB,OAAO8B,YAAEvB,KAAKxB,IAAIjC,EAAEiF,MAAM,IAAI1E,EAAEP,EAAEiF,KAAK,IAAI1E,GAAGkD,KAAKxB,IAAI,CAAC,IAAMrB,EAAEE,YAAE2C,KAAKxB,KAAK9B,YAAES,KAAKL,EAAEK,EAAEuC,OAAO,MAAM,gCAAgCM,KAAKP,mBAAmB5C,IAAIC,EAAED,EAAE,MAAMC,GAAG2E,YAAE3E,KAAtsD,eAAysD,SAAQK,GAAG,IAAMZ,EAAEmF,YAAE,CAACC,MAAM3B,KAAKxB,IAAIrB,EAAEyE,uBAAsB,EAAGC,OAAOpD,IAAIuB,KAAK8B,KAAK,MAAMvF,EAAEiC,KAAK,MAAMjC,EAAEoD,SAASK,KAAK8B,KAAK,UAAUvF,EAAEoD,WAAl1D,sBAA21D,SAASxC,EAAEZ,EAAEM,EAAEC,GAAGiF,YAAE/B,KAAK7C,EAAE,SAASZ,EAAEO,KAAj4D,qBAAo4D,WAAgB,IAAMK,EAAE6C,KAAKgC,KAAK,OAAO,IAAI7E,EAAE,OAAO,KAAK,IAAMZ,EAAEE,YAAEU,GAAG,OAAO,MAAM6C,KAAKL,UAAUpD,EAAE0F,KAAF,UAAU1F,EAAE0F,KAAZ,mBAA2BjC,KAAKL,UAAWpD,IAAnhE,+EAAqhE,WAAiCY,EAAEZ,GAAnC,SAAAE,EAAA,yDAAsCuD,KAAKJ,UAAUsC,YAAElC,KAAKmC,UAAUF,KAAKjC,KAAK3B,SAASlB,EAAE6C,KAAKoC,OAAO3D,EAAElC,GAAzG,KAA4G,MAAMyD,KAAKlB,YAAYkB,KAAKlB,WAAWuD,KAAnJ,iCAAyJrC,KAAzJ,SAAkLA,KAAKJ,UAAvL,wBAA8J0C,cAA9J,gEAArhE,oFAAutE,SAAcnF,GAAG,GAAG,UAAU,MAAMA,OAAE,EAAOA,EAAEQ,MAAM,CAAC,IAAIpB,EAAEO,EAAQJ,EAAES,EAAEF,UAAUE,EAAEU,SAASrB,EAAE,OAAOD,EAAEY,EAAES,WAAW,OAAOd,EAAEP,EAAEgG,YAAO,EAAOzF,EAAEJ,GAAG,GAAG,MAAMF,GAAG,MAAMA,EAAEgG,KAAK,MAAMhG,EAAEgG,IAAIC,QAAQ,MAAMjG,EAAEgG,IAAIE,SAAS,MAAM,IAAI7F,IAAE,iCAAiC,sBAAsB,GAAGL,EAAEgG,IAAIC,OAAO,GAAGzB,GAAG,MAAMhB,KAAKlB,YAAYkB,KAAKlB,WAAWuD,KAAK,OAAO,IAAM5F,EAAED,EAAEgG,IAAIE,SAASpG,EAAEE,EAAEgG,IAAIC,OAAO,GAAG7F,EAAEG,KAAK4F,KAAKlG,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,IAAIuD,KAAKlB,WAAW8D,KAAKtG,EAAEM,EAAEoD,KAAKlB,WAAW+D,KAAKvG,EAAEM,OAAO,GAAG,UAAU,MAAMO,OAAE,EAAOA,EAAEQ,MAAM,CAAC,IAAIjB,EAAQH,EAAE,OAAOG,EAAES,EAAEkB,eAAU,EAAO3B,EAAEoG,IAAI,IAAIjC,MAAMC,QAAQvE,IAAI,IAAIA,EAAEmE,QAAQnE,EAAE,GAAGyE,EAAE,OAAO,IAAMnE,EAAEN,EAAE,GAAGO,EAAEP,EAAE,GAAGyD,KAAKlB,WAAW8D,KAAK/F,EAAEC,EAAEkD,KAAKlB,WAAW+D,KAAKhG,EAAEC,KAA94F,kEAAi5F,WAAoBK,GAApB,eAAAV,EAAA,yDAA0B,MAAMuD,KAAKxB,IAArC,sBAA+C,IAAI3B,IAAE,2BAA2B,oEAAhF,UAAuJ,MAAMmD,KAAKL,UAAS,mBAAmBoD,KAAK/C,KAAKxB,KAAxM,gCAA4NwB,KAAKgD,mBAAmB7F,GAApP,OAAuP,OAAnCZ,EAApN,UAAiQyD,KAAKL,QAAQpD,GAA9Q,gCAAwRyD,KAAKiD,mBAAmB9F,IAAhT,gDAAj5F,8HAAosG,WAAyBA,GAAzB,eAAAV,EAAA,sEAA0CF,kBAAEyD,KAAKxB,IAAI,CAACpB,MAAM,CAACC,EAAE,OAAOC,MAAM0C,KAAKoC,QAAQ7E,aAAa,OAAOC,OAAOL,IAApH,aAAkCN,EAAlC,QAA6HY,MAAMoD,MAAMC,QAAQjE,EAAEY,KAAKyF,SAASrG,EAAEY,KAAKyF,OAAOxC,OAAO,GAAtL,yCAA+L7D,EAAEY,KAAKyF,OAAO,GAAGC,IAAhN,gDAApsG,8HAAu5G,WAAyBhG,GAAzB,iBAAAV,EAAA,sEAA0CF,kBAAEyD,KAAKmC,UAAUF,KAAK,CAAC7E,MAAM,CAACC,EAAE,OAAOC,MAAM0C,KAAKoC,QAAQ7E,aAAa,OAAOC,OAAOL,IAA/H,QAAkCN,EAAlC,QAAqIuG,MAAMpD,KAAKxB,IAAIwB,KAAKxB,IAAI6E,QAAQ,UAAU,WAAiBvG,EAAED,EAAEY,KAAKuC,KAAKsD,KAAKxG,EAAE,CAACyG,OAAO,UAAU/E,IAAIwB,KAAKmC,YAAYnC,KAAKwD,cAAc1G,GAA/Q,gDAAv5G,iIAAyqH,sBAAAL,EAAA,sEAAoCuD,KAAKyD,OAAzC,eAAgD,eAAezD,MAAM,mBAAmBA,KAAK0D,YAA7F,qCAA+G1D,KAAK0D,aAApH,gDAAzqH,iFAA0yH,SAAcvG,MAAxzH,iCAA4zH,SAAoBA,EAAEZ,EAAEM,GAAGM,EAAEwG,eAAexG,EAAEwG,aAAa,IAAI,IAArC,EAA2C7G,EAAEP,EAAEqH,kBAA/C,cAAgF9G,GAAhF,IAAiE,gCAAUJ,EAAV,QAAiBS,EAAEwG,aAAaE,KAAKnH,IAAtG,8BAAyGS,EAAEwG,eAAexG,EAAEwG,aAAaxG,EAAEwG,aAAaG,QAAQ,SAAC3G,EAAEZ,EAAEM,GAAL,OAASA,EAAEkH,QAAQ5G,KAAKZ,KAAI,IAAIM,IAAIM,EAAEwG,aAAaxG,EAAEwG,aAAaG,QAAQ,SAAA3G,GAAC,MAAE,mBAAmBA,SAAtlI,4DAA4lI,WAAcA,EAAEZ,GAAhB,UAAAE,EAAA,WAAAA,EAAA,yDAAyBK,EAAzB,2BAA+BkH,GAAKzH,GAAOG,EAAEuH,UAAEC,KAAK/G,GAApD,KAAuDT,EAAvD,4BAA2D+B,EAAE0F,MAAM,+CAAnE,SAAwHC,QAAQC,OAAO,IAAIxH,IAAE,oCAAoC,gDAAjL,cAAkOH,EAAEyG,MAAKzG,EAAEA,EAAE4H,SAAUnB,GAAG,MAAY3G,EAAEE,EAAE6H,QAAQC,IAAEC,aAApR,UAAuSzE,KAAK0E,wBAA5S,eAAoUhI,EAAEiB,KAAKgH,EAAEjI,EAAE6H,OAAO/H,EAAQC,EAAE,CAAC8G,OAAO,cAAc/E,IAAI,KAAKoG,SAAS,GAAGL,OAAO/H,EAAE8E,WAAW5E,EAAEmI,kBAAkB,GAAGC,oBAAoB,GAAGC,UAAU,CAACC,MAAM,GAAGC,SAAS,GAAGC,OAAO,GAAGC,kBAAkB,KAAK7I,EAAE,CAAC4G,OAAO,CAAClD,KAAKoF,MAAM,KAAK3I,KAAziB,UAA2jB2H,QAAQiB,IAAI5I,EAAEsI,UAAUI,mBAAnlB,yBAA4mBnF,KAAKsF,2BAA2BhJ,EAAEG,EAAEK,GAAhpB,eAAmpBJ,EAAE8B,IAAIwB,KAAKxB,IAAI9B,EAAEgD,QAAQhD,EAAEgD,MAAMM,KAAKN,OAAOM,KAAKuF,oBAAoB7I,EAAEI,EAAE,GAA7tB,UAAsuBN,EAAEgJ,UAAxuB,yBAAwvBhJ,EAAEiJ,KAAKC,QAAQ,CAACC,KAAKjJ,EAAEkJ,OAAO9I,GAAGA,EAAE8I,OAAOnI,KAAKnB,IAAvyB,yBAAizBuJ,YAAE7F,KAAK8F,mBAAmBrJ,EAAE,MAA70B,eAAm1BuD,KAAKsB,WAAW5E,EAAEwB,YAAEzB,GAAGA,EAAE6E,WAAW5E,EAAv3B,kBAAy3BA,GAAz3B,iDAA5lI,mHAAu9J,WAAYS,GAAZ,mBAAAV,EAAA,yDAAqBF,EAArB,2BAA2ByH,GAAK7G,GAAhC,KAAmC6C,KAAKsB,WAAxC,4BAAqD7C,EAAE0F,MAAM,wDAA7D,SAA2HC,QAAQC,OAAO,IAAIxH,IAAE,mCAAmC,iEAAnL,eAAqPmD,KAAKsB,WAAW3D,OAAOgH,GAA5Q,6BAAgRlG,EAAE0F,MAAM,+CAA+CnE,KAAKsB,WAAW3D,KAAK,cAAcgH,GAA1W,UAAmXP,QAAQC,OAAO,IAAIxH,IAAE,sCAAN,0CAA+E8H,EAA/E,OAAlY,yBAA+d3E,KAAK0E,wBAApe,eAAkgB5H,EAAE,CAACyG,OAAO,cAAc/E,IAAIwB,KAAKsB,WAAWyE,SAAStJ,YAAEuD,KAAKsB,WAAWyE,SAASnB,SAAS,GAAGL,OAAOvE,KAAKsB,WAAWiD,QAAQC,IAAEC,aAAanD,WAAWtB,KAAKsB,WAAWuD,kBAAkB,GAAGC,oBAAoB,GAAGC,UAAU,CAACC,MAAM,GAAGC,SAAS,GAAGC,OAAO,GAAGC,kBAAkB,KAAKzI,EAAE,CAACwG,OAAO,CAAClD,KAAKoF,MAAM,KAAKtI,KAA/yB,UAAi0BsH,QAAQiB,IAAIvI,EAAEiI,UAAUI,mBAAz1B,yBAAk3BnF,KAAKsF,2BAA2B5I,EAAEI,EAAEP,GAAt5B,eAAy5ByD,KAAKsB,WAAW9C,IAAIwB,KAAKxB,IAAIwB,KAAKsB,WAAW5B,QAAQM,KAAKsB,WAAW5B,MAAMM,KAAKN,OAAOM,KAAKuF,oBAAoBvF,KAAKsB,WAAW/E,EAAE,GAA3hC,UAAoiCyD,KAAKsB,WAAW0E,OAAO,CAACvI,KAAKf,IAAjkC,yBAA2kCmJ,YAAE7F,KAAK8F,mBAAmBhJ,EAAE,MAAvmC,eAA6mCoB,YAAEpB,GAA/mC,kBAAknCkD,KAAKsB,YAAvnC,iDAAv9J,sIAAylM,WAAiCnE,EAAEZ,EAAEO,GAArC,qBAAAL,EAAA,yDAA4CC,EAAEH,EAAEqI,SAASd,QAAQ,SAAA3G,GAAC,MAAE,UAAUA,EAAEQ,QAAOsI,KAAK,SAAA9I,GAAC,OAAE,IAAIN,IAAEM,EAAEqE,KAAKrE,EAAE+I,QAAQ/I,EAAEgJ,YAAcrJ,GAAGA,EAAEsJ,kBAAkBC,oBAAoB3J,EAAEA,EAAEoH,QAAQ,SAAA3G,GAAC,MAAE,sBAAsBA,EAAEqE,MAAM,uBAAuBrE,EAAEqE,MAAM,6BAA6BrE,EAAEqE,MAAM,yBAAyBrE,EAAEqE,MAAM,oBAAoBrE,EAAEqE,MAAM,kCAAkCrE,EAAEqE,UAAQ1E,EAAEsJ,kBAAkBE,UAASC,EAAxa,iCAA0b,wDAA1b,aAAibhK,EAAjb,OAAmeiK,SAASrJ,EAAEL,EAAE2J,sBAA0B/F,OAAO,GAAjhB,oBAA0hBvD,EAA1hB,wCAA6jBZ,EAAEmK,KAAK,OAAWjI,EAAE0F,MAAF,wCAAyChH,IAAK,UAAUL,EAAEsJ,kBAAkBO,WAA3pB,uBAA6qBxJ,EAAEZ,EAAE0J,KAAK,SAAA9I,GAAC,OAAE,IAAIN,IAAE,iCAAiCM,MAAKyJ,OAAOlK,GAAS,IAAIG,IAAE,8BAA8B,4EAA4E,CAACgK,SAAS1J,IAA/2B,aAAw3BT,EAAEgE,OAAO,GAAj4B,uBAAy4B,IAAI7D,IAAE,oBAAoB,wHAAwH,CAACiK,OAAOpK,IAAniC,4CAAzlM,gEAAeI,GAAmnO,OAAOK,YAAE,CAACb,YAAEyK,MAAIpI,EAAEqI,UAAU,UAAK,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAKuC,OAAKvB,EAAEqI,UAAU,wBAAmB,GAAQ7J,YAAE,CAACP,YAAE,mBAAmB,CAAC,mBAAmB,iBAAiB,yBAAyB+B,EAAEqI,UAAU,uBAAuB,MAAM7J,YAAE,CAACb,YAAE,CAACqB,KAAKgD,OAAKhC,EAAEqI,UAAU,kBAAa,GAAQ7J,YAAE,CAACP,YAAE,aAAa,CAAC,aAAa,eAAe,mBAAmB,iBAAiB,yBAAyB+B,EAAEqI,UAAU,iBAAiB,MAAM7J,YAAE,CAACb,YAAE,CAAC2K,UAAS,EAAGtJ,KAAKuJ,OAAKvI,EAAEqI,UAAU,uBAAkB,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAKyB,OAAO+H,KAAK,CAAC3F,KAAK,2BAA2B4D,OAAM,EAAGgC,QAAQ,CAACC,QAAQ,CAAC/D,KAAK,CAACgE,OAAO,YAAYlC,OAAM,QAASzG,EAAEqI,UAAU,gBAAW,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAKyB,OAAO+H,KAAK,CAAC3F,KAAK,2BAA2B4D,OAAM,EAAGgC,QAAQ,CAACC,QAAQ,CAAC/D,KAAK,CAACgE,OAAO,YAAYlC,OAAM,QAASzG,EAAEqI,UAAU,gBAAW,GAAQ7J,YAAE,CAACb,YAAE,CAAC2K,UAAS,KAAMtI,EAAEqI,UAAU,eAAU,GAAQ7J,YAAE,CAACP,YAAE,UAAU,CAAC,mBAAmB+B,EAAEqI,UAAU,cAAc,MAAM7J,YAAE,CAACb,YAAE,CAACqB,KAAK4J,OAAOJ,KAAK,CAAC7D,KAAK,CAACgE,OAAO,qBAAqB3I,EAAEqI,UAAU,iBAAY,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAK4J,OAAOJ,KAAK,CAAC7D,MAAK,MAAO3E,EAAEqI,UAAU,yBAAoB,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAK4J,UAAU5I,EAAEqI,UAAU,aAAQ,GAAQ7J,YAAE,CAACP,YAAE,cAAc,UAAU+B,EAAEqI,UAAU,sBAAsB,MAAM7J,YAAE,CAACP,YAAE,UAAU,QAAQ,CAAC,UAAU+B,EAAEqI,UAAU,mBAAmB,MAAM7J,YAAE,CAACb,YAAE,CAACqB,KAAKyB,OAAO+H,KAAK,CAACC,QAAQ,CAACC,QAAQ,CAAC/D,KAAK,CAACgE,OAAO,OAAO,cAAc,CAAClC,MAAM,CAACoC,OAAO,KAAKC,YAAW,EAAGC,cAAa,GAAIpE,MAAK,QAAS3E,EAAEqI,UAAU,eAAU,GAAQ7J,YAAE,CAACb,YAAEqL,MAAIhJ,EAAEqI,UAAU,MAAM,MAAM7J,YAAE,CAACR,YAAE,QAAQgC,EAAEqI,UAAU,WAAW,MAAM7J,YAAE,CAACb,eAAKqC,EAAEqI,UAAU,YAAY,MAAM7J,YAAE,CAACb,YAAE,CAAC2K,UAAS,KAAMtI,EAAEqI,UAAU,aAAQ,GAAQ7J,YAAE,CAACb,YAAE,CAACqB,KAAK4J,OAAON,UAAS,EAAGE,KAAK,CAAC7D,KAAK,CAACgE,OAAO,sBAAsB3I,EAAEqI,UAAU,gBAAW,GAAQrI,EAAExB,YAAE,CAACc,YAAE,oCAAoCU,GAAGA,GAAGqC,GAAG,KAAKuF,GAAE,EAAG5B,EAAE,gBAAgBX,EAAE,CAACJ,gBAAgB,iBAAI,IAAG6C,oBAAoB,UAAUL,kBAAkB,CAACE,SAAQ,EAAGD,mBAAkB,EAAGM,WAAW","file":"static/js/14.9d7b62ef.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import o from\"../../core/Error.js\";import{isSome as r}from\"../../core/maybe.js\";async function n(n,t,s,a,i,d){let l=null;if(r(s)){const o=`${n}/nodepages/`,t=o+Math.floor(s.rootIndex/s.nodesPerPage);try{return{type:\"page\",rootPage:(await e(t,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,rootIndex:s.rootIndex,pageSize:s.nodesPerPage,lodMetric:s.lodSelectionMetricType,urlPrefix:o}}catch(f){r(i)&&i.warn(\"#fetchIndexInfo()\",\"Failed to load root node page. Falling back to node documents.\",t,f),l=f}}if(!t)return null;const p=`${n}/nodes/`,c=p+(t&&t.split(\"/\").pop());try{return{type:\"node\",rootNode:(await e(c,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,urlPrefix:p}}catch(f){throw new o(\"sceneservice:root-node-missing\",\"Root node missing.\",{pageError:l,nodeError:f,url:c})}}export{n as fetchIndexInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import r from\"../../core/Error.js\";import\"../../core/has.js\";import o from\"../../core/Logger.js\";import{isSome as i}from\"../../core/maybe.js\";import{debounce as s}from\"../../core/promiseUtils.js\";import{urlToObject as a}from\"../../core/urlUtils.js\";import{property as n}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as l}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as d}from\"../../core/accessorSupport/decorators/writer.js\";import{updateOrigins as c}from\"../../core/accessorSupport/originUtils.js\";import u from\"../../geometry/Extent.js\";import m from\"../../geometry/HeightModelInfo.js\";import y from\"../../geometry/SpatialReference.js\";import{titleFromUrlAndName as h,parse as f,cleanTitle as v,sanitizeUrlWithLayerId as g,writeUrlWithLayerId as S}from\"../support/arcgisLayerUrl.js\";import{id as w,url as I}from\"../support/commonProperties.js\";import{fetchIndexInfo as x}from\"../support/I3SIndexInfo.js\";import b from\"../../portal/Portal.js\";import j from\"../../portal/PortalItem.js\";import{saveResources as _}from\"../../webdoc/support/saveUtils.js\";const R=o.getLogger(\"esri.layers.mixins.SceneService\"),N=o=>{let N=class extends o{constructor(){super(...arguments),this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:\"\"},this.copyright=null,this.sublayerTitleMode=\"item-title\",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=s((async(e,t,r)=>{switch(e){case 0:return this._save(t);case 1:return this._saveAs(r,t)}}))}readSpatialReference(e,t){return this._readSpatialReference(t)}_readSpatialReference(e){if(null!=e.spatialReference)return y.fromJSON(e.spatialReference);{const t=e.store,r=t.indexCRS||t.geographicCRS,o=r&&parseInt(r.substring(r.lastIndexOf(\"/\")+1,r.length),10);return null!=o?new y(o):null}}readFullExtent(e,t,r){if(null!=e&&\"object\"==typeof e){const o=null==e.spatialReference?{...e,spatialReference:this._readSpatialReference(t)}:e;return u.fromJSON(o,r)}const o=t.store,i=this._readSpatialReference(t);return null==i||null==o||null==o.extent||!Array.isArray(o.extent)||o.extent.some((e=>e<O))?null:new u({xmin:o.extent[0],ymin:o.extent[1],xmax:o.extent[2],ymax:o.extent[3],spatialReference:i})}readVersion(e,t){const r=t.store,o=null!=r.version?r.version.toString():\"\",i={major:Number.NaN,minor:Number.NaN,versionString:o},s=o.split(\".\");return s.length>=2&&(i.major=parseInt(s[0],10),i.minor=parseInt(s[1],10)),i}readTitlePortalItem(e){return\"item-title\"!==this.sublayerTitleMode?void 0:e}readTitleService(e,t){const r=this.portalItem&&this.portalItem.title;if(\"item-title\"===this.sublayerTitleMode)return h(this.url,t.name);let o=t.name;if(!o&&this.url){const e=f(this.url);i(e)&&(o=e.title)}return\"item-title-and-service-name\"===this.sublayerTitleMode&&r&&(o=r+\" - \"+o),v(o)}set url(e){const t=g({layer:this,url:e,nonStandardUrlAllowed:!1,logger:R});this._set(\"url\",t.url),null!=t.layerId&&this._set(\"layerId\",t.layerId)}writeUrl(e,t,r,o){S(this,e,\"layers\",t,o)}get parsedUrl(){const e=this._get(\"url\");if(!e)return null;const t=a(e);return null!=this.layerId&&(t.path=`${t.path}/layers/${this.layerId}`),t}async _fetchIndexAndUpdateExtent(e,t){this.indexInfo=x(this.parsedUrl.path,this.rootNode,e,this.apiKey,R,t),null==this.fullExtent||this.fullExtent.hasZ||this._updateExtent(await this.indexInfo)}_updateExtent(e){if(\"page\"===(null==e?void 0:e.type)){var t,o;const i=e.rootIndex%e.pageSize,s=null==(t=e.rootPage)||null==(o=t.nodes)?void 0:o[i];if(null==s||null==s.obb||null==s.obb.center||null==s.obb.halfSize)throw new r(\"sceneservice:invalid-node-page\",\"Invalid node page.\");if(s.obb.center[0]<O||null==this.fullExtent||this.fullExtent.hasZ)return;const a=s.obb.halfSize,n=s.obb.center[2],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);this.fullExtent.zmin=n-l,this.fullExtent.zmax=n+l}else if(\"node\"===(null==e?void 0:e.type)){var i;const t=null==(i=e.rootNode)?void 0:i.mbs;if(!Array.isArray(t)||4!==t.length||t[0]<O)return;const r=t[2],o=t[3];this.fullExtent.zmin=r-o,this.fullExtent.zmax=r+o}}async _fetchService(e){if(null==this.url)throw new r(\"sceneservice:url-not-set\",\"Scene service can not be loaded without valid portal item or url\");if(null==this.layerId&&/SceneServer\\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}return this._fetchServiceLayer(e)}async _fetchFirstLayerId(e){const r=await t(this.url,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e});if(r.data&&Array.isArray(r.data.layers)&&r.data.layers.length>0)return r.data.layers[0].id}async _fetchServiceLayer(e){const r=await t(this.parsedUrl.path,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e});r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\"));const o=r.data;this.read(o,{origin:\"service\",url:this.parsedUrl}),this.validateLayer(o)}async _ensureLoadBeforeSave(){await this.load(),\"beforeSave\"in this&&\"function\"==typeof this.beforeSave&&await this.beforeSave()}validateLayer(e){}_updateTypeKeywords(e,t,r){e.typeKeywords||(e.typeKeywords=[]);const o=t.getTypeKeywords();for(const i of o)e.typeKeywords.push(i);e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)),1===r&&(e.typeKeywords=e.typeKeywords.filter((e=>\"Hosted Service\"!==e))))}async _saveAs(e,t){const o={...E,...t};let i=j.from(e);i||(R.error(\"_saveAs(): requires a portal item parameter\"),await Promise.reject(new r(\"sceneservice:portal-item-required\",\"_saveAs() requires a portal item to save to\"))),i.id&&(i=i.clone(),i.id=null);const s=i.portal||b.getDefault();await this._ensureLoadBeforeSave(),i.type=T,i.portal=s;const a={origin:\"portal-item\",url:null,messages:[],portal:s,portalItem:i,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},n={layers:[this.write(null,a)]};return await Promise.all(a.resources.pendingOperations),await this._validateAgainstJSONSchema(n,a,o),i.url=this.url,i.title||(i.title=this.title),this._updateTypeKeywords(i,o,1),await s._signIn(),await s.user.addItem({item:i,folder:o&&o.folder,data:n}),await _(this.resourceReferences,a,null),this.portalItem=i,c(a),a.portalItem=i,i}async _save(e){const t={...E,...e};this.portalItem||(R.error(\"_save(): requires the .portalItem property to be set\"),await Promise.reject(new r(\"sceneservice:portal-item-not-set\",\"Portal item to save to has not been set on this SceneService\"))),this.portalItem.type!==T&&(R.error(\"_save(): Non-matching portal item type. Got \"+this.portalItem.type+\", expected \"+T),await Promise.reject(new r(\"sceneservice:portal-item-wrong-type\",`Portal item needs to have type \"${T}\"`))),await this._ensureLoadBeforeSave();const o={origin:\"portal-item\",url:this.portalItem.itemUrl&&a(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||b.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},i={layers:[this.write(null,o)]};return await Promise.all(o.resources.pendingOperations),await this._validateAgainstJSONSchema(i,o,t),this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,t,0),await this.portalItem.update({data:i}),await _(this.resourceReferences,o,null),c(o),this.portalItem}async _validateAgainstJSONSchema(e,t,o){let i=t.messages.filter((e=>\"error\"===e.type)).map((e=>new r(e.name,e.message,e.details)));if(o&&o.validationOptions.ignoreUnsupported&&(i=i.filter((e=>\"layer:unsupported\"!==e.name&&\"symbol:unsupported\"!==e.name&&\"symbol-layer:unsupported\"!==e.name&&\"property:unsupported\"!==e.name&&\"url:unsupported\"!==e.name&&\"scenemodification:unsupported\"!==e.name))),o.validationOptions.enabled||U){const t=(await import(\"../support/schemaValidator.js\")).validate(e,o.portalItemLayerType);if(t.length>0){const e=`Layer item did not validate:\\n${t.join(\"\\n\")}`;if(R.error(`_validateAgainstJSONSchema(): ${e}`),\"throw\"===o.validationOptions.failPolicy){const e=t.map((e=>new r(\"sceneservice:schema-validation\",e))).concat(i);throw new r(\"sceneservice-validate:error\",\"Failed to save layer item due to schema validation, see `details.errors`.\",{combined:e})}}}if(i.length>0)throw new r(\"sceneservice:save\",\"Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:i})}};return e([n(w)],N.prototype,\"id\",void 0),e([n({type:y})],N.prototype,\"spatialReference\",void 0),e([l(\"spatialReference\",[\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],N.prototype,\"readSpatialReference\",null),e([n({type:u})],N.prototype,\"fullExtent\",void 0),e([l(\"fullExtent\",[\"fullExtent\",\"store.extent\",\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],N.prototype,\"readFullExtent\",null),e([n({readOnly:!0,type:m})],N.prototype,\"heightModelInfo\",void 0),e([n({type:Number,json:{name:\"layerDefinition.minScale\",write:!0,origins:{service:{read:{source:\"minScale\"},write:!1}}}})],N.prototype,\"minScale\",void 0),e([n({type:Number,json:{name:\"layerDefinition.maxScale\",write:!0,origins:{service:{read:{source:\"maxScale\"},write:!1}}}})],N.prototype,\"maxScale\",void 0),e([n({readOnly:!0})],N.prototype,\"version\",void 0),e([l(\"version\",[\"store.version\"])],N.prototype,\"readVersion\",null),e([n({type:String,json:{read:{source:\"copyrightText\"}}})],N.prototype,\"copyright\",void 0),e([n({type:String,json:{read:!1}})],N.prototype,\"sublayerTitleMode\",void 0),e([n({type:String})],N.prototype,\"title\",void 0),e([l(\"portal-item\",\"title\")],N.prototype,\"readTitlePortalItem\",null),e([l(\"service\",\"title\",[\"name\"])],N.prototype,\"readTitleService\",null),e([n({type:Number,json:{origins:{service:{read:{source:\"id\"}},\"portal-item\":{write:{target:\"id\",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],N.prototype,\"layerId\",void 0),e([n(I)],N.prototype,\"url\",null),e([d(\"url\")],N.prototype,\"writeUrl\",null),e([n()],N.prototype,\"parsedUrl\",null),e([n({readOnly:!0})],N.prototype,\"store\",void 0),e([n({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],N.prototype,\"rootNode\",void 0),N=e([p(\"esri.layers.mixins.SceneService\")],N),N},O=-1e38,U=!1,T=\"Scene Service\",E={getTypeKeywords:()=>[],portalItemLayerType:\"unknown\",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:\"throw\"}};export{T as SCENE_SERVICE_ITEM_TYPE,N as SceneService};\n"],"sourceRoot":""}