(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[7],{1002:function(e,t,r){"use strict";r.d(t,"a",(function(){return q}));var i=r(8),n=r.n(i),a=r(12),s=r(15),c=r(35),u=r(3),l=r(4),o=r(47),d=r(44),b=r(6),p=r(7),f=r(0),h=r(20),j=r(16),y=r(2),O=r(23),v=r(27),m=r(1),w=(r(17),r(18),r(9)),x=r(200),k=r(81),F=r(163),g=r(157),R=r(1056),E=r(925),I=r(942),S=r(545),_=j.a.getLogger("esri.views.layers.FeatureLayerView"),q=function(e){var t=function(e){Object(b.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(u.a)(this,r);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n)))._updatingRequiredFieldsPromise=null,e.effect=null,e.filter=null,e.timeExtent=null,e.layer=null,e.requiredFields=[],e.view=null,e}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;Object(v.a)(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","layer.displayField","filter","effect","layer.timeInfo","layer.floorInfo","timeExtent"],(function(){return e._handleRequiredFieldsChange()}),!0),Object(v.b)(this,"view.floors","change",(function(){return e._handleRequiredFieldsChange()})),Object(v.b)(this,"layer.sublayer","change",(function(){return e._handleRequiredFieldsChange()}))}},{key:"availableFields",get:function(){var e=this.layer,t=this.layer.fieldsIndex,r=this.requiredFields;return"outFields"in e&&e.outFields?Object(k.j)(t,[].concat(Object(c.a)(Object(k.v)(t,e.outFields)),Object(c.a)(r))):Object(k.j)(t,r)}},{key:"maximumNumberOfFeatures",get:function(){return 0},set:function(e){_.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}},{key:"maximumNumberOfFeaturesExceeded",get:function(){return!1}},{key:"highlight",value:function(e){throw new Error("missing implementation")}},{key:"createQuery",value:function(){var e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=Object(y.k)(this.filter)?this.filter.createQuery(e):new F.a(e);if("feature"===this.layer.type){var r=Object(S.b)(this);Object(y.k)(r)&&(t.where=t.where?"(".concat(t.where,") AND (").concat(r,")"):r)}return Object(y.k)(this.timeExtent)&&(t.timeExtent=Object(y.k)(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}},{key:"queryFeatures",value:function(e,t){throw new Error("missing implementation")}},{key:"queryObjectIds",value:function(e,t){throw new Error("missing implementation")}},{key:"queryFeatureCount",value:function(e,t){throw new Error("missing implementation")}},{key:"queryExtent",value:function(e,t){throw new Error("missing implementation")}},{key:"_loadArcadeModules",value:function(e){if(e.get("expressionInfos.length"))return Object(g.e)()}},{key:"_handleRequiredFieldsChange",value:function(){var e=this,t=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",t),t.then((function(){e._updatingRequiredFieldsPromise===t&&e._set("_updatingRequiredFieldsPromise",null)}))}},{key:"_updateRequiredFields",value:function(){var e=Object(s.a)(n.a.mark((function e(){var t,r,i,s,c,u,l,o,d,b,p,f,h,j,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.layer&&this.view){e.next=2;break}return e.abrupt("return");case 2:return t="3d"===this.view.type,r=this.layer,i=this.layer,s=i.fieldsIndex,c=i.objectIdField,u="renderer"in r&&r.renderer,l="orderBy"in r&&r.orderBy,o=r.featureReduction,d=new Set,e.next=13,Object(O.k)([u?u.collectRequiredFields(d,s):null,Object(k.g)(d,r),t?Object(k.b)(d,r):null,Object(y.k)(this.filter)?Object(k.f)(d,r,this.filter):null,this.effect?Object(k.f)(d,r,this.effect.filter):null,o?Object(k.c)(d,r,o):null,l?Object(k.h)(d,r,l):null]);case 13:if(b=e.sent,r.timeInfo&&this.timeExtent&&Object(k.e)(d,r.fieldsIndex,[r.timeInfo.startField,r.timeInfo.endField]),"feature"===r.type&&r.floorInfo&&Object(k.e)(d,r.fieldsIndex,[r.floorInfo.floorField]),"subtype-group"!==r.type){e.next=19;break}return Object(k.d)(d,s,r.subtypeField),p=r.sublayers.map((function(e){var t;return Promise.all([null==(t=e.renderer)?void 0:t.collectRequiredFields(d,s),Object(k.g)(d,e)])})),e.next=19,Object(O.k)(p);case 19:f=Object(a.a)(b);try{for(f.s();!(h=f.n()).done;)(j=h.value).error&&_.error(j.error)}catch(n){f.e(n)}finally{f.f()}Object(k.d)(d,s,c),t&&"displayField"in r&&r.displayField&&Object(k.d)(d,s,r.displayField),v=Array.from(d).sort(),this._set("requiredFields",v);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateFetchPopupFeatures",value:function(e){if(Object(y.j)(e))return null;var t,r=Object(a.a)(e.clientGraphics);try{for(r.s();!(t=r.n()).done;){var i=t.value.layer;if("popupEnabled"in i&&!i.popupEnabled)return new h.a("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:i});if("popupTemplate"in i&&!Object(I.a)(i,e))return new h.a("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:i})}}catch(n){r.e(n)}finally{r.f()}}},{key:"fetchClientPopupFeatures",value:function(){var e=Object(s.a)(n.a.mark((function e(t){var r,i,s,c,u,l,o,d,b,p,f,h=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Object(y.k)(t)?t.clientGraphics:null)&&0!==r.length){e.next=3;break}return e.abrupt("return",Promise.resolve([]));case 3:return i=[],s=[],e.next=7,this.createPopupQuery(t);case 7:c=e.sent,u=Object(a.a)(r),e.prev=9,u.s();case 11:if((l=u.n()).done){e.next=25;break}if(o=l.value,"popupEnabled"in(d=o.layer)){e.next=16;break}return e.abrupt("continue",23);case 16:if(b=Object(k.v)(this.layer.fieldsIndex,c.outFields),p=Object(I.a)(d,t),Object(y.k)(p)){e.next=19;break}return e.abrupt("continue",23);case 19:return e.next=21,this._loadArcadeModules(p);case 21:(f=e.sent)&&f.arcadeUtils.hasGeometryOperations(p)||!Object(k.i)(b,o)?s.push(o):i.push(o);case 23:e.next=11;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(9),u.e(e.t0);case 30:return e.prev=30,u.f(),e.finish(30);case 33:return e.abrupt("return","stream"===this.layer.type||0===s.length?Promise.resolve(i):(c.objectIds=s.map((function(e){return e.attributes[h.layer.objectIdField]})),this.layer.queryFeatures(c).then((function(e){return i.concat(e.features)})).catch((function(){return s}))));case 34:case"end":return e.stop()}}),e,this,[[9,27,30,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createPopupQuery",value:function(){var e=Object(s.a)(n.a.mark((function e(t){var r,i,s,c,u,l,o,d,b,p,f,h,j,O,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.layer.createQuery(),i=new Set,s=!1,c=Object(y.k)(t)&&t.clientGraphics?t.clientGraphics.map((function(e){return e.layer})):[this.layer],u=Object(a.a)(c),e.prev=4,u.s();case 6:if((l=u.n()).done){e.next=25;break}if("popupEnabled"in(o=l.value)){e.next=10;break}return e.abrupt("continue",23);case 10:if(d=Object(I.a)(o,t),Object(y.k)(d)){e.next=13;break}return e.abrupt("continue",23);case 13:return e.next=15,this._loadArcadeModules(d);case 15:return b=e.sent,p=b&&b.arcadeUtils.hasGeometryOperations(d),s=!("point"!==this.layer.geometryType&&!p),e.next=20,Object(I.b)(this.layer,d);case 20:f=e.sent,h=Object(a.a)(f);try{for(h.s();!(j=h.n()).done;)O=j.value,i.add(O)}catch(n){h.e(n)}finally{h.f()}case 23:e.next=6;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(4),u.e(e.t0);case 30:return e.prev=30,u.f(),e.finish(30);case 33:return r.returnGeometry=s,r.returnZ=s,r.returnM=s,r.outFields=Array.from(i),r.outSpatialReference=this.view.spatialReference,"feature"===this.layer.type&&(v=Object(S.b)(this),Object(y.k)(v)&&(r.where=r.where?"(".concat(r.where,") AND (").concat(v,")"):v)),e.abrupt("return",r);case 35:case"end":return e.stop()}}),e,this,[[4,27,30,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){return!!Object(o.a)(Object(d.a)(r.prototype),"canResume",this).call(this)&&(!Object(y.k)(this.timeExtent)||!this.timeExtent.isEmpty)}}]),r}(e);return Object(f.a)([Object(m.b)()],t.prototype,"_updatingRequiredFieldsPromise",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],t.prototype,"availableFields",null),Object(f.a)([Object(m.b)({type:R.a})],t.prototype,"effect",void 0),Object(f.a)([Object(m.b)({type:E.a})],t.prototype,"filter",void 0),Object(f.a)([Object(m.b)(x.a)],t.prototype,"timeExtent",void 0),Object(f.a)([Object(m.b)()],t.prototype,"layer",void 0),Object(f.a)([Object(m.b)({type:Number})],t.prototype,"maximumNumberOfFeatures",null),Object(f.a)([Object(m.b)({readOnly:!0,type:Boolean})],t.prototype,"maximumNumberOfFeaturesExceeded",null),Object(f.a)([Object(m.b)({readOnly:!0})],t.prototype,"requiredFields",void 0),Object(f.a)([Object(m.b)()],t.prototype,"suspended",void 0),Object(f.a)([Object(m.b)()],t.prototype,"view",void 0),t=Object(f.a)([Object(w.a)("esri.views.layers.FeatureLayerView")],t),t}},1056:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i,n=r(3),a=r(4),s=r(6),c=r(7),u=r(0),l=r(25),o=r(1),d=(r(17),r(18),r(16),r(9)),b=r(925),p=i=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).filter=null,e.includedEffect=null,e.excludedEffect=null,e.excludedLabelsVisible=!1,e}return Object(a.a)(r,[{key:"clone",value:function(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}}]),r}(l.a);Object(u.a)([Object(o.b)({type:b.a,json:{write:!0}})],p.prototype,"filter",void 0),Object(u.a)([Object(o.b)({json:{write:!0}})],p.prototype,"includedEffect",void 0),Object(u.a)([Object(o.b)({json:{write:!0}})],p.prototype,"excludedEffect",void 0),Object(u.a)([Object(o.b)({type:Boolean,json:{write:!0}})],p.prototype,"excludedLabelsVisible",void 0);var f=p=i=Object(u.a)([Object(d.a)("esri.views.layers.support.FeatureEffect")],p)},908:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(3),n=r(4),a=r(6),s=r(7),c=r(0),u=r(16),l=r(23),o=r(27),d=r(1),b=(r(17),r(18),r(9)),p=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(n.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(o.b)(this,"layer","refresh",(function(){e.doRefresh().catch((function(t){Object(l.n)(t)||u.a.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return Object(c.a)([Object(d.b)()],t.prototype,"layer",void 0),t=Object(c.a)([Object(b.a)("esri.layers.mixins.RefreshableLayerView")],t)}},925:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var i,n=r(14),a=r(3),s=r(4),c=r(6),u=r(7),l=r(0),o=r(112),d=r(164),b=r(57),p=r(25),f=r(26),h=r(1),j=(r(18),r(17),r(16),r(9)),y=r(43),O=r(77),v=r(163),m=new b.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),w=new b.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),x=i=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).where=null,i.geometry=null,i.spatialRelationship="intersects",i.hiddenIds=new Set,i.distance=void 0,i.objectIds=null,i.units=null,i.timeExtent=null,i.enabled=!1,i}return Object(s.a)(r,[{key:"writeWhere",value:function(e,t){t.where=e||"1=1"}},{key:"enable",value:function(){this._set("enabled",!0)}},{key:"createQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.where,r=this.geometry,i=this.spatialRelationship,a=this.timeExtent,s=this.objectIds,c=this.units,u=this.distance;return new v.a(Object(n.a)({geometry:Object(f.a)(r),objectIds:Object(f.a)(s),spatialRelationship:i,timeExtent:Object(f.a)(a),where:t,units:c,distance:u},e))}},{key:"clone",value:function(){var e=this.where,t=this.geometry,r=this.spatialRelationship,n=this.hiddenIds,a=this.timeExtent,s=this.objectIds,c=this.units,u=this.distance,l=new Set;return n.forEach((function(e){return l.add(e)})),new i({geometry:Object(f.a)(t),hiddenIds:l,objectIds:Object(f.a)(s),spatialRelationship:r,timeExtent:Object(f.a)(a),where:e,units:c,distance:u})}}]),r}(p.a);Object(l.a)([Object(h.b)({type:String})],x.prototype,"where",void 0),Object(l.a)([Object(y.a)("where")],x.prototype,"writeWhere",null),Object(l.a)([Object(h.b)({types:o.a,json:{read:O.a,write:!0}})],x.prototype,"geometry",void 0),Object(l.a)([Object(h.b)({type:String,json:{read:{source:"spatialRel",reader:m.read},write:{target:"spatialRel",writer:m.write}}})],x.prototype,"spatialRelationship",void 0),Object(l.a)([Object(h.b)({json:{write:function(e,t,r){return t[r]=Array.from(e)},read:function(e){return new Set(e)}}})],x.prototype,"hiddenIds",void 0),Object(l.a)([Object(h.b)({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],x.prototype,"distance",void 0),Object(l.a)([Object(h.b)({type:[Number],json:{write:!0}})],x.prototype,"objectIds",void 0),Object(l.a)([Object(h.b)({type:String,json:{read:w.read,write:{writer:w.write,overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],x.prototype,"units",void 0),Object(l.a)([Object(h.b)({type:d.a,json:{write:!0}})],x.prototype,"timeExtent",void 0),Object(l.a)([Object(h.b)({readOnly:!0})],x.prototype,"enabled",void 0);var k=x=i=Object(l.a)([Object(j.a)("esri.views.layers.support.FeatureFilter")],x)},942:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return l}));var i=r(8),n=r.n(i),a=r(35),s=r(15),c=r(2),u=r(81);function l(e){return o.apply(this,arguments)}function o(){return o=Object(s.a)(n.a.mark((function e(t){var r,i,s,l,o,d,b,p,f,h=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>1&&void 0!==h[1]?h[1]:t.popupTemplate,Object(c.k)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,r.getRequiredFields(t.fieldsIndex);case 5:if(i=e.sent,s=r.lastEditInfoEnabled,l=t.objectIdField,o=t.typeIdField,d=t.globalIdField,b=t.relationships,!i.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!s){e.next=19;break}return e.next=16,Object(u.n)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return p=e.t0,f=Object(u.j)(t.fieldsIndex,[].concat(Object(a.a)(i),Object(a.a)(p))),e.abrupt("return",(o&&f.push(o),f&&l&&t.fieldsIndex.has(l)&&-1===f.indexOf(l)&&f.push(l),f&&d&&t.fieldsIndex.has(d)&&-1===f.indexOf(d)&&f.push(d),b&&b.forEach((function(e){var r=e.keyField;f&&r&&t.fieldsIndex.has(r)&&-1===f.indexOf(r)&&f.push(r)})),f));case 23:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function d(e,t){return e.popupTemplate?e.popupTemplate:Object(c.k)(t)&&t.defaultPopupTemplateEnabled&&Object(c.k)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=7.57dd45d1.chunk.js.map