"use strict";(globalThis.webpackChunkgeowebmap=globalThis.webpackChunkgeowebmap||[]).push([[9714],{9714:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(27366),r=s(10064),a=s(92026),n=s(8537),o=s(49861),l=(s(63780),s(93169),s(25243),s(69912)),d=s(92975),h=s(54180),u=s(42069),y=s(67581),c=s(49800);let p=class extends((0,u.A)(y.Z)){constructor(){super(...arguments),this._usedMemory=0,this._futureMemory=0,this.type="voxel-3d",this._wasmLayerId=-1}initialize(){var e;if("local"!==this.view.viewingMode)throw new r.Z("voxel:unsupported-viewingMode","Voxel layers support local viewingMode only.",{});if(this.view._stage.renderView.renderingContext.type!==c.zO.WEBGL2)throw new r.Z("voxel:unsupported-context","Voxel layers are supported in WebGL2 rendering contexts only.",{});if(null==(e=this.view._stage.renderView.renderingContext.capabilities.colorBufferFloat)||!e.textureFloat)throw new r.Z("voxel:missing-color-buffer-float","Voxel layers require the WebGL2 extension EXT_color_buffer_float",{});const t=this.layer.spatialReference;if(!(0,d.fS)(t,this.view.spatialReference))throw new r.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});const s=this.layer.style.currentVariableId,i=this.layer.getVolume(s),o=this.layer.getVariable(s);if((0,a.pC)(i)&&(0,a.pC)(o)){const e=i.dimensions[0],t=i.dimensions[1],s=i.getZDimension();if(s>1){const r=i.dimensions[s],a=e.size*t.size*r.size;let n=1;switch(o.renderingFormat.type){case"Int16":case"UInt16":n=2;break;case"Int32":case"UInt32":case"Float32":n=4}this._futureMemory=n*a}}const l=h.Z.getInstance(),u=l.addLayer(this.view,this).then((e=>{this._wasmLayerId=e,this._suspendedHandle=(0,n.S1)(this,"suspended",(e=>{h.Z.getInstance().setLayerEnabled(this.view,this,!e)}))})).catch((e=>{if(l.removeLayer(this.view,this),this._wasmLayerId=-1,-1===e)throw new r.Z("voxel:addLayer-failure","The voxel layer description was invalid.",{});if(-2===e)throw new r.Z("voxel:addLayer-failure","The voxel layer web assembly module failed to download.",{})}));this.addResolvingPromise(u)}destroy(){h.Z.getInstance().removeLayer(this.view,this),this._suspendedHandle&&(this._suspendedHandle.remove(),this._suspendedHandle=null)}isUpdating(){return!(this._wasmLayerId<0)&&h.Z.getInstance().isUpdating(this.view,this._wasmLayerId)}updatingFlagChanged(){this.notifyChange("updating")}getUsedMemory(){return this._usedMemory}getUnloadedMemory(){return this._futureMemory}ignoresMemoryFactor(){return!0}get performanceInfo(){return{nodes:0,displayedNumberOfFeatures:0,maximumNumberOfFeatures:0,totalNumberOfFeatures:0,core:null}}setUsedMemory(e){this._usedMemory=e,this._futureMemory=0}};(0,i._)([(0,o.Cb)()],p.prototype,"layer",void 0),(0,i._)([(0,o.Cb)({readOnly:!0,aliasOf:"layer.parsedUrl.path"})],p.prototype,"baseUrl",void 0),p=(0,i._)([(0,l.j)("esri.views.3d.layers.VoxelLayerView3D")],p);const w=p}}]);
//# sourceMappingURL=9714.f9ab89cd.chunk.js.map