{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightAnalysis.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightRayIntersector.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightResult.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightController.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightConfiguration.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightView.js","../node_modules/@arcgis/core/views/3d/layers/LineOfSightLayerView3D.js"],"names":["c","e","view","_resources","_transform","t","this","object","s","r","transformation","attached","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","visible","setVisible","addMany","destroyResources","a","isPickable","updatePolicy","add","i","castShadow","createExternalResources","forEachExternalMaterial","layer","remove","dispose","destroyExternalResources","o","_attached","_resourcesCreated","_visible","watch","_createResources","_destroyResources","console","error","updateVisibility","m","_renderOccluded","_width","_color","p","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","applyProps","push","geometry","spatialReference","h","n","renderCoordsHelper","toRenderCoords","lines","forEach","origin","endpoint","basis1","basis2","l","endRenderSpace","g","transform","createRenderGeometry","points","map","_updateMaterial","_geometry","recreateGeometry","d","recreate","f","_material","u","materialParameters","_createLineGeometries","length","addGeometry","width","color","stippleOffColor","stipplePattern","isClosed","falloff","innerColor","innerWidth","stippleIntegerRepeats","polygonOffset","renderOccluded","writeDepth","setParameterValues","Float64Array","attributeData","position","removeDuplicateStartEnd","_","elevationAlignedTargetLocation","inputPoints","isValid","observer","observerSurfaceNormal","target","targetSurfaceNormal","observerAdjusted","targetAdjusted","computationResult","start","end","intersection","isTargetVisible","result","notifyChange","prototype","b","intersector","w","state","viewingMode","options","hud","store","get","v","camera","C","_getRayIntersection","sceneIntersectionHelper","intersectToolIntersectorRay","results","min","R","getIntersectionPoint","fromRenderCoords","normal","direction","I","sourceLayer","type","objectIdField","metadata","nodeIndex","componentIndex","uid","id","ray","point","tile","lij","slice","j","S","T","worldUpAtPosition","basemapTerrain","elevationBounds","getAltitude","Math","abs","max","y","_canUpdateFromIntersectionResult","intersectedGraphic","intersectedLocation","z","_tasks","N","_handles","_analysisHandles","resourceController","scheduler","registerTask","k","LINE_OF_SIGHT_TOOL","_connectObserver","_connectAnalyses","_connectTargets","_intersector","V","destroy","_analyses","removeAll","updating","priority","layerViewData","analyses","observerEngineLocation","computeScreenPixelSizeAt","_observerEngineLocation","analysis","_canComputeAnalysis","_computeAnalysisIntersection","_interpolateAnalysisIntersection","updateComputationResults","emit","_screenPixelSize","U","A","interpolationInfo","L","B","originalIntersection","originalObserver","originalTarget","F","x","D","O","elevationAlignedObserver","frustum","intersectsPoint","targets","_applyElevationAlignment","LINE_OF_SIGHT_TOOL_INTERACTIVE","hasZ","clone","H","elevationProvider","updateFromIntersectionResult","E","_adjustStartEndPositions","updateInputPoints","targetLocation","location","targetIntersection","_onTargetLocationChange","_onObserverChangeForAnalysis","observerIntersection","_onObserverEngineForAnalysis","isDirty","_isCameraDirty","on","G","extent","_onObserverChange","onElevationChange","getLineOfSightComputationDependencies","schedule","computeAnalysis","has","_connectAnalysisToTarget","_connectAnalysisToObserver","_connectAnalysisToObserverEngine","_connectAnalysisToCamera","_connectAnalysisToElevation","_connectAnalysisForCompute","added","_connectAnalysis","removed","_disconnectAnalysis","items","_addTarget","_onTargetCollectionChange","_removeTarget","some","find","_onAnalysesCollectionChange","_onTargetsChange","cursorTarget","_onCursorTargetChange","M","EventedMixin","Z","constructOnly","P","outerWidth","visibleInnerColor","visibleOuterColor","occludedInnerColor","occludedOuterColor","undefinedInnerColor","undefinedOuterColor","Number","arguments","configuration","_handle","layerView","suspended","fullOpacity","_configuration","_opacity","toUnitRGBA","visibleLineVisualElement","occludedLineVisualElement","undefinedLineVisualElement","createLineOfSightVisualization","getLineOfSightVisualizationDependencies","updateLineOfSightVisualization","updateVisualizationOpacity","destroyLineOfSightVisualization","moved","readOnly","_analysisController","_analysisView","handles","controller"],"mappings":"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","file":"static/js/107.7f536cdb.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{e as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as h}from\"../../../../chunks/vec3f64.js\";import{g as l,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=h(),s=h(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=h(),l=h(),a=h(),p=h();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,l[0]=r[0]-s[0]*o+i[0]*o,l[1]=r[1]-s[1]*o+i[1]*o,l[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([l[0],l[1],l[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){l(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&l(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!l(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import o from\"../../../../../core/Accessor.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as r}from\"../../../../../chunks/vec3f64.js\";let i=class extends o{constructor(t){super(t),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:r(),observerSurfaceNormal:null,target:r(),targetSurfaceNormal:null,observerAdjusted:r(),targetAdjusted:r()},this.computationResult={start:r(),end:r(),intersection:r(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange(\"computationResult\")}updateInputPoints(){this.notifyChange(\"inputPoints\")}onElevationChange(){this.notifyChange(\"elevationAlignedTargetLocation\")}};t([e()],i.prototype,\"target\",void 0),t([e()],i.prototype,\"elevationAlignedTargetLocation\",void 0),t([e()],i.prototype,\"inputPoints\",void 0),t([e()],i.prototype,\"computationResult\",void 0),t([e()],i.prototype,\"result\",void 0),i=t([s(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightAnalysis\")],i);export{i as LineOfSightAnalysis};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import{isNone as r,isSome as s}from\"../../../../../core/maybe.js\";import{screenPointObjectToArray as o}from\"../../../../../core/screenUtils.js\";import{property as i}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as n}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as a,d as c,a as p,n as m,b as l}from\"../../../../../chunks/vec3.js\";import{c as d}from\"../../../../../chunks/vec3f64.js\";import{create as u,copy as h,fromPoints as y}from\"../../../../../geometry/support/ray.js\";import{sv2d as f}from\"../../../../../geometry/support/vectorStacks.js\";import{getObjectId as g}from\"../../../../../layers/graphics/dehydratedFeatures.js\";import{fromScreen as v}from\"../../../support/geometryUtils/ray.js\";import{tilesAreRelated as j}from\"../../../terrain/tileUtils.js\";import{Intersector as w}from\"../../../webgl-engine/lib/Intersector.js\";import{toGraphic as I}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";let b=class extends t{constructor(e){super(e)}initialize(){this.intersector=new w(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=0}getScreenPointIntersection(e){const t=o(e,f.get()),r=v(this.view.state.camera,t,C);return this._getRayIntersection(r)}_getRayIntersection(e){if(r(e))return null;this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector);const t=this.intersector.results.min,o=R;if(!t||!t.getIntersectionPoint(o))return null;const i=this.view.renderCoordsHelper.fromRenderCoords(o,this.view.spatialReference),n=d();a(n,t.normal);const m=c(n,e.direction)>0?-1:1;p(n,n,m);const l=I(t,this.view);if(s(l)){const r=l.layer,s=l.sourceLayer;let o;if(s)switch(s.type){case\"scene\":o=g(l,s.objectIdField);break;case\"integrated-mesh\":{const e=t.target;o=`${e.metadata.nodeIndex}/${e.metadata.componentIndex}`;break}default:o=l.uid}else o=l.uid;return{type:\"Graphic\",id:`${r.uid}/${o}`,ray:h(e),normal:n,point:i}}if(\"TerrainRenderer\"===t.intersector){return{type:\"Terrain\",id:t.target.metadata.tile.lij.slice(),ray:h(e),normal:n,point:i}}return null}_canUpdateFromIntersectionResult(e,t){if(r(e)||!t||e.type!==t.type)return!1;switch(e.type){case\"Terrain\":{const r=e.id,s=t.id;return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]||j(r,s)}case\"Graphic\":case\"I3S\":return e.id===t.id}}updateFromIntersectionResult(e){let t;if(\"Terrain\"===e.type&&s(e.point)){const r=R,s=S,o=T;this.view.renderCoordsHelper.toRenderCoords(e.point,s),this.view.renderCoordsHelper.worldUpAtPosition(s,o);const i=this.view.basemapTerrain.elevationBounds,n=this.view.renderCoordsHelper.getAltitude(s),a=i?Math.abs(i.max-i.min)/Math.abs(n):100,c=n>0?1:-1;m(o,o),p(o,o,c*a),l(r,s,o),y(r,s,C),t=this._getRayIntersection(C)}else t=this._getRayIntersection(e.ray);return this._canUpdateFromIntersectionResult(t,e)?t.point:null}};e([i()],b.prototype,\"view\",void 0),e([i()],b.prototype,\"intersector\",void 0),b=e([n(\"esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightRayIntersector\")],b);const R=d(),S=d(),T=d(),C=u();export{b as LineOfSightRayIntersector};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends e{constructor(o){super(o),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null}};o([t()],s.prototype,\"target\",void 0),o([t()],s.prototype,\"intersectedGraphic\",void 0),o([t()],s.prototype,\"intersectedLocation\",void 0),o([t()],s.prototype,\"elevationAlignedTargetLocation\",void 0),o([t()],s.prototype,\"visible\",void 0),s=o([r(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightResult\")],s);export{s as LineOfSightResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../geometry.js\";import t from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Evented.js\";import r from\"../../../../../core/Handles.js\";import{handlesGroup as n,makeHandle as i}from\"../../../../../core/handleUtils.js\";import{isSome as o,isNone as a,unwrapOr as l,abortMaybe as c,removeMaybe as h,none as p}from\"../../../../../core/maybe.js\";import{createTask as g,ignoreAbortErrors as u}from\"../../../../../core/promiseUtils.js\";import{property as d}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as y}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as m,reaction as _}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{g as v,f,n as A,a as b,b as T,j as C,w as O}from\"../../../../../chunks/vec3.js\";import{a as E,c as w}from\"../../../../../chunks/vec3f64.js\";import{projectBoundingRect as j}from\"../../../../../geometry/projection.js\";import{containsPointObject as I,empty as S}from\"../../../../../geometry/support/aaBoundingRect.js\";import{fromPoints as L,create as P}from\"../../../../../geometry/support/ray.js\";import{LineOfSightAnalysis as R}from\"./LineOfSightAnalysis.js\";import{LineOfSightRayIntersector as V}from\"./LineOfSightRayIntersector.js\";import{LineOfSightResult as D}from\"./LineOfSightResult.js\";import{getElevationAtPoint as H}from\"../../../support/ElevationProvider.js\";import{toGraphic as x}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";import{ImmediateTask as N,TaskPriority as k}from\"../../../../support/Scheduler.js\";import F from\"../../../../../geometry/Point.js\";let z=class extends(s.EventedMixin(t)){constructor(e){super(e),this._tasks=N,this._handles=new r,this._analysisHandles=new r}initialize(){var e;const t=null==(e=this.view.resourceController)?void 0:e.scheduler;t&&(this._tasks=t.registerTask(k.LINE_OF_SIGHT_TOOL));this._handles.add([this._connectObserver(),this._connectAnalyses(),this._connectTargets()]),this._intersector=new V({view:this.view})}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll()}get updating(){return this._tasks.updating}get priority(){return this._tasks.priority}set priority(e){this._tasks.priority=e}get _analyses(){return this.layerViewData.analyses}get _observerEngineLocation(){return this.layerViewData.observerEngineLocation}set _observerEngineLocation(e){this.layerViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e){const{analysis:t}=e,{inputPoints:s,computationResult:r}=t,{observerAdjusted:n,targetAdjusted:i}=s,{start:o,end:a}=r;v(o,n),v(a,i);this._canComputeAnalysis(t)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),t.updateComputationResults(),this.emit(\"result-changed\",{target:e.analysis.target,result:t.result})}_adjustStartEndPositions(e){const t=this._screenPixelSize,s=this.view,{inputPoints:r}=e,{observer:n,observerSurfaceNormal:i,target:a,targetSurfaceNormal:l,observerAdjusted:c,targetAdjusted:h}=r,p=U;o(i)?v(p,i):f(p,a,n);const g=t;A(p,p),b(p,p,Math.min(g,1)),T(c,n,p),o(l)?v(p,l):f(p,n,a);const u=s.state.camera.computeScreenPixelSizeAt(a);A(p,p),b(p,p,Math.min(u,1)),T(h,a,p)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:s}=this,{sceneIntersectionHelper:r,renderCoordsHelper:n}=s;if(a(r))return;const i=this._intersector.intersector,{computationResult:l,inputPoints:c}=e,{observer:h,target:p}=c,{start:g,end:u}=l,d=L(g,u,B);r.intersectToolIntersectorRay(d,i);const y=l.intersection,m=U,_=!!i.results.min&&i.results.min.getIntersectionPoint(y);let f=!0;if(_){v(t.originalIntersection,y),v(t.originalObserver,g),v(t.originalTarget,u),n.fromRenderCoords(y,m,s.spatialReference);const e=1-C(u,p)/C(g,p);f=C(h,y)>=e*C(h,p)}const A=new F(m,s.spatialReference);{const{result:t,target:r}=e;o(t)?(t.target=r,t.intersectedGraphic=f?null:x(i.results.min,s),t.intersectedLocation=f?null:A,t.visible=!!_&&f):e.result=new D({target:r,elevationAlignedTargetLocation:e.elevationAlignedTargetLocation,intersectedGraphic:f?null:x(i.results.min,s),intersectedLocation:f?null:A,visible:!!_&&f})}l.isValid=c.isValid=!0,l.isTargetVisible=f}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:s,inputPoints:r}=e,{start:n,end:i,intersection:o}=s,{originalIntersection:a,originalObserver:l,originalTarget:c}=t;if(v(o,a),r.isValid){const e=U,t=C(l,a)/C(l,c);O(e,n,l),b(e,e,1-t),T(o,o,e),O(e,i,c),b(e,e,t),T(o,o,e),s.isValid=!0}else e.result=new D,s.isValid=!1,s.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.layerViewData.elevationAlignedObserver,s=this.view.frustum;if(a(t)||a(e.target)||a(s))return!1;const{observerAdjusted:r,targetAdjusted:n}=e.inputPoints,i=s.intersectsPoint(r),o=s.intersectsPoint(n);return i&&o}_onObserverChange(e){if(a(e))return this.layer.targets.removeAll(),void(this.layerViewData.elevationAlignedObserver=null);this.layerViewData.elevationAlignedObserver=this._applyElevationAlignment(e,this.layer.intersection);const t=w();this.view.renderCoordsHelper.toRenderCoords(this.layerViewData.elevationAlignedObserver,t),this._observerEngineLocation=t,this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_applyElevationAlignment(e,t){if(e.hasZ&&(a(t)||\"Graphic\"===t.type))return e;const s=e.clone();return s.z=l(H(this.view.elevationProvider,s),0),s}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t,s){const{inputPoints:r}=e;if(v(r.observer,t),o(s)){const e=this._intersector.updateFromIntersectionResult(s);o(e)&&this.view.renderCoordsHelper.toRenderCoords(e,r.observer),r.observerSurfaceNormal=E(s.normal)}else r.observerSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t,s){const{inputPoints:r}=e;if(r.isValid=!1,o(t)){if(e.elevationAlignedTargetLocation=this._applyElevationAlignment(t,s),this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,r.target),o(s)){const e=this._intersector.updateFromIntersectionResult(s);o(e)&&this.view.renderCoordsHelper.toRenderCoords(e,r.target),r.targetSurfaceNormal=E(s.normal)}else r.targetSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints()}this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return m((()=>({analysis:e,targetLocation:e.target.location,targetIntersection:e.target.intersection})),(({analysis:e,targetLocation:t,targetIntersection:s})=>{o(t)&&this._onTargetLocationChange(e,t,s)}))}_connectAnalysisToObserver(e){return m((()=>({analysis:e,observer:this.layerViewData.elevationAlignedObserver})),(({analysis:e})=>{this._onObserverChangeForAnalysis(e)}))}_connectAnalysisToObserverEngine(e){return m((()=>({analysis:e,observer:this._observerEngineLocation,observerIntersection:this.layer.intersection})),(({analysis:e,observer:t,observerIntersection:s})=>{this._onObserverEngineForAnalysis(e,t,s)}))}_connectAnalysisToCamera(e){return _((()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty})),(({isDirty:t})=>{e.inputPoints.isValid&&!t||e.updateInputPoints()}))}_connectAnalysisToElevation(e){return this.view.elevationProvider.on(\"elevation-change\",(t=>{if(!this._canComputeAnalysis(e))return;const s=this.layer.observer;G(t.extent,t.spatialReference,s)&&this._onObserverChange(s);const r=e.target;o(r)&&G(t.extent,t.spatialReference,r.location)&&e.onElevationChange()}))}_connectAnalysisForCompute(e){let t=p;const s={analysis:e,interpolationInfo:{originalIntersection:w(),originalObserver:w(),originalTarget:w()}};return n([m((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=c(t),t=g((async e=>{await u(this._tasks.schedule((()=>this.computeAnalysis(s)),e))}))})),i((()=>t=c(t)))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisToCamera(e),this._connectAnalysisToElevation(e),this._connectAnalysisForCompute(e)])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}_onTargetsChange(e){return this._analyses.removeAll(),e.items.length>0&&e.forEach((e=>this._addTarget(e))),e.on(\"change\",(e=>this._onTargetCollectionChange(e)))}_onTargetCollectionChange(e){e.added.forEach((e=>this._addTarget(e))),e.removed.forEach((e=>this._removeTarget(e)))}_onCursorTargetChange(e,t){o(t)&&this._removeTarget(t),o(e)&&this._addTarget(e)}_addTarget(e){const t=this._analyses;t.some((t=>t.target===e))||t.add(new R({target:e}))}_removeTarget(e){const t=this._analyses,s=t.find((t=>t.target===e));t.remove(s)}_connectObserver(){return n([m((()=>this.layer.observer),(e=>this._onObserverChange(e)))])}_connectAnalyses(){let e=null;return n([m((()=>this._analyses),(t=>{e=h(e),e=t.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),t.forEach((e=>this._connectAnalysis(e)))})),i((()=>e=h(e)))])}_connectTargets(){let e=null;return n([m((()=>this.layer.targets),(t=>{e=h(e),e=this._onTargetsChange(t)})),m((()=>this.layerViewData.cursorTarget),((e,t)=>{this._onCursorTargetChange(e,t)})),i((()=>{e=h(e)}))])}get _isCameraDirty(){const e=this.layerViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:s}=t;if(a(e)||a(s))return!1;const r=U;s.toRenderCoords(e,r);const n=t.state.camera.computeScreenPixelSizeAt(r);return Math.abs((n-this._screenPixelSize)/this._screenPixelSize)>M}};function G(e,t,s){return!a(s)&&(j(e,t,Z,s.spatialReference),I(Z,s))}e([d({constructOnly:!0})],z.prototype,\"layer\",void 0),e([d({constructOnly:!0})],z.prototype,\"layerViewData\",void 0),e([d({constructOnly:!0})],z.prototype,\"view\",void 0),e([d()],z.prototype,\"updating\",null),e([d()],z.prototype,\"priority\",null),e([d()],z.prototype,\"_analyses\",null),e([d()],z.prototype,\"_observerEngineLocation\",null),e([d()],z.prototype,\"_screenPixelSize\",null),e([d()],z.prototype,\"_tasks\",void 0),e([d()],z.prototype,\"_isCameraDirty\",null),z=e([y(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightController\")],z);const M=.1,U=w(),B=P(),Z=S();export{z as LineOfSightController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../Color.js\";import r from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new e([3,252,111,1]),this.visibleOuterColor=new e([3,252,111,.15]),this.occludedInnerColor=new e([252,3,69,1]),this.occludedOuterColor=new e([252,3,69,.1]),this.undefinedInnerColor=new e([255,255,255,1]),this.undefinedOuterColor=new e([127,127,127,.2])}};o([t({type:Number})],s.prototype,\"innerWidth\",void 0),o([t({type:Number})],s.prototype,\"outerWidth\",void 0),o([t({type:e})],s.prototype,\"visibleInnerColor\",void 0),o([t({type:e})],s.prototype,\"visibleOuterColor\",void 0),o([t({type:e})],s.prototype,\"occludedInnerColor\",void 0),o([t({type:e})],s.prototype,\"occludedOuterColor\",void 0),o([t({type:e})],s.prototype,\"undefinedInnerColor\",void 0),o([t({type:e})],s.prototype,\"undefinedOuterColor\",void 0),s=o([i(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightConfiguration\")],s);export{s as LineOfSightConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import e from\"../../../../../core/Collection.js\";import{property as s}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as i}from\"../../../../../chunks/vec3f64.js\";import{LineOfSightConfiguration as c}from\"./LineOfSightConfiguration.js\";let n=class extends r{constructor(){super(...arguments),this.analyses=new e,this.elevationAlignedObserver=null,this.configuration=new c,this.observerEngineLocation=i(),this.cursorTarget=null}};o([s()],n.prototype,\"analyses\",void 0),o([s()],n.prototype,\"elevationAlignedObserver\",void 0),o([s({type:c})],n.prototype,\"configuration\",void 0),o([s()],n.prototype,\"observerEngineLocation\",void 0),o([s()],n.prototype,\"cursorTarget\",void 0),n=o([t(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightLayerViewData\")],n);export{n as LineOfSightLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../Color.js\";import t from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Handles.js\";import{makeHandle as n,handlesGroup as s}from\"../../../../../core/handleUtils.js\";import{applyOpacity as l}from\"../../../../../core/mathUtils.js\";import{removeMaybe as r,destroyMaybe as a}from\"../../../../../core/maybe.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as u}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as d,reaction as m}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{c as h}from\"../../../../../chunks/mat4f64.js\";import{f as p}from\"../../../../../chunks/vec3.js\";import{d as y,c as f}from\"../../../../../chunks/vec3f64.js\";import{LineVisualElement as v}from\"../../../interactive/visualElements/LineVisualElement.js\";let V=class extends t{constructor(e){super(e),this._handle=null,this._analysisHandles=new o}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=r(this._handle),this._analysisHandles=a(this._analysisHandles)}get visible(){return this.layerView.visible&&!this.layerView.suspended}get _analyses(){return this.layerView.layerViewData.analyses}get _configuration(){return this.layerView.layerViewData.configuration}get _opacity(){return this.layerView.fullOpacity}createLineOfSightVisualization(){const e=this._configuration,t=this._opacity,o={view:this.view,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth},n=i.toUnitRGBA(e.visibleOuterColor);l(n,n,t);const s=i.toUnitRGBA(e.visibleInnerColor);l(s,s,t);const r=i.toUnitRGBA(e.occludedOuterColor);l(r,r,t);const a=i.toUnitRGBA(e.occludedInnerColor);l(a,a,t);const c=i.toUnitRGBA(e.undefinedOuterColor);l(c,c,t);const u=i.toUnitRGBA(e.undefinedInnerColor);l(u,u,t);return{visibleLineVisualElement:new v({...o,color:n,innerColor:s}),occludedLineVisualElement:new v({...o,color:r,innerColor:a}),undefinedLineVisualElement:new v({...o,color:c,innerColor:u})}}destroyLineOfSightVisualization(e){e.visibleLineVisualElement=a(e.visibleLineVisualElement),e.occludedLineVisualElement=a(e.occludedLineVisualElement),e.undefinedLineVisualElement=a(e.undefinedLineVisualElement)}updateLineOfSightVisualization(e,t){const o=this.visible,n=this._configuration,{computationResult:s,inputPoints:r}=e,{start:a,end:c,intersection:u,isValid:d,isTargetVisible:m}=s,{observer:h}=r,f=C;f[12]=h[0],f[13]=h[1],f[14]=h[2];const v=p(g,a,h),V=p(_,c,h),L=p(b,u,h),{visibleLineVisualElement:O,occludedLineVisualElement:A,undefinedLineVisualElement:E}=t;if(!o)return O.visible=!1,A.visible=!1,void(E.visible=!1);if(O.visible=!0,A.visible=!0,E.visible=!0,O.geometry=null,A.geometry=null,E.geometry=null,d)if(m){O.geometry=[[y(v),y(V)]],O.transform=f;const e=i.toUnitRGBA(n.visibleOuterColor);O.color=l(e,e,this._opacity)}else{O.geometry=[[y(v),y(L)]],O.transform=f;const e=i.toUnitRGBA(n.occludedOuterColor);O.color=l(e,e,this._opacity),A.geometry=[[y(L),y(V)]],A.transform=f}else E.geometry=[[y(v),y(V)]],E.transform=f}updateVisualizationOpacity(e,t){const o=this._configuration,n=this._opacity,s=i.toUnitRGBA(o.visibleOuterColor);l(s,s,n);const r=i.toUnitRGBA(o.visibleInnerColor);l(r,r,n);const a=i.toUnitRGBA(o.occludedOuterColor);l(a,a,n);const c=i.toUnitRGBA(o.occludedInnerColor);l(c,c,n);const u=i.toUnitRGBA(o.undefinedOuterColor);l(u,u,n);const d=i.toUnitRGBA(o.undefinedInnerColor);l(d,d,n),t.visibleLineVisualElement.color=e.computationResult.isTargetVisible?s:a,t.visibleLineVisualElement.innerColor=r,t.occludedLineVisualElement.color=a,t.occludedLineVisualElement.innerColor=c,t.undefinedLineVisualElement.color=u,t.undefinedLineVisualElement.innerColor=d}getLineOfSightVisualizationDependencies(e){const{computationResult:i}=e,{occludedOuterColor:t,visibleOuterColor:o}=this._configuration;return{computationResult:i,occludedOuterColor:t,visibleOuterColor:o,visible:this.visible}}_connectAnalysis(e){const i=this._analysisHandles;if(i.has(e))return;const t=this.createLineOfSightVisualization();i.add([d((()=>this.getLineOfSightVisualizationDependencies(e)),(()=>this.updateLineOfSightVisualization(e,t))),m((()=>this._opacity),(()=>this.updateVisualizationOpacity(e,t))),n((()=>this.destroyLineOfSightVisualization(t)))],e)}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_connectAnalyses(){let e=null;return s([d((()=>this._analyses),(i=>{e=r(e),e=i.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),this._onAnalysesCollectionChange({target:i,added:i.items,removed:[],moved:[]})})),n((()=>e=r(e)))])}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}};e([c({constructOnly:!0})],V.prototype,\"layer\",void 0),e([c({constructOnly:!0})],V.prototype,\"layerView\",void 0),e([c({constructOnly:!0})],V.prototype,\"view\",void 0),e([c({readOnly:!0})],V.prototype,\"visible\",null),e([c()],V.prototype,\"_analyses\",null),e([c()],V.prototype,\"_configuration\",null),e([c()],V.prototype,\"_opacity\",null),V=e([u(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightView\")],V);const g=f(),_=f(),b=f(),C=h();export{V as LineOfSightView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import{destroyMaybe as e,applySome as t,unwrapOr as s,mapOr as i}from\"../../../core/maybe.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{LineOfSightController as n}from\"./analysis/LineOfSight/LineOfSightController.js\";import{LineOfSightLayerViewData as y}from\"./analysis/LineOfSight/LineOfSightLayerViewData.js\";import{LineOfSightView as p}from\"./analysis/LineOfSight/LineOfSightView.js\";import h from\"../../layers/LayerView.js\";let u=class extends(l(h)){constructor(){super(...arguments),this.type=\"line-of-sight-3d\",this.layerViewData=new y}initialize(){const r=this.view,e=this.layer;this._analysisController=new n({layer:e,layerViewData:this.layerViewData,view:r}),this._analysisView=new p({layer:e,layerView:this,view:r}),this.handles.add([this._analysisController.on(\"result-changed\",(r=>{r.target!==this.layerViewData.cursorTarget&&this.emit(\"result-changed\",r)}))])}destroy(){this._analysisController=e(this._analysisController),this._analysisView=e(this._analysisView)}get results(){return this.layerViewData.analyses.map((r=>r.result))}get priority(){return this._analysisController.priority}set priority(r){this._analysisController.priority=r}getResultForTarget(r){const e=this.layerViewData.analyses.find((e=>e.target===r)),i=t(e,(r=>r.result));return s(i,null)}isUpdating(){return i(this._analysisController,!1,(r=>r.updating))}get testData(){return{view:this._analysisView,controller:this._analysisController}}};r([a({readOnly:!0})],u.prototype,\"type\",void 0),r([a()],u.prototype,\"layer\",void 0),r([a({readOnly:!0})],u.prototype,\"results\",null),r([a()],u.prototype,\"priority\",null),r([a()],u.prototype,\"layerViewData\",void 0),r([a()],u.prototype,\"_analysisController\",void 0),r([a()],u.prototype,\"_analysisView\",void 0),u=r([o(\"esri.views.3d.layers.LineOfSightLayerView3D\")],u);var w=u;export{u as LineOfSightLayerView3D,w as default};\n"],"sourceRoot":""}