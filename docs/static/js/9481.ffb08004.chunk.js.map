{"version":3,"file":"static/js/9481.ffb08004.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/ImageryTileLayerView3D.js","../node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{unwrap as t,isNone as i}from\"../../../core/maybe.js\";import{whenTrueOnce as s}from\"../../../core/watchUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as o}from\"./LayerView3D.js\";import{TiledLayerView3D as n}from\"./TiledLayerView3D.js\";import{RasterTile as m}from\"../terrain/RasterTile.js\";import{ImageryTileLayerView as p}from\"../../layers/ImageryTileLayerView.js\";import h from\"../../layers/LayerView.js\";import{RefreshableLayerView as c}from\"../../layers/RefreshableLayerView.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";import{getWebGLCapabilities as d}from\"../../webgl/capabilities.js\";import{ContextType as g}from\"../../webgl/context-util.js\";let f=class extends(p(c(n(o(h))))){constructor(){super(...arguments),this.type=\"imagery-tile-3d\",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new r(\"layerview:spatial-reference-incompatible\",\"The layer extent cannot be projected to the view's spatial reference\",{layer:this.layer})));const e=s(this.view,\"basemapTerrain.tilingSchemeLocked\").then((()=>{const e=this.view.basemapTerrain.tilingScheme,{tileInfo:r}=this.layer,t=[\"png\",\"png24\",\"png32\",\"jpg\",\"mixed\"].indexOf(r.format)>-1&&e.compatibleWith(r);this.isAlignedMapTile=t;const i=t?r:e.toTileInfo();this.tileInfo=i,this.updatingHandles.add((()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition]),(()=>this.refresh()))}));this.addResolvingPromise(e)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const e=document.createElement(\"canvas\"),r=e.getContext(\"2d\"),[t,i]=this.tileInfo.size;return e.width=t,e.height=i,r.clearRect(0,0,t,i),r.getImageData(0,0,t,i)}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){const e=this.tileInfo.lods,r=this.layer.tileInfo.lods,t=e[0].scale,i=r[r.length-1].scale;return this.levelRangeFromScaleRange(t,i)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}async fetchTile(e,r,s,a){const l=this.tileInfo,o=this._canSymbolizeInWebGL(),n={tileInfo:l,requestRawData:o,signal:t(a.signal),requestAsImageElement:this.isAlignedMapTile},p=await this.layer.fetchTile(e,r,s,n);if(p instanceof HTMLImageElement)return p;let h=p&&p.pixelBlock;if(i(h))return this._blankTile;if(!o&&(h=await this.layer.applyRenderer(p),i(h)))return this._blankTile;const c=new m([e,r,s],h,l.size[0],l.size[1]);return o?(c.symbolizerRenderer=this.layer.symbolizer.rendererJSON,c.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e)),c.transformGrid=p.transformGrid):c.isRendereredSource=!0,c.interpolation=this.layer.interpolation,c.bandIds=this.layer.bandIds,c}_getSymbolizerOptions(e){const r=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:r,y:r},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}createFetchPopupFeaturesQueryGeometry(e,r){return y(e,r,this.view)}refresh(){this.emit(\"data-changed\")}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_canSymbolizeInWebGL(){const e=d(this.view._stage.renderView.renderingContext.type);return(e.type===g.WEBGL2||e.supportsTextureFloat)&&this.layer.symbolizer.canRenderInWebGL}};e([a({readOnly:!0})],f.prototype,\"_blankTile\",null),e([a({readOnly:!0})],f.prototype,\"imageFormatIsOpaque\",null),e([a({readOnly:!0})],f.prototype,\"hasMixedImageFormats\",null),e([a({readOnly:!0})],f.prototype,\"dataLevelRange\",null),f=e([l(\"esri.views.3d.layers.ImageryTileLayerView3D\")],f);const u=f;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{unwrap as i,isSome as o}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as n}from\"../../layers/support/commonProperties.js\";import{getDefaultDatumTransformationForDataset as l,projectExtent as u}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as p}from\"./support/popupUtils.js\";const m=m=>{let f=class extends m{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return l(i(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(t){return!!this.projectFullExtent(t)}projectFullExtent(t){const e=i(this.layer.fullExtent),r=l(e,t,!1);return u(e,t,r)}async fetchPopupFeatures(t,i){const{layer:s}=this;if(!t)return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const{popupEnabled:a}=s,n=p(s,i);if(!a||!o(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const l=[],{value:u,magdirValue:m}=await s.identify(t,{timeExtent:this.timeExtent});let f=\"\";if(u&&u.length){var c,d;f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((t=>s.getStandardTimeValue(t))).join(\", \"):u.join(\", \");const t={ObjectId:0},r=\"Raster.ServicePixelValue\";t[r]=this._formatAttributeValue(f,r);const i=null==(c=s.rasterInfo)||null==(d=c.attributeTable)?void 0:d.features;if(i&&i.length>0){const e=i.filter((t=>{const e=t.attributes.value||t.attributes.Value||t.attributes.VALUE;return String(e)===f}));if(e.length>0){const r=e[0];if(r)for(const e in r.attributes)if(r.attributes.hasOwnProperty(e)){const i=this._rasterFieldPrefix+e;t[i]=this._formatAttributeValue(r.attributes[e],i)}}}const o=s.rasterInfo.dataType;\"vector-magdir\"!==o&&\"vector-uv\"!==o||(t[\"Raster.Magnitude\"]=null==m?void 0:m[0],t[\"Raster.Direction\"]=null==m?void 0:m[1]);const a=new e(this.fullExtent.clone(),null,t);a.layer=s,a.sourceLayer=a.layer,l.push(a)}return l}_formatAttributeValue(t,e){if(\"string\"==typeof t){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,e),o=i&&i.format;if(o){let e,r;return t.trim().indexOf(\",\")>-1?(e=\",\",r=e+\" \",this._formatDelimitedString(t,e,r,o)):t.trim().indexOf(\" \")>-1?(e=r=\" \",this._formatDelimitedString(t,e,r,o)):this._formatNumberFromString(t,o)}}return t}_getFieldInfo(t,e){if(!t||!t.length||!e)return;const r=e.toLowerCase();let i;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==r&&t.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=t,!0))),i}_formatDelimitedString(t,e,r,i){return t&&e&&r&&i?t.trim().split(e).map((t=>this._formatNumberFromString(t,i))).join(r):t}_formatNumberFromString(t,e){if(!t||!e)return t;const r=Number(t);return isNaN(r)?t:e.format(r)}};return t([s()],f.prototype,\"layer\",void 0),t([s(n)],f.prototype,\"timeExtent\",void 0),t([s()],f.prototype,\"view\",void 0),t([s()],f.prototype,\"fullExtent\",null),t([s()],f.prototype,\"tileInfo\",void 0),t([s({readOnly:!0})],f.prototype,\"hasTilingEffects\",null),f=t([a(\"esri.views.layers.ImageryTileLayerView\")],f),f};export{m as ImageryTileLayerView,m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"names":["f","p","c","n","o","h","constructor","super","arguments","this","type","isAlignedMapTile","initialize","layer","increaseRasterJobHandlerUsage","fullExtent","addResolvingPromise","Promise","reject","r","e","s","view","then","basemapTerrain","tilingScheme","tileInfo","t","indexOf","format","compatibleWith","i","toTileInfo","updatingHandles","add","renderer","interpolation","bandIds","multidimensionalDefinition","refresh","destroy","decreaseRasterJobHandlerUsage","_blankTile","document","createElement","getContext","size","width","height","clearRect","getImageData","imageFormatIsOpaque","hasMixedImageFormats","dataLevelRange","lods","scale","length","levelRangeFromScaleRange","_getfullExtent","projectFullExtent","spatialReference","a","l","_canSymbolizeInWebGL","requestRawData","signal","requestAsImageElement","fetchTile","HTMLImageElement","pixelBlock","applyRenderer","m","symbolizerRenderer","symbolizer","rendererJSON","symbolizerParameters","generateWebGLParameters","_getSymbolizerOptions","transformGrid","isRendereredSource","lodAt","resolution","isGCS","isGeographic","x","y","ensureSymbolizerParameters","JSON","stringify","lij","createFetchPopupFeaturesQueryGeometry","emit","suspended","d","_stage","renderView","renderingContext","g","supportsTextureFloat","canRenderInWebGL","readOnly","prototype","u","_rasterFieldPrefix","hasTilingEffects","dynamicRangeAdjustment","datumTransformation","supportsSpatialReference","popupEnabled","popupTemplate","value","magdirValue","identify","timeExtent","hasStandardTime","map","getStandardTimeValue","join","ObjectId","_formatAttributeValue","rasterInfo","attributeTable","features","filter","attributes","Value","VALUE","String","hasOwnProperty","dataType","clone","sourceLayer","push","fieldInfos","_getFieldInfo","trim","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","handles","doRefresh","dataChanged","catch","declaredClass","error","async","getRequiredFields","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","has","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","xmin","Math","min","ymin","xmax","max","ymax"],"sourceRoot":""}