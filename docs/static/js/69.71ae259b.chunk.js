(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[69],{1005:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return f}));var a=r(3),i=r(6),n=r(7),o=r(0),s=r(25),c=r(1),l=(r(17),r(18),r(16),r(58)),u=r(9),d=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).nodesPerPage=null,e.rootIndex=0,e.lodSelectionMetricType=null,e}return r}(s.a);Object(o.a)([Object(c.b)({type:Number})],d.prototype,"nodesPerPage",void 0),Object(o.a)([Object(c.b)({type:Number})],d.prototype,"rootIndex",void 0),Object(o.a)([Object(c.b)({type:String})],d.prototype,"lodSelectionMetricType",void 0),d=Object(o.a)([Object(u.a)("esri.layer.support.I3SNodePageDefinition")],d);var p=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).factor=1,e}return r}(s.a);Object(o.a)([Object(c.b)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],p.prototype,"id",void 0),Object(o.a)([Object(c.b)({type:Number})],p.prototype,"factor",void 0),p=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialTexture")],p);var b=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).baseColorFactor=[1,1,1,1],e.baseColorTexture=null,e.metallicRoughnessTexture=null,e.metallicFactor=1,e.roughnessFactor=1,e}return r}(s.a);Object(o.a)([Object(c.b)({type:[Number]})],b.prototype,"baseColorFactor",void 0),Object(o.a)([Object(c.b)({type:p})],b.prototype,"baseColorTexture",void 0),Object(o.a)([Object(c.b)({type:p})],b.prototype,"metallicRoughnessTexture",void 0),Object(o.a)([Object(c.b)({type:Number})],b.prototype,"metallicFactor",void 0),Object(o.a)([Object(c.b)({type:Number})],b.prototype,"roughnessFactor",void 0),b=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],b);var h=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).alphaMode="opaque",e.alphaCutoff=.25,e.doubleSided=!1,e.cullFace="none",e.normalTexture=null,e.occlusionTexture=null,e.emissiveTexture=null,e.emissiveFactor=null,e.pbrMetallicRoughness=null,e}return r}(s.a);Object(o.a)([Object(l.a)({opaque:"opaque",mask:"mask",blend:"blend"})],h.prototype,"alphaMode",void 0),Object(o.a)([Object(c.b)({type:Number})],h.prototype,"alphaCutoff",void 0),Object(o.a)([Object(c.b)({type:Boolean})],h.prototype,"doubleSided",void 0),Object(o.a)([Object(l.a)({none:"none",back:"back",front:"front"})],h.prototype,"cullFace",void 0),Object(o.a)([Object(c.b)({type:p})],h.prototype,"normalTexture",void 0),Object(o.a)([Object(c.b)({type:p})],h.prototype,"occlusionTexture",void 0),Object(o.a)([Object(c.b)({type:p})],h.prototype,"emissiveTexture",void 0),Object(o.a)([Object(c.b)({type:[Number]})],h.prototype,"emissiveFactor",void 0),Object(o.a)([Object(c.b)({type:b})],h.prototype,"pbrMetallicRoughness",void 0),h=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialDefinition")],h);var y=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(s.a);Object(o.a)([Object(c.b)({type:String,json:{read:{source:["name","index"],reader:function(e,t){return null!=e?e:"".concat(t.index)}}}})],y.prototype,"name",void 0),Object(o.a)([Object(l.a)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],y.prototype,"format",void 0),y=Object(o.a)([Object(u.a)("esri.layer.support.I3STextureFormat")],y);var f=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).atlas=!1,e}return r}(s.a);Object(o.a)([Object(c.b)({type:[y]})],f.prototype,"formats",void 0),Object(o.a)([Object(c.b)({type:Boolean})],f.prototype,"atlas",void 0),f=Object(o.a)([Object(u.a)("esri.layer.support.I3STextureSetDefinition")],f);var O=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(s.a);Object(o.a)([Object(l.a)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],O.prototype,"type",void 0),Object(o.a)([Object(c.b)({type:Number})],O.prototype,"component",void 0),O=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryAttribute")],O);var v=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(s.a);Object(o.a)([Object(l.a)({draco:"draco"})],v.prototype,"encoding",void 0),Object(o.a)([Object(c.b)({type:[String]})],v.prototype,"attributes",void 0),v=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryCompressedAttributes")],v);var j=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).offset=0,e}return r}(s.a);Object(o.a)([Object(c.b)({type:Number})],j.prototype,"offset",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"position",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"normal",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"uv0",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"color",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"uvRegion",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"featureId",void 0),Object(o.a)([Object(c.b)({type:O})],j.prototype,"faceRange",void 0),Object(o.a)([Object(c.b)({type:v})],j.prototype,"compressedAttributes",void 0),j=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryBuffer")],j);var g=function(e){Object(i.a)(r,e);var t=Object(n.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(s.a);Object(o.a)([Object(l.a)({triangle:"triangle"})],g.prototype,"topology",void 0),Object(o.a)([Object(c.b)()],g.prototype,"geometryBuffers",void 0),g=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryDefinition")],g)},1006:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var a=r(3),i=r(4),n=r(6),o=r(7),s=r(2),c=r(29),l=r(36),u=r(1037),d=r(189),p=r(335),b=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e.view))._resources=null,i._transform=Object(l.d)(),i}return Object(i.a)(r,[{key:"object",get:function(){return Object(s.k)(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){Object(c.e)(this._transform,e),Object(s.k)(this._resources)&&(this._resources.object.transformation=this._transform)}},{key:"recreate",value:function(){this.attached&&this.createResources()}},{key:"recreateGeometry",value:function(){if(!Object(s.j)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries)}}},{key:"createResources",value:function(){this.destroyResources();var e=this.view._stage;if(e){var t=new p.a({isPickable:!1,updatePolicy:1});e.add(t);var r=new d.a({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((function(t){return e.add(t)})),e.add(r),t.add(r),this.visible||r.setVisible(!1),this._resources={layer:t,object:r}}}},{key:"destroyResources",value:function(){var e=this.view._stage;!Object(s.j)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((function(t){e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}},{key:"updateVisibility",value:function(e){Object(s.j)(this._resources)||this._resources.object.setVisible(e)}}]),r}(u.a)},1020:function(e,t,r){"use strict";r.d(t,"a",(function(){return G}));var a=r(8),i=r.n(a),n=r(15),o=r(12),s=r(3),c=r(4),l=r(6),u=r(7),d=r(0),p=r(269),b=(r(541),r(654),r(656),r(655),r(216),r(497),r(496),r(374),r(501)),h=r(69),y=r(20),f=r(57),O=r(148),v=r(16),j=r(2),g=r(202),m=r(1),w=(r(17),r(18),r(58)),_=r(48),k=r(9),x=r(61),C=r(52),P=r(360),S=r(1021),E=r(1022),V=r(200),T=r(707),F=r(689),D=r(1035),I=r(1005),R=r(163),L=r(701),M=r(719),q=v.a.getLogger("esri.layers.buildingSublayers.BuildingComponentSublayer"),z=Object(T.a)(),U=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(s.a)(this,r),(a=t.call(this,e)).type="building-component",a.nodePages=null,a.materialDefinitions=null,a.textureSetDefinitions=null,a.geometryDefinitions=null,a.serviceUpdateTimeStamp=null,a.fields=null,a.associatedLayer=null,a.outFields=null,a.listMode="show",a.renderer=null,a.definitionExpression=null,a.popupEnabled=!0,a.popupTemplate=null,a.layerType="3d-object",a}return Object(c.a)(r,[{key:"parsedUrl",get:function(){return this.layer?{path:"".concat(this.layer.parsedUrl.path,"/sublayers/").concat(this.id),query:this.layer.parsedUrl.query}:null}},{key:"fieldsIndex",get:function(){return new F.a(this.fields)}},{key:"readAssociatedLayer",value:function(e,t){var r=this.layer.associatedFeatureServiceItem,a=t.associatedLayerID;return Object(j.k)(r)&&"number"==typeof a?new P.default({portalItem:r,layerId:a}):null}},{key:"objectIdField",get:function(){if(null!=this.fields){var e,t=Object(o.a)(this.fields);try{for(t.s();!(e=t.n()).done;){var r=e.value;if("oid"===r.type)return r.name}}catch(a){t.e(a)}finally{t.f()}}return null}},{key:"displayField",get:function(){return Object(j.k)(this.associatedLayer)?this.associatedLayer.displayField:null}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"load",value:function(e){var t=this,r=Object(j.k)(e)?e.signal:null,a=this._fetchService(r).then((function(){t.indexInfo=Object(D.a)(t.parsedUrl.path,t.rootNode,t.nodePages,t.apiKey,q,r)}));return this.addResolvingPromise(a),Promise.resolve(this)}},{key:"createPopupTemplate",value:function(e){return Object(L.a)(this,e)}},{key:"_fetchService",value:function(){var e=Object(n.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.default)(this.parsedUrl.path,{query:{f:"json",token:this.apiKey},responseType:"json",signal:t});case 2:r=e.sent.data,this.read(r,{origin:"service",url:this.parsedUrl});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFieldDomain",value:function(e,t){var r,a,i,n,o=null==(r=this.getFeatureType(null==t?void 0:t.feature))||null==(a=r.domains)?void 0:a[e];return o&&"inherited"!==o.type?o:null!=(i=null==(n=this.getField(e))?void 0:n.domain)?i:null}},{key:"getFeatureType",value:function(e){return e&&Object(j.k)(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}},{key:"types",get:function(){return Object(j.k)(this.associatedLayer)?this.associatedLayer.types:[]}},{key:"typeIdField",get:function(){return Object(j.k)(this.associatedLayer)?this.associatedLayer.typeIdField:null}},{key:"geometryType",get:function(){return"3d-object"===this.layerType?"mesh":"point"}},{key:"profile",get:function(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}},{key:"capabilities",get:function(){var e=Object(j.k)(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:E.a,t=e.query,r=e.data;return{query:t,data:{supportsZ:r.supportsZ,supportsM:r.supportsM,isVersioned:r.isVersioned}}}},{key:"createQuery",value:function(){var e=new R.a;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}},{key:"queryExtent",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryExtent(e||r.createQuery(),t)}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryFeatureCount(e||r.createQuery(),t)}))}},{key:"queryFeatures",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryFeatures(e||r.createQuery(),t)})).then((function(e){if(null!=e&&e.features){var t,a=Object(o.a)(e.features);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.layer=r.layer,i.sourceLayer=r}}catch(n){a.e(n)}finally{a.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryObjectIds(e||r.createQuery(),t)}))}},{key:"getFieldUsageInfo",value:function(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:Object(j.k)(this.associatedLayer)}}},{key:"_getAssociatedLayerForQuery",value:function(){var e=this.associatedLayer;return Object(j.k)(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}},{key:"_loadAssociatedLayerForQuery",value:function(){var e=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!Object(j.j)(this.associatedLayer)){e.next=4;break}throw new y.a("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:this});case 4:return e.prev=4,e.next=7,this.associatedLayer.load();case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new y.a("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:this,error:e.t0});case 12:return e.abrupt("return",this.associatedLayer);case 13:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()}]),r}(O.a.LoadableMixin(Object(g.b)(S.a)));Object(d.a)([Object(m.b)({readOnly:!0})],U.prototype,"parsedUrl",null),Object(d.a)([Object(m.b)({type:I.c,readOnly:!0})],U.prototype,"nodePages",void 0),Object(d.a)([Object(m.b)({type:[I.b],readOnly:!0})],U.prototype,"materialDefinitions",void 0),Object(d.a)([Object(m.b)({type:[I.d],readOnly:!0})],U.prototype,"textureSetDefinitions",void 0),Object(d.a)([Object(m.b)({type:[I.a],readOnly:!0})],U.prototype,"geometryDefinitions",void 0),Object(d.a)([Object(m.b)({readOnly:!0})],U.prototype,"serviceUpdateTimeStamp",void 0),Object(d.a)([Object(m.b)({readOnly:!0})],U.prototype,"store",void 0),Object(d.a)([Object(m.b)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],U.prototype,"rootNode",void 0),Object(d.a)([Object(m.b)({readOnly:!0})],U.prototype,"attributeStorageInfo",void 0),Object(d.a)([Object(m.b)(z.fields)],U.prototype,"fields",void 0),Object(d.a)([Object(m.b)({readOnly:!0})],U.prototype,"fieldsIndex",null),Object(d.a)([Object(m.b)({readOnly:!0,type:P.default})],U.prototype,"associatedLayer",void 0),Object(d.a)([Object(_.a)("service","associatedLayer",["associatedLayerID"])],U.prototype,"readAssociatedLayer",null),Object(d.a)([Object(m.b)(z.outFields)],U.prototype,"outFields",void 0),Object(d.a)([Object(m.b)({type:String,readOnly:!0})],U.prototype,"objectIdField",null),Object(d.a)([Object(m.b)({readOnly:!0,type:String,json:{read:!1}})],U.prototype,"displayField",null),Object(d.a)([Object(m.b)({readOnly:!0,type:String,aliasOf:"layer.apiKey"})],U.prototype,"apiKey",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:x.a,aliasOf:"layer.fullExtent"})],U.prototype,"fullExtent",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:C.a,aliasOf:"layer.spatialReference"})],U.prototype,"spatialReference",void 0),Object(d.a)([Object(m.b)({readOnly:!0,aliasOf:"layer.version"})],U.prototype,"version",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:M.a,aliasOf:"layer.elevationInfo"})],U.prototype,"elevationInfo",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:Number,aliasOf:"layer.minScale"})],U.prototype,"minScale",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:Number,aliasOf:"layer.maxScale"})],U.prototype,"maxScale",void 0),Object(d.a)([Object(m.b)({type:["hide","show"],json:{write:!0}})],U.prototype,"listMode",void 0),Object(d.a)([Object(m.b)({types:b.b,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],U.prototype,"renderer",void 0),Object(d.a)([Object(m.b)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],U.prototype,"definitionExpression",void 0),Object(d.a)([Object(m.b)(V.j)],U.prototype,"popupEnabled",void 0),Object(d.a)([Object(m.b)({type:p.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],U.prototype,"popupTemplate",void 0),Object(d.a)([Object(m.b)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],U.prototype,"normalReferenceFrame",void 0),Object(d.a)([Object(m.b)({readOnly:!0,json:{read:!1}})],U.prototype,"defaultPopupTemplate",null),Object(d.a)([Object(m.b)()],U.prototype,"types",null),Object(d.a)([Object(m.b)()],U.prototype,"typeIdField",null),Object(d.a)([Object(m.b)({json:{write:!1}}),Object(w.a)(new f.a({"3DObject":"3d-object",Point:"point"}))],U.prototype,"layerType",void 0),Object(d.a)([Object(m.b)()],U.prototype,"geometryType",null),Object(d.a)([Object(m.b)()],U.prototype,"profile",null),Object(d.a)([Object(m.b)({readOnly:!0,json:{read:!1}})],U.prototype,"capabilities",null);var G=U=Object(d.a)([Object(k.a)("esri.layers.buildingSublayers.BuildingComponentSublayer")],U)},1021:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var a=r(3),i=r(4),n=r(6),o=r(7),s=r(0),c=r(247),l=r(285),u=r(1),d=(r(17),r(18)),p=(r(16),r(48)),b=r(9),h=r(200),y=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).title="",i.id=-1,i.modelName=null,i.isEmpty=null,i.visible=!0,i.opacity=1,i}return Object(i.a)(r,[{key:"readTitle",value:function(e,t){return"string"==typeof t.alias?t.alias:"string"==typeof t.name?t.name:""}},{key:"readIdOnlyOnce",value:function(e){return-1!==this.id?this.id:"number"==typeof e?e:void 0}}]),r}(Object(c.a)(l.b));Object(s.a)([Object(u.b)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],y.prototype,"title",void 0),Object(s.a)([Object(p.a)("service","title",["alias","name"])],y.prototype,"readTitle",null),Object(s.a)([Object(u.b)()],y.prototype,"layer",void 0),Object(s.a)([Object(u.b)({type:d.a,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],y.prototype,"id",void 0),Object(s.a)([Object(p.a)("service","id")],y.prototype,"readIdOnlyOnce",null),Object(s.a)([Object(u.b)(Object(h.k)(String))],y.prototype,"modelName",void 0),Object(s.a)([Object(u.b)(Object(h.k)(Boolean))],y.prototype,"isEmpty",void 0),Object(s.a)([Object(u.b)({type:Boolean,json:{name:"visibility",write:!0}})],y.prototype,"visible",void 0),Object(s.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"opacity",void 0);var f=y=Object(s.a)([Object(b.a)("esri.layers.buildingSublayers.BuildingSublayer")],y)},1022:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,tileMaxRecordCount:0}}},1035:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r(8),i=r.n(a),n=r(15),o=r(69),s=r(20),c=r(2);function l(e,t,r,a,i,n){return u.apply(this,arguments)}function u(){return u=Object(n.a)(i.a.mark((function e(t,r,a,n,l,u){var d,p,b,h,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=null,!Object(c.k)(a)){e.next=17;break}return p="".concat(t,"/nodepages/"),b=p+Math.floor(a.rootIndex/a.nodesPerPage),e.prev=3,e.next=6,Object(o.default)(b,{query:{f:"json",token:n},responseType:"json",signal:u});case 6:return e.t0=e.sent.data,e.t1=a.rootIndex,e.t2=a.nodesPerPage,e.t3=a.lodSelectionMetricType,e.t4=p,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),Object(c.k)(l)&&l.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",b,e.t5),d=e.t5;case 17:if(r){e.next=19;break}return e.abrupt("return",null);case 19:return h="".concat(t,"/nodes/"),y=h+(r&&r.split("/").pop()),e.prev=20,e.next=23,Object(o.default)(y,{query:{f:"json",token:n},responseType:"json",signal:u});case 23:return e.t6=e.sent.data,e.t7=h,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new s.a("sceneservice:root-node-missing","Root node missing.",{pageError:d,nodeError:e.t8,url:y});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),u.apply(this,arguments)}},1037:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(3),i=r(4),n=function(){function e(t){var r=this;Object(a.a)(this,e),this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch("ready",(function(e){r._resourcesCreated&&(e?r._createResources():r._destroyResources())}))}return Object(i.a)(e,[{key:"applyProps",value:function(e){var t=!1;for(var r in e)r in this?"attached"===r?t=e[r]:this[r]=e[r]:console.error("Cannot set unknown property",r);this.attached=t}},{key:"destroy",value:function(){this.attached=!1}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}()},1038:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var a=r(3),i=r(4),n=r(6),o=r(7),s=r(2),c=r(29),l=r(36),u=r(5),d=r(11),p=r(62),b=r(234),h=r(1006),y=r(422),f=r(415),O=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e))._renderOccluded=4,i._width=1,i._color=Object(b.c)(1,0,1,1),i._innerWidth=1,i._innerColor=null,i._stipplePattern=null,i._stippleOffColor=null,i._stippleIntegerRepeats=!1,i._writeDepthEnabled=!0,i._falloff=0,i._polygonOffset=!1,i.applyProps(e),i}return Object(i.a)(r,[{key:"setGeometryFromRenderSpacePoint",value:function(e){var t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}},{key:"setGeometryFromExtent",value:function(e){var t=this.view.spatialReference,r=Object(d.e)(),a=Object(d.e)(),i=100,n=[];Object(u.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),Object(u.y)(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),Object(u.y)(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),Object(u.y)(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),Object(u.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),Object(u.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,a),n.push([a[0],a[1],a[2]]),this.geometry=[n]}},{key:"setGeometryFromFrustum",value:function(e){var t=[];e.lines.forEach((function(e){t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}},{key:"setGeometryFromBoundedPlane",value:function(e){var t=[],r=e.origin,a=e.basis1,i=e.basis2,n=.5,o=Object(d.e)(),s=Object(d.e)(),c=Object(d.e)(),l=Object(d.e)();o[0]=r[0]-a[0]*n-i[0]*n,o[1]=r[1]-a[1]*n-i[1]*n,o[2]=r[2]-a[2]*n-i[2]*n,s[0]=r[0]-a[0]*n+i[0]*n,s[1]=r[1]-a[1]*n+i[1]*n,s[2]=r[2]-a[2]*n+i[2]*n,c[0]=r[0]+a[0]*n+i[0]*n,c[1]=r[1]+a[1]*n+i[1]*n,c[2]=r[2]+a[2]*n+i[2]*n,l[0]=r[0]+a[0]*n-i[0]*n,l[1]=r[1]+a[1]*n-i[1]*n,l[2]=r[2]+a[2]*n-i[2]*n,t.push([o[0],o[1],o[2]]),t.push([s[0],s[1],s[2]]),t.push([c[0],c[1],c[2]]),t.push([l[0],l[1],l[2]]),t.push([o[0],o[1],o[2]]),this.geometry=[t]}},{key:"setGeometryFromSegment",value:function(e){var t=e.endRenderSpace;Object(c.i)(v),Object(c.t)(v,v,t),this.transform=v;var r=e.createRenderGeometry(t,this.view.renderCoordsHelper).points;this.geometry=[r]}},{key:"setGeometryFromSegments",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.b;Object(c.i)(v),Object(c.t)(v,v,r),this.transform=v,this.geometry=e.map((function(e){return e.createRenderGeometry(r,t.view.renderCoordsHelper).points}))}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){Object(p.g)(e,this._color)||(Object(p.c)(this._color,e),this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){Object(s.k)(e)?!Object(s.j)(this._innerColor)&&Object(p.g)(e,this._innerColor)||(this._innerColor=Object(p.c)(Object(b.b)(),e),this._updateMaterial()):Object(s.k)(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){var t=Object(s.k)(e)!==Object(s.k)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){(Object(s.j)(e)||Object(s.j)(this._stippleOffColor)||!Object(p.g)(e,this._stippleOffColor))&&(this._stippleOffColor=Object(s.k)(e)?Object(b.a)(e):null,this._updateMaterial())}},{key:"stippleIntegerRepeats",get:function(){return this._stippleIntegerRepeats},set:function(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}},{key:"createExternalResources",value:function(){this._material=new f.a(this.materialParameters)}},{key:"destroyExternalResources",value:function(){this._material=null}},{key:"createGeometries",value:function(e){var t=this._createLineGeometries();if(0!==t.length)for(var r=0;r<t.length;++r){var a=Object(y.a)(t[r]);e.addGeometry(a,this._material)}}},{key:"forEachExternalMaterial",value:function(e){e(this._material)}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}},{key:"_updateMaterial",value:function(){this.attached&&this._material.setParameterValues(this.materialParameters)}},{key:"_createLineGeometries",value:function(){var e=this.geometry;if(Object(s.j)(e)||0===e.length)return[];var t=[];return e.forEach((function(e){var r=e.length,a=new Float64Array(3*r);e.forEach((function(e,t){a[3*t+0]=e[0],a[3*t+1]=e[1],a[3*t+2]=e[2]}));var i={attributeData:{position:a},removeDuplicateStartEnd:0};t.push(i)})),t}}]),r}(h.a),v=Object(l.d)()},1060:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return y}));var a,i,n,o=r(13),s=r(84),c=r(153),l=r(130),u=r(128),d=r(125),p=r(187),b=r(10),h=r(87);function y(e){var t=new h.a;return t.include(c.a,{linearDepth:!1}),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.varyings.add("vpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.uniforms.add("textureCoordinateScaleFactor","vec2"),t.vertex.code.add(Object(b.a)(a||(a=Object(o.a)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(s.a,e),e.multipassTerrainEnabled&&(t.fragment.include(l.a),t.include(u.b,e)),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("opacity","float"),t.varyings.add("vTexCoord","vec2"),7===e.output?t.fragment.code.add(Object(b.a)(i||(i=Object(o.a)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ",") {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",b.a.float(d.b))):(t.fragment.include(p.a),t.fragment.code.add(Object(b.a)(n||(n=Object(o.a)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ","\n    }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",b.a.float(d.b),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t}var f=Object.freeze({__proto__:null,build:y})},1137:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var a,i=r(13),n=r(10);function o(e){e.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),e.vertex.code.add(Object(n.a)(a||(a=Object(i.a)(["float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}"]))))}function s(e,t,r){e.setUniform1f("perScreenPixelRatio",r.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}},1138:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return w}));var a,i,n,o,s,c,l,u,d,p=r(13),b=r(1137),h=r(84),y=r(153),f=r(130),O=r(128),v=r(125),j=r(187),g=r(10),m=r(87);function w(e){var t=new m.a;return t.include(y.a,{linearDepth:!1}),t.include(b.a,{}),t.include(h.a,e),t.fragment.include(j.a),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.fragment.uniforms.add("color","vec4"),t.attributes.add("position","vec3"),t.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add("offset","vec3"),e.shadingEnabled&&(t.vertex.uniforms.add("viewNormal","mat4"),t.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vViewNormal","vec3")),t.vertex.code.add(Object(g.a)(a||(a=Object(p.a)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&t.vertex.code.add(Object(g.a)(i||(i=Object(p.a)(["vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;"])))),t.vertex.code.add(Object(g.a)(n||(n=Object(p.a)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(f.a),t.include(O.b,e)),t.fragment.code.add(Object(g.a)(o||(o=Object(p.a)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?t.fragment.code.add(Object(g.a)(s||(s=Object(p.a)(["vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);"])))):t.fragment.code.add(Object(g.a)(c||(c=Object(p.a)(["vec4 finalColor = color;"])))),t.fragment.code.add(Object(g.a)(l||(l=Object(p.a)(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),g.a.float(v.c),7===e.output?Object(g.a)(u||(u=Object(p.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(g.a)(d||(d=Object(p.a)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}var _=Object.freeze({__proto__:null,build:w})},1139:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var a,i,n=r(13),o=r(10),s=r(87);function c(){var e=new s.a;return e.extensions.add("GL_OES_standard_derivatives"),e.vertex.uniforms.add("proj","mat4").add("view","mat4"),e.attributes.add("position","vec3"),e.attributes.add("uv0","vec2"),e.varyings.add("vUV","vec2"),e.vertex.code.add(Object(o.a)(a||(a=Object(n.a)(["void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}"])))),e.fragment.uniforms.add("backgroundColor","vec4").add("gridColor","vec4").add("ratio","float").add("gridWidth","float"),e.fragment.code.add(Object(o.a)(i||(i=Object(n.a)(["void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}"])))),e}var l=Object.freeze({__proto__:null,build:c})},1162:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var a=r(14),i=r(3),n=r(4),o=r(6),s=r(7),c=r(559),l=r(135),u=r(99),d=r(293),p=r(110),b=r(0),h=r(84),y=r(128),f=r(121),O=r(89),v=r(96),j=r(28),g=r(78),m=r(88),w=r(127),_=r(1060),k=r(40),x=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(n.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),a=this.configuration,i=t.build({output:a.output,slicePlaneEnabled:a.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===a.transparencyPassType,multipassTerrainEnabled:a.multipassTerrainEnabled,cullAboveGround:a.cullAboveGround});return new m.a(e.rctx,i,g.a)}},{key:"bindPass",value:function(e,t){Object(f.c)(this.program,t.camera.projectionMatrix),this.program.setUniform1f("opacity",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(y.a)(this.program,t))}},{key:"bindDraw",value:function(e){Object(f.d)(this.program,e),Object(h.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e,t){var r=this.configuration,a=3===e,i=2===e;return Object(k.g)({blending:0!==r.output&&7!==r.output||!r.transparent?null:a?C:Object(u.a)(e),culling:Object(k.c)(r.cullFace),depthTest:{func:Object(u.b)(e)},depthWrite:a?r.writeDepth&&k.e:Object(u.c)(e),colorWrite:k.d,stencilWrite:r.sceneHasOcludees?w.j:null,stencilTest:r.sceneHasOcludees?t?w.f:w.e:null,polygonOffset:a||i?null:Object(u.h)(r.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),r}(v.a);x.shader=new O.a(_.a,(function(){return r.e(237).then(r.bind(null,1355))}));var C=Object(k.i)(1,771),P=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(j.a);Object(b.a)([Object(j.b)({count:8})],P.prototype,"output",void 0),Object(b.a)([Object(j.b)({count:3})],P.prototype,"cullFace",void 0),Object(b.a)([Object(j.b)()],P.prototype,"slicePlaneEnabled",void 0),Object(b.a)([Object(j.b)()],P.prototype,"transparent",void 0),Object(b.a)([Object(j.b)()],P.prototype,"enableOffset",void 0),Object(b.a)([Object(j.b)()],P.prototype,"writeDepth",void 0),Object(b.a)([Object(j.b)()],P.prototype,"sceneHasOcludees",void 0),Object(b.a)([Object(j.b)({count:4})],P.prototype,"transparencyPassType",void 0),Object(b.a)([Object(j.b)()],P.prototype,"multipassTerrainEnabled",void 0),Object(b.a)([Object(j.b)()],P.prototype,"cullAboveGround",void 0);var S=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e,V)).supportsEdges=!0,a.techniqueConfig=new P,a}return Object(n.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<u.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"intersect",value:function(e,t,r,a,i,n,o){Object(p.i)(e,t,a,i,n,void 0,o)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output?new E(e):void 0}},{key:"createBufferWriter",value:function(){return new d.a(d.d)}}]),r}(l.a),E=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,Object(a.a)(Object(a.a)({},e),e.material.params))).updateParameters(),n}return Object(n.a)(r,[{key:"updateParameters",value:function(e){var t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(x,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return 23===e||(4===this._output?3===e:e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3))}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}},{key:"bind",value:function(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),r}(c.a),V=Object(a.a)({transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0},l.b)},1365:function(e,t,r){"use strict";r.r(t),r.d(t,"SliceLayerView3D",(function(){return ut})),r.d(t,"default",(function(){return dt}));var a=r(8),i=r.n(a),n=r(15),o=r(3),s=r(4),c=r(6),l=r(7),u=r(0),d=r(23),p=r(1),b=r(17),h=r(18),y=r(16),f=r(9),O=r(32),v=r(55),j=r(2),g=r(27),m=r(176),w=r(373),_=r(1020),k=r(35),x=(r(31),r(112),r(162)),C=r(24),P=r(30),S=r(29),E=r(36),V=(r(220),r(5)),T=r(11),F=r(46),D=r(86),I=r(239),R=r(54),L=(r(12),r(80),r(131),r(70),r(106)),M=(r(33),r(53),r(72),r(45),r(144)),q=(r(412),r(181)),z=(r(238),r(101),r(189),r(335),r(56));Object(P.f)(),Object(M.c)(),Object(D.c)(),Object(L.b)(),Object(E.d)(),Object(E.d)(),Object(F.d)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),new z.a({x:0,y:0,z:0,spatialReference:null});var U=r(50),G=(r(117),r(196)),A=(r(666),r(14)),N=r(38),W=r(37),B=r(122),H=r(221),Q=r(135),K=r(51),Z=r(172),J=r(110),X=r(1137),Y=r(84),$=r(128),ee=r(121),te=r(89),re=r(96),ae=r(28),ie=r(99),ne=r(88),oe=r(1138),se=r(40),ce=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),a=this.configuration,i=t.build({output:a.output,slicePlaneEnabled:a.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:a.screenSizeEnabled,shadingEnabled:a.shadingEnabled,OITEnabled:0===a.transparencyPassType,multipassTerrainEnabled:a.multipassTerrainEnabled,cullAboveGround:a.cullAboveGround});return new ne.a(e.rctx,i,ue)}},{key:"bindPass",value:function(e,t){var r=this.configuration,a=r.screenSizeEnabled,i=r.shadingEnabled,n=e.color,o=e.shadingTint,s=e.shadingDirection;Object(ee.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("color",n),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object($.a)(this.program,t)),i&&(this.program.setUniform4fv("shadedColor",this.blendColor(de,o,n)),this.program.setUniform3fv("shadingDirection",s),this.program.setUniformMatrix4fv("viewNormal",t.camera.viewInverseTransposeMatrix)),a&&Object(X.b)(this.program,e,t)}},{key:"bindDraw",value:function(e){Object(ee.d)(this.program,e),Object(ee.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(Y.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"blendColor",value:function(e,t,r){var a=1-t[3],i=t[3]+r[3]*a;return 0===i?(e[3]=i,e):(e[0]=(t[0]*t[3]+r[0]*r[3]*a)/i,e[1]=(t[1]*t[3]+r[1]*r[3]*a)/i,e[2]=(t[2]*t[3]+r[2]*r[3]*a)/i,e[3]=r[3],e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,r=3===e,a=2===e;return Object(se.g)({blending:0!==t.output&&7!==t.output||!t.transparent?null:r?ie.g:Object(ie.a)(e),culling:Object(se.c)(t.cullFace),depthTest:{func:a?513:t.shadingEnabled?515:513},depthWrite:r?t.writeDepth&&se.e:Object(ie.c)(e),colorWrite:se.d,polygonOffset:r||a?null:ie.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),r}(re.a);ce.shader=new te.a(oe.a,(function(){return r.e(247).then(r.bind(null,1360))}));var le=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(ae.a);Object(u.a)([Object(ae.b)({count:8})],le.prototype,"output",void 0),Object(u.a)([Object(ae.b)({count:3})],le.prototype,"cullFace",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"slicePlaneEnabled",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"transparent",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"writeDepth",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"screenSizeEnabled",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"shadingEnabled",void 0),Object(u.a)([Object(ae.b)({count:4})],le.prototype,"transparencyPassType",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"multipassTerrainEnabled",void 0),Object(u.a)([Object(ae.b)()],le.prototype,"cullAboveGround",void 0);var ue=new Map([["position",0],["normal",1],["offset",2]]),de=Object(U.e)(),pe=(Q.a,function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).updateParameters(),a}return Object(s.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(ce,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){if(4===this._output)return 3===e;var t=3;return this._technique.configuration.transparent&&(t=this._technique.configuration.writeDepth?5:8),e===t||23===e}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}}]),r}(H.a)),be=Object(A.a)({color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(V.t)(Object(T.e)(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0},Q.b),he=function(){function e(t){Object(o.a)(this,e),this.screenSizeEnabled=t;var r=Object(B.a)().vec3f("position").vec3f("normal");this.screenSizeEnabled&&r.vec3f("offset"),this.vertexBufferLayout=r}return Object(s.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,r,a){if(Object(Z.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,a),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");var i=t.vertexAttributes.get("offset"),n=t.indices.get("offset");Object(K.a)(3===i.size);var o=r.getField("offset",W.u);if(!o)throw new Error("unable to acquire view for offset");Object(Z.e)(n,i.data,e.invTranspTransformation,o,a)}}}]),e}(),ye=Object(T.e)(),fe=Object(T.e)();function Oe(e,t,r,a){var i=Object(V.t)(R.d.get(),e),n=Object(V.t)(R.d.get(),t),o=Object(V.i)(R.d.get(),i,n);return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=0,a[4]=n[0],a[5]=n[1],a[6]=n[2],a[7]=0,a[8]=o[0],a[9]=o[1],a[10]=o[2],a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}Object(b.a)("mac"),Math.cos(Object(C.h)(45)),Math.cos(Object(C.h)(5));var ve=[1,.5,0],je=[].concat(ve,[.7]),ge=[0,0,0,.04],me=[].concat(ve,[.5]),we=([].concat(ve,[1]),[].concat(ve,[1]),[].concat(ve,[1]),r(1038)),_e=r(62),ke=r(234),xe=r(1006),Ce=r(139),Pe=r(293),Se=r(78),Ee=r(1139),Ve=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build();return new ne.a(e.rctx,t,Se.a)}},{key:"bindPass",value:function(e,t){Object(ee.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("backgroundColor",e.backgroundColor),this.program.setUniform4fv("gridColor",e.gridColor),this.program.setUniform1f("gridWidth",e.gridWidth)}},{key:"bindDraw",value:function(e){Object(ee.d)(this.program,e),this.program.rebindTextures()}},{key:"initializePipeline",value:function(){return Object(se.g)({blending:Object(se.h)(1,1,771,771),depthTest:{func:513},colorWrite:se.d})}}]),r}(re.a);Ve.shader=new te.a(Ee.a,(function(){return r.e(250).then(r.bind(null,1361))}));var Te=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){return Object(o.a)(this,r),t.call(this,e,Ie)}return Object(s.a)(r,[{key:"intersect",value:function(e,t,r,a,i,n,o){return Object(J.i)(e,t,a,i,n,void 0,o)}},{key:"createBufferWriter",value:function(){return new Pe.a(Pe.d)}},{key:"getGLMaterial",value:function(e){return 0===e.output?new Fe(e):void 0}}]),r}(Q.a),Fe=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e))._technique=new Ve(a._techniqueRep.constructionContext,null),a.updateParameters(),a}return Object(s.a)(r,[{key:"updateParameters",value:function(){}},{key:"beginSlot",value:function(e){return 8===e}},{key:"bind",value:function(e){this._technique.bindPass(this._material.params,e)}}]),r}(H.a);Object(u.a)([Object(Ce.c)()],Fe.prototype,"_technique",void 0);var De,Ie=Object(A.a)({backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4},Q.b),Re=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e))._material=null,a._renderOccluded=4,a._gridWidth=1,a._gridColor=Object(ke.c)(1,0,0,1),a._backgroundColor=Object(ke.c)(1,0,0,1),a.applyProps(e),a}return Object(s.a)(r,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"gridWidth",get:function(){return this._gridWidth},set:function(e){this._gridWidth!==e&&(this._gridWidth=e,this._updateMaterial())}},{key:"gridColor",get:function(){return this._gridColor},set:function(e){Object(_e.c)(this._gridColor,e),this._updateMaterial()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){Object(_e.c)(this._backgroundColor,e),this._updateMaterial()}},{key:"createExternalResources",value:function(){this._material=new Te(this.materialParameters)}},{key:"destroyExternalResources",value:function(){this._material=null}},{key:"forEachExternalMaterial",value:function(e){Object(j.k)(this._material)&&e(this._material)}},{key:"createGeometries",value:function(e){if(Object(j.k)(this._material)){var t=G.a.createSquareGeometry();e.addGeometry(t,this._material)}}},{key:"materialParameters",get:function(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}},{key:"_updateMaterial",value:function(){Object(j.k)(this._material)&&this._material.setParameterValues(this.materialParameters)}}]),r}(xe.a),Le=(r(132),r(1162),r(439),r(415),r(25)),Me=r(26),qe=r(60),ze=r(999),Ue=r(98),Ge=De=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).type="plane",a.position=null,a.heading=0,a.tilt=0,a.width=10,a.height=10,a}return Object(s.a)(r,[{key:"clone",value:function(){return new De({position:Object(Me.a)(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}},{key:"equals",value:function(e){return this.heading===e.heading&&this.tilt===e.tilt&&Object(j.k)(this.position)&&Object(j.k)(e.position)&&this.position.equals(e.position)&&this.width===e.width&&this.height===e.height}}]),r}(Le.a);Object(u.a)([Object(p.b)({readOnly:!0,json:{read:!1,write:!0}})],Ge.prototype,"type",void 0),Object(u.a)([Object(p.b)({type:z.a}),Object(ze.a)()],Ge.prototype,"position",void 0),Object(u.a)([Object(p.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(ze.a)(),Object(qe.a)((function(e){return Ue.e.normalize(Object(h.i)(e),0,!0)}))],Ge.prototype,"heading",void 0),Object(u.a)([Object(p.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(ze.a)(),Object(qe.a)((function(e){return Ue.e.normalize(Object(h.i)(e),0,!0)}))],Ge.prototype,"tilt",void 0),Object(u.a)([Object(p.b)({type:Number,nonNullable:!0}),Object(ze.a)()],Ge.prototype,"width",void 0),Object(u.a)([Object(p.b)({type:Number,nonNullable:!0}),Object(ze.a)()],Ge.prototype,"height",void 0);var Ae=Ge=De=Object(u.a)([Object(f.a)("esri.widgets.Slice.SlicePlane")],Ge),Ne=y.a.getLogger("esri.views.3d.interactive.analysisTools.slice.sliceToolUtils");function We(e,t,r){var a=t.worldUpAtPosition(e.origin,R.d.get()),i=e.basis1,n=He(e,a),o=Math.round(n/Ze)*Ze;return Object(m.j)(e,o-n,i,r)}function Be(e){return new we.a({view:e,attached:!0,color:je,width:1,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function He(e,t){return Object(I.b)(t,e.basis2,e.basis1)+Ze}function Qe(e,t,r){return Object(I.b)(e.basis1,r,t)-Ze}function Ke(e,t,r,a,i,n){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Object(m.b)();return n.toRenderCoords(e,o.origin)?(n.worldBasisAtPosition(o.origin,0,o.basis1),n.worldBasisAtPosition(o.origin,1,o.basis2),Object(F.j)(o.basis2,o.basis1,o.origin,o.plane),Object(m.j)(o,-Object(C.h)(t),Object(m.i)(o),o),Object(m.j)(o,Object(C.h)(r),o.basis1,o),Object(V.g)(o.basis1,o.basis1,a/2),Object(V.g)(o.basis2,o.basis2,i/2),Object(m.l)(o),o):(Ne.error("Failed to project slice plane position, projection from ".concat(e.spatialReference.wkid," is not supported")),null)}Object(D.c)();var Ze=Math.PI/2,Je=y.a.getLogger("esri.views.3d.interactive.graphics.Slice.SliceController"),Xe=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e))._handles=new v.a,a._internalChange=!1,a._currentSlicePlane=null,a.state="pending",a}return Object(s.a)(r,[{key:"ready",get:function(){return"ready"===this.state}},{key:"initialize",value:function(){var e=this;this._handles.add(this.layerView.layerViewData.excludedLayers.on("before-add",(function(t){var r=t.item;null!=r&&(r instanceof w.a||r instanceof _.a)?r instanceof w.a&&function(e){switch(e.type){case"building-scene":case"csv":case"direct-line-measurement":case"area-measurement":case"feature":case"geo-rss":case"geojson":case"graphics":case"group":case"integrated-mesh":case"kml":case"line-of-sight":case"map-notes":case"ogc-feature":case"point-cloud":case"route":case"slice":case"scene":case"stream":case"voxel":case"subtype-group":case"unknown":case"unsupported":case"wfs":case null:return!1;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"elevation":case"imagery":case"imagery-tile":case"map-image":case"open-street-map":case"tile":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":return!0;default:return Object(x.a)(e.type),!1}}(r)?(Je.error("excludedLayers","Layer '".concat(r.title,", id:").concat(r.id,"' of type '").concat(r.type,"' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.")),t.preventDefault()):e.layerView.layerViewData.excludedLayers.includes(r)&&t.preventDefault():(Je.error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),t.preventDefault())}))),this._handles.add(Object(g.k)(this.view,"ready",(function(){return e._initialize()}),!0))}},{key:"_initialize",value:function(){var e,t,r=this;switch(this.state){case"pending":break;case"destroyed":return;case"ready":throw new Error("state error")}e=this.view,t=this,Ye.has(e)||Ye.set(e,{all:[],activeController:null}),Ye.get(e).all.push(t),this._handles.add([this.layerView.layerViewData.watch("plane",(function(){r._internalChange||r._updateSlicePlaneFromBoundedPlane(),r._updateLayerViews()}),!0),this.layerView.layerViewData.watch("excludeGroundSurface",(function(){return r._updateLayerViews()}),!0),this.layerView.layerViewData.excludedLayers.on("change",(function(){return r._updateLayerViews()})),this.layerView.watch(["active","visible"],(function(){r._updateActiveController(),r._updateViewSlicePlane()}),!0),this.view.allLayerViews.on("change",(function(){return r._updateLayerViews()}))]),this._handles.add([this.analysis.watch("plane",(function(){r._internalChange||(r._updateBoundedPlaneFromSlicePlane(),r._updateViewSlicePlane())}),!0)],"analysis"),this._set("state","ready"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}},{key:"destroy",value:function(){switch(this.state){case"destroyed":case"pending":return}this.layerView.active=!1,function(e,t){if(!Ye.has(e))throw new Error("view expected in global slice register");var r=Ye.get(e),a=r.all.lastIndexOf(t);if(-1===a)throw new Error("controller expected in global slice register");r.all.splice(a,1),0===r.all.length&&Ye.delete(e)}(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set("view",null),this._set("state","destroyed")}},{key:"whenReady",value:function(){var e=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.k)(this,"ready");case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateBoundedPlaneFromSlicePlane",value:function(){var e=this.analysis.plane,t=this._currentSlicePlane;if(!(Object(j.j)(t)&&Object(j.j)(e)||Object(j.k)(t)&&Object(j.k)(e)&&e.equals(t))){var r=null,a=null;Object(j.k)(e)&&(r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(m.b)();if(Object(j.j)(e)||Object(j.j)(e.position))return null;var a=e.position;return e.position.hasZ||((a=e.position.clone()).z=Object(j.u)(Object(q.b)(t.elevationProvider,e.position),0)),Ke(a,e.heading,e.tilt,e.width,e.height,t.renderCoordsHelper,r)}(e,this.view,Object(m.b)()),Object(j.k)(r)?a={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height}:console.warn("Failed slice plane conversion.")),this._currentSlicePlane=a,Object(j.k)(r)&&!this.analysis.tiltEnabled&&We(r,this.view.renderCoordsHelper,r),this._internalChange=!0,this.layerView.layerViewData.plane=r,this._internalChange=!1}}},{key:"_updateSlicePlaneFromBoundedPlane",value:function(){var e=this.layerView.layerViewData.plane,t=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ae;if(Object(j.j)(e))return null;var i=Object(j.k)(a.position)?a.position:new z.a;t.fromRenderCoords(e.origin,i,r),a.position=i;var n=t.worldUpAtPosition(e.origin,R.d.get()),o=t.worldBasisAtPosition(e.origin,1,R.d.get());return a.width=2*Object(V.r)(e.basis1),a.height=2*Object(V.r)(e.basis2),a.tilt=Object(C.r)(He(e,n)),a.heading=Object(C.r)(Qe(e,n,o)),a}(e,this.view.renderCoordsHelper,this.view.spatialReference,new Ae),r=null;Object(j.k)(t)&&(r={heading:t.heading,tilt:t.tilt,position:t.position,width:t.width,height:t.height}),this._currentSlicePlane=r,Object(j.k)(e)&&(this.analysis.tiltEnabled||We(e,this.view.renderCoordsHelper,e)),this._internalChange=!0,this.analysis.plane=t,this._internalChange=!1,this._updateViewSlicePlane()}},{key:"_updateActiveController",value:function(){if(!$e){var e=et(this.view);if(this.layerView.active)Object(j.k)(e.activeController)&&e.activeController!==this?($e=!0,e.activeController.layerView.active=!1,$e=!1):Object(j.k)(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(Object(j.k)(e.activeController)&&e.activeController!==this)return;Object(j.k)(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}}},{key:"_updateViewSlicePlane",value:function(){"ready"===this.state&&function(e){var t=et(e).activeController;Object(j.k)(t)&&Object(j.k)(t.layerView.layerViewData.plane)&&t.layerView.visible?e.slicePlane=t.layerView.layerViewData.plane:e.slicePlane=null}(this.view)}},{key:"_updateLayerViews",value:function(){var e=Object(j.k)(this.layerView.layerViewData.plane)&&this.layerView.visible&&this.layerView.active,t=[];this.layerView.layerViewData.excludedLayers.forEach((function e(r){"layers"in r?r.layers.forEach(e):t.push(r)})),this.view.allLayerViews.forEach((function(r){"slicePlaneEnabled"in r&&(r.slicePlaneEnabled=e&&t.indexOf(r.layer)<0),"sublayerViews"in r&&r.sublayerViews.forEach((function(r){r.slicePlaneEnabled=e&&t.indexOf(r.sublayer)<0}))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.layerView.layerViewData.excludeGroundSurface)}}]),r}(O.a);Object(u.a)([Object(p.b)({readOnly:!0})],Xe.prototype,"state",void 0),Object(u.a)([Object(p.b)()],Xe.prototype,"view",void 0),Object(u.a)([Object(p.b)()],Xe.prototype,"analysis",void 0),Object(u.a)([Object(p.b)()],Xe.prototype,"layerView",void 0),Object(u.a)([Object(p.b)()],Xe.prototype,"ready",null),Xe=Object(u.a)([Object(f.a)("esri.views.3d.interactive.graphics.Slice.SliceController")],Xe);var Ye=new Map,$e=!1;function et(e){return Ye.get(e)}var tt=r(219),rt=r(389),at=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e))._handles=new v.a,a._gridVisualElement=null,a._outlineVisualElement=null,a.state="pending",a}return Object(s.a)(r,[{key:"ready",get:function(){return"ready"===this.state}},{key:"showGrid",set:function(e){this._set("showGrid",e),this._updateMaterials()}},{key:"editable",set:function(e){this._set("editable",e),this._updateMaterials()}},{key:"initialize",value:function(){this._initialize()}},{key:"_initialize",value:function(){var e=Object(n.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.state,e.next="pending"===e.t0?3:"destroyed"===e.t0?4:"ready"===e.t0?5:6;break;case 3:return e.abrupt("break",6);case 4:return e.abrupt("return");case 5:throw new Error("state error");case 6:return e.next=8,Object(g.k)(this.view,"ready",!0);case 8:if(!Object(j.j)(this.layerView.layerViewData)){e.next=10;break}throw new Error("expected internal object to be valid");case 10:this._gridVisualElement=(r=this.view,new Re({view:r,attached:!0,backgroundColor:Object(k.a)(ge),gridColor:me,gridWidth:4,renderOccluded:4})),this._outlineVisualElement=Be(this.view),this._handles.add(Object(tt.d)((function(){return t.layerView.fullOpacity}),(function(){return t._updateMaterials()})),"layer"),this._handles.add([this.layerView.watch("visible",(function(){return t._updateMaterials()}),!0),this.layerView.layerViewData.watch("plane",(function(){return t._updatePlane()}),!0),this.layerView.watch("active",(function(){return t._updateMaterials()}),!0)],"internal"),this._updatePlane(),this._set("state","ready");case 11:case"end":return e.stop()}var r}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){switch(this.state){case"destroyed":case"pending":return}this._handles.destroy(),this._gridVisualElement=Object(j.e)(this._gridVisualElement),this._outlineVisualElement=Object(j.e)(this._outlineVisualElement),this.set("view",null),this._set("state","destroyed")}},{key:"whenReady",value:function(){var e=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.k)(this,"ready");case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_update",value:function(){switch(this.state){case"pending":case"destroyed":return}}},{key:"_updatePlane",value:function(){var e=this.layerView.layerViewData.plane,t=Object(j.k)(e)?function(e,t){return Oe(e.basis1,e.basis2,e.origin,t)}(e,R.a.get()):null;if(this._outlineVisualElement.width=1,Object(j.k)(e)){var r=Object(V.y)(R.d.get(),Object(V.r)(e.basis1),Object(V.r)(e.basis2),1),a=Object(S.w)(R.a.get(),r),i=Object(S.m)(a,t,a);this._outlineVisualElement.transform=i,this._gridVisualElement.transform=i}this._updateMaterials()}},{key:"_updateMaterials",value:function(){var e=this.layerView.layerViewData.plane&&this.layerView.visible,t=this.layerView.active,r=this.layerView.fullOpacity,a=Object(C.c)(it,je,r);this._outlineVisualElement.color=a,this._outlineVisualElement.width=this.editable?1:2,this._outlineVisualElement.stipplePattern=t?null:Object(rt.b)(5);var i=Object(C.c)(it,ge,r),n=Object(j.k)(this.layerView.layerViewData)&&this.showGrid?me:[0,0,0,0];this._gridVisualElement.backgroundColor=i,this._gridVisualElement.gridColor=n,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}}]),r}(O.a);Object(u.a)([Object(p.b)({readOnly:!0})],at.prototype,"state",void 0),Object(u.a)([Object(p.b)()],at.prototype,"view",void 0),Object(u.a)([Object(p.b)()],at.prototype,"layer",void 0),Object(u.a)([Object(p.b)()],at.prototype,"layerView",void 0),Object(u.a)([Object(p.b)()],at.prototype,"ready",null),Object(u.a)([Object(p.b)({value:!1})],at.prototype,"showGrid",null),Object(u.a)([Object(p.b)({value:!0})],at.prototype,"editable",null),at=Object(u.a)([Object(f.a)("esri.views.3d.interactive.graphics.Slice.SliceView")],at);var it=Object(U.e)(),nt=r(693),ot=r(49),st=r(186),ct=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).plane=null,e.excludeGroundSurface=!1,e}return Object(s.a)(r,[{key:"excludedLayers",get:function(){return this._get("excludedLayers")||new ot.a},set:function(e){this._set("excludedLayers",Object(st.b)(e,this._get("excludedLayers")))}}]),r}(O.a);Object(u.a)([Object(p.b)()],ct.prototype,"plane",void 0),Object(u.a)([Object(p.b)()],ct.prototype,"excludeGroundSurface",void 0),Object(u.a)([Object(p.b)({cast:st.a})],ct.prototype,"excludedLayers",null),ct=Object(u.a)([Object(f.a)("esri.views.3d.interactive.graphics.Slice.SliceInternal")],ct);var lt=r(686),ut=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).type="slice-3d",e.analysisView=null,e.analysisController=null,e._initialized=Object(d.g)(),e.layerViewData=new ct,e.active=!0,e.showGrid=!1,e.editable=!1,e}return Object(s.a)(r,[{key:"initialize",value:function(){this.analysisView=new at({view:this.view,layer:this.layer,layerView:this}),this.analysisController=new Xe({view:this.view,analysis:this.layer,layerView:this}),this._initialized.resolve()}},{key:"destroy",value:function(){this.analysisView.destroy(),this.analysisView=null,this.analysisController.destroy(),this.analysisController=null}},{key:"when",value:function(){var e=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.destroyed){e.next=4;break}e.t0=null,e.next=21;break;case 4:return e.next=6,this._initialized.promise;case 6:if(!this.destroyed){e.next=10;break}e.t1=null,e.next=20;break;case 10:return e.next=12,this.analysisView.whenReady();case 12:if(!this.destroyed){e.next=16;break}e.t2=null,e.next=19;break;case 16:return e.next=18,this.analysisController.whenReady();case 18:e.t2=this;case 19:e.t1=e.t2;case 20:e.t0=e.t1;case 21:return e.abrupt("return",e.t0);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"testData",get:function(){return{view:this.analysisView,controller:this.analysisController}}}]),r}(Object(nt.a)(lt.a));Object(u.a)([Object(p.b)()],ut.prototype,"type",void 0),Object(u.a)([Object(p.b)()],ut.prototype,"layerViewData",void 0),Object(u.a)([Object(p.b)()],ut.prototype,"layer",void 0),Object(u.a)([Object(p.b)()],ut.prototype,"active",void 0),Object(u.a)([Object(p.b)({aliasOf:"analysisView.showGrid"})],ut.prototype,"showGrid",void 0),Object(u.a)([Object(p.b)({aliasOf:"analysisView.editable"})],ut.prototype,"editable",void 0);var dt=ut=Object(u.a)([Object(f.a)("esri.views.3d.layers.SliceLayerView3D")],ut)},999:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var a=r(8),i=r.n(a),n=r(15),o=r(14),s=r(12),c=r(2),l=r(718),u=r(34),d=r(552),p=r(236),b=r(190),h=r(1);function y(e){return f[function(e){return e instanceof Blob?e.type:function(e){var t=Object(u.n)(e);return j[t]||O}(e.url)}(e)]||v}var f={},O="text/plain",v=f[O],j={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(var g in j)f[j[g]]=g;var m=r(150);function w(e){var t=Object(c.k)(e)&&e.origins?e.origins:[void 0];return function(r,a){var i,n=function(e,t,r){if(Object(c.k)(e)&&"resource"===e.type)return function(e,t,r){var a=Object(p.b)(t,r);return{type:String,read:function(e,t,r){var i=Object(m.d)(e,t,r);return a.type===String?i:"function"==typeof a.type?new a.type({url:i}):void 0},write:{writer:function(t,i,n,s){if(!s||!s.resources)return"string"==typeof t?void(i[n]=Object(m.e)(t,s)):void(i[n]=t.write({},s));var d=function(e){return Object(c.j)(e)?null:"string"==typeof e?e:e.url}(t),p=d?Object(m.e)(d,Object(o.a)(Object(o.a)({},s),{},{verifyItemRelativeUrls:s&&s.verifyItemRelativeUrls?{writtenUrls:s.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null}),1):null,h=a.type!==String&&(!Object(l.a)(this)||s&&s.origin&&this.originIdOf(r)>Object(b.d)(s.origin));s&&s.portalItem&&Object(c.k)(p)&&!Object(u.s)(p)?h?function(e,t,r,a,i,n,o,s){var c=o.portalItem.resourceFromPath(a),l=x(r,a,o);y(l)===Object(u.n)(c.path)?(k(e,t,c,l,o.resources.toUpdate),i[n]=a):_(e,t,r,a,i,n,o,s)}(this,r,t,p,i,n,s,e):function(e,t,r,a){a.resources.toKeep.push({resource:a.portalItem.resourceFromPath(e)}),t[r]=e}(p,i,n,s):s&&s.portalItem&&(Object(c.j)(p)||Object(c.k)(Object(m.b)(p))||Object(u.t)(p)||h)?_(this,r,t,p,i,n,s,e):i[n]=p}}}}(e,t,r);switch(Object(c.k)(e)&&e.type?e.type:"other"){case"other":return{read:!0,write:!0};case"url":return{read:m.c.read,write:m.c.write}}}(e,r,a),d=Object(s.a)(t);try{for(d.s();!(i=d.n()).done;){var f=i.value,O=Object(h.c)(r,f,a);for(var v in n)O[v]=n[v]}}catch(j){d.e(j)}finally{d.f()}}}function _(e,t,r,a,i,n,o,s){var l=Object(d.a)(),p=x(r,a,o),b=Object(u.z)(Object(c.i)(s,"prefix"),l),h="".concat(b,".").concat(y(p)),f=o.portalItem.resourceFromPath(h);Object(u.t)(a)&&o.resources.pendingOperations.push(function(e){return C.apply(this,arguments)}(a).then((function(e){f.path="".concat(b,".").concat(y(e)),i[n]=f.itemRelativeUrl})).catch((function(){}))),k(e,t,f,p,o.resources.toAdd),i[n]=f.itemRelativeUrl}function k(e,t,r,a,i){i.push({resource:r,content:a,finish:function(r){!function(e,t,r){"string"==typeof e[t]?e[t]=r.url:e[t].url=r.url}(e,t,r)}})}function x(e,t,r){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(r))],{type:"application/json"})}function C(){return(C=Object(n.a)(i.a.mark((function e(t){var a,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(null,69));case 2:return a=e.sent.default,e.next=5,a(t,{responseType:"blob"});case 5:return n=e.sent,o=n.data,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=69.71ae259b.chunk.js.map