(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[51],{1304:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return x}));var a=r(8),n=r.n(a),i=r(15),s=r(31),l=r(3),o=r(4),u=r(6),c=r(7),d=r(0),b=r(2),y=r(27),h=r(1),p=(r(17),r(18),r(16),r(9)),f=r(693),m=r(722),g=r(674),O=r(1176),v=r(686),j=r(908),k=r(947),I=r(690),z=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments)).type="imagery-tile-3d",e.isAlignedMapTile=!0,e}return Object(o.a)(r,[{key:"initialize",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage();var t=this.updateFullExtent();this.addResolvingPromise(t);var r=Object(y.m)(this.view,"basemapTerrain.tilingSchemeLocked").then((function(){var t=e.view.basemapTerrain.tilingScheme,r=e.layer.tileInfo,a=["png","png24","png32","jpg","mixed"].indexOf(r.format)>-1&&t.compatibleWith(r);e.isAlignedMapTile=a;var n=a?r:t.toTileInfo();e._set("tileInfo",n),e.updatingHandles.add(e,"layer.renderer",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.interpolation",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.bandIds",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.multidimensionalDefinition",(function(){return e.refresh()}))}));this.addResolvingPromise(r)}},{key:"destroy",value:function(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}},{key:"_blankTile",get:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r=Object(s.a)(this.tileInfo.size,2),a=r[0],n=r[1];return e.width=a,e.height=n,t.clearRect(0,0,a,n),t.getImageData(0,0,a,n)}},{key:"imageFormatIsOpaque",get:function(){return"jpg"===this.layer.tileInfo.format}},{key:"hasMixedImageFormats",get:function(){return"mixed"===this.layer.tileInfo.format}},{key:"dataLevelRange",get:function(){var e=this.tileInfo.lods,t=this.layer.tileInfo.lods,r=e[0].scale,a=t[t.length-1].scale;return this.levelRangeFromScaleRange(r,a)}},{key:"fetchTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i){var s,l,o,u,c,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.tileInfo,l=this._canSymbolizeInWebGL(),o={tileInfo:s,requestRawData:l,signal:Object(b.t)(i.signal),requestAsImageElement:this.isAlignedMapTile},e.next=5,this.layer.fetchTile(t,r,a,o);case 5:if(!((u=e.sent)instanceof HTMLImageElement)){e.next=8;break}return e.abrupt("return",u);case 8:if(c=u&&u.pixelBlock,!Object(b.j)(c)){e.next=11;break}return e.abrupt("return",this._blankTile);case 11:if(e.t0=!l,!e.t0){e.next=17;break}return e.next=15,this.layer.applyRenderer(u);case 15:c=e.sent,e.t0=Object(b.j)(c);case 17:if(!e.t0){e.next=19;break}return e.abrupt("return",this._blankTile);case 19:return d=new g.a([t,r,a],c,s.size[0],s.size[1]),e.abrupt("return",(l?(d.symbolizerRenderer=this.layer.symbolizer.rendererJSON,d.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(t)),d.transformGrid=u.transformGrid):d.isRendereredSource=!0,d.interpolation=this.layer.interpolation,d.bandIds=this.layer.bandIds,d));case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"_getSymbolizerOptions",value:function(e){var t=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.spatialReference.isGeographic,resolution:{x:t,y:t},bandIds:this.layer.bandIds}}},{key:"ensureSymbolizerParameters",value:function(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}},{key:"createFetchPopupFeaturesQueryGeometry",value:function(e,t){return Object(k.a)(e,t,this.view)}},{key:"refresh",value:function(){this.emit("data-changed")}},{key:"doRefresh",value:function(){var e=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.suspended||this.emit("data-changed");case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_canSymbolizeInWebGL",value:function(){return Object(I.a)().supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}}]),r}(Object(O.a)(Object(j.a)(Object(m.a)(Object(f.a)(v.a)))));Object(d.a)([Object(h.b)({readOnly:!0})],z.prototype,"_blankTile",null),Object(d.a)([Object(h.b)({readOnly:!0})],z.prototype,"imageFormatIsOpaque",null),Object(d.a)([Object(h.b)({readOnly:!0})],z.prototype,"hasMixedImageFormats",null),Object(d.a)([Object(h.b)({readOnly:!0})],z.prototype,"dataLevelRange",null);var x=z=Object(d.a)([Object(p.a)("esri.views.3d.layers.ImageryTileLayerView3D")],z)}}]);
//# sourceMappingURL=51.29691e2c.chunk.js.map