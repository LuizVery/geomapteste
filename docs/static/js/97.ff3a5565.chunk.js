(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[97],{1116:function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var a=r(35),n=r(8),u=r.n(n),i=r(14),s=r(15),c=r(3),o=r(4),p=r(47),l=r(44),f=r(6),b=r(7),m=r(0),d=r(20),h=r(2),y=r(23),v=r(1),x=(r(17),r(18),r(16),r(9)),O=r(200),j=r(726),g=r(922),k=r(157),w=r(942),I=function(e){var t=function(e){Object(f.a)(r,e);var t=Object(b.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(o.a)(r,[{key:"initialize",value:function(){this.exportImageParameters=new j.a({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"exportImageVersion",get:function(){var e;return null==(e=this.exportImageParameters)||e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(){var e=Object(s.a)(u.a.mark((function e(t,r){var n,c,o,p,l,f,b=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.layer,t){e.next=3;break}return e.abrupt("return",Promise.reject(new d.a("mapimagelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:n})));case 3:return c=this.get("view.scale"),o=[],p=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0===t.minScale||c<=t.minScale,n=0===t.maxScale||c>=t.maxScale,t.visible&&a&&n&&(t.sublayers?t.sublayers.forEach(p):t.popupEnabled&&(s=Object(w.a)(t,Object(i.a)(Object(i.a)({},r),{},{defaultPopupTemplateEnabled:!1})),Object(h.k)(s)&&o.unshift({sublayer:t,popupTemplate:s})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=n.sublayers.toArray().reverse().map(p),e.next=6,Promise.all(l);case 6:return f=o.map(function(){var e=Object(s.a)(u.a.mark((function e(a){var n,i,s,c,o,p,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.sublayer,i=a.popupTemplate,e.next=3,n.load().catch((function(){}));case 3:return s=n.createQuery(),c=Object(h.k)(r)?r.event:null,o=Object(g.a)({renderer:n.renderer,event:c}),p=b.createFetchPopupFeaturesQueryGeometry(t,o),s.geometry=p,e.next=7,Object(w.b)(n,i);case 7:return s.outFields=e.sent,e.next=10,b._loadArcadeModules(i);case 10:return(l=e.sent)&&l.arcadeUtils.hasGeometryOperations(i)||(s.maxAllowableOffset=p.width/o),e.next=14,n.queryFeatures(s);case 14:return e.abrupt("return",e.sent.features);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,Object(y.k)(f);case 9:return e.abrupt("return",e.sent.reduce((function(e,t){return t.value?[].concat(Object(a.a)(e),Object(a.a)(t.value)):e}),[]).filter((function(e){return null!=e})));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e;return!!Object(p.a)(Object(l.a)(r.prototype),"canResume",this).call(this)&&(null==(e=this.timeExtent)||!e.isEmpty)}},{key:"_loadArcadeModules",value:function(e){if(e.get("expressionInfos.length"))return Object(k.e)()}}]),r}(e);return Object(m.a)([Object(v.b)()],t.prototype,"exportImageParameters",void 0),Object(m.a)([Object(v.b)({readOnly:!0})],t.prototype,"exportImageVersion",null),Object(m.a)([Object(v.b)()],t.prototype,"layer",void 0),Object(m.a)([Object(v.b)()],t.prototype,"suspended",void 0),Object(m.a)([Object(v.b)(O.a)],t.prototype,"timeExtent",void 0),t=Object(m.a)([Object(x.a)("esri.views.layers.MapImageLayerView")],t)}},1301:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return b}));var a=r(3),n=r(4),u=r(6),i=r(7),s=r(0),c=(r(1),r(17),r(18),r(16),r(9)),o=r(1089),p=r(1116),l=r(947),f=function(e){Object(u.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).type="map-image-3d",e}return Object(n.a)(r,[{key:"initialize",value:function(){var e=this;this.updatingHandles.add(this,"exportImageVersion",(function(){return e.updatingHandles.addPromise(e.refreshDebounced())}))}},{key:"createFetchPopupFeaturesQueryGeometry",value:function(e,t){return Object(l.a)(e,t,this.view)}},{key:"getFetchOptions",value:function(){return{timeExtent:this.timeExtent}}}]),r}(Object(p.a)(o.a)),b=f=Object(s.a)([Object(c.a)("esri.views.3d.layers.MapImageLayerView3D")],f)},922:function(e,t,r){"use strict";function a(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function n(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,a=0;a<e.length;a++){var n=e[a].size;"number"==typeof n&&(t+=n,r++)}return t/r}(e.stops):t}function u(e,t){if(!t)return e;var r=t.filter((function(e){return"size"===e.type})).map((function(t){var r=t.maxSize,a=t.minSize;return(n(r,e)+n(a,e))/2})),a=0,u=r.length;if(0===u)return e;for(var i=0;i<u;i++)a+=r[i];var s=Math.floor(a/u);return Math.max(s,e)}function i(e){var t=e&&e.renderer,r="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return r;var n="visualVariables"in t?u(r,t.visualVariables):r;if("simple"===t.type)return a(n,t.symbol);if("unique-value"===t.type){var i=n;return t.uniqueValueInfos.forEach((function(e){i=a(i,e.symbol)})),i}if("class-breaks"===t.type){var s=n;return t.classBreakInfos.forEach((function(e){s=a(s,e.symbol)})),s}return t.type,n}r.d(t,"a",(function(){return i}))},942:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return o}));var a=r(8),n=r.n(a),u=r(35),i=r(15),s=r(2),c=r(81);function o(e){return p.apply(this,arguments)}function p(){return p=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,p,l,f,b,m,d=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:t.popupTemplate,Object(s.k)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,r.getRequiredFields(t.fieldsIndex);case 5:if(a=e.sent,i=r.lastEditInfoEnabled,o=t.objectIdField,p=t.typeIdField,l=t.globalIdField,f=t.relationships,!a.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!i){e.next=19;break}return e.next=16,Object(c.n)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return b=e.t0,m=Object(c.j)(t.fieldsIndex,[].concat(Object(u.a)(a),Object(u.a)(b))),e.abrupt("return",(p&&m.push(p),m&&o&&t.fieldsIndex.has(o)&&-1===m.indexOf(o)&&m.push(o),m&&l&&t.fieldsIndex.has(l)&&-1===m.indexOf(l)&&m.push(l),f&&f.forEach((function(e){var r=e.keyField;m&&r&&t.fieldsIndex.has(r)&&-1===m.indexOf(r)&&m.push(r)})),m));case 23:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function l(e,t){return e.popupTemplate?e.popupTemplate:Object(s.k)(t)&&t.defaultPopupTemplateEnabled&&Object(s.k)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},947:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(112);var a=r(2),n=r(79),u=(r(922),r(61));function i(e,t,r){var i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new u.a;if("2d"===r.type)i=t*r.resolution;else if("3d"===r.type){var c=r.overlayPixelSizeInMapUnits(e),o=r.basemapSpatialReference;i=Object(a.k)(o)&&!o.equals(r.spatialReference)?Object(n.f)(o)/Object(n.f)(r.spatialReference):t*c}var p=e.x-i,l=e.y-i,f=e.x+i,b=e.y+i,m=r.spatialReference;return s.xmin=Math.min(p,f),s.ymin=Math.min(l,b),s.xmax=Math.max(p,f),s.ymax=Math.max(l,b),s.spatialReference=m,s}new u.a}}]);
//# sourceMappingURL=97.ff3a5565.chunk.js.map