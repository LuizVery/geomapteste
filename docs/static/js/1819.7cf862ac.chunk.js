"use strict";(globalThis.webpackChunkgeowebmap=globalThis.webpackChunkgeowebmap||[]).push([[1819],{96669:(e,t,r)=>{function a(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function i(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){let t=0,r=0;for(let a=0;a<e.length;a++){const i=e[a].size;"number"==typeof i&&(t+=i,r++)}return t/r}(e.stops):t}function s(e,t){if(!t)return e;const r=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:r,minSize:a}=t;return(i(r,e)+i(a,e))/2}));let a=0;const s=r.length;if(0===s)return e;for(let i=0;i<s;i++)a+=r[i];const n=Math.floor(a/s);return Math.max(n,e)}function n(e){const t=e&&e.renderer,r="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return r;const i="visualVariables"in t?s(r,t.visualVariables):r;if("simple"===t.type)return a(i,t.symbol);if("unique-value"===t.type){let e=i;return t.uniqueValueInfos.forEach((t=>{e=a(e,t.symbol)})),e}if("class-breaks"===t.type){let e=i;return t.classBreakInfos.forEach((t=>{e=a(e,t.symbol)})),e}return t.type,i}r.d(t,{k:()=>n})},31819:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var a=r(27366),i=r(10064),s=r(92026),n=r(49861),l=(r(63780),r(93169),r(25243),r(69912)),o=r(79803),u=r(42069),p=r(77385),c=r(67581),f=r(13107),y=r(83561),h=r(45008);let m=class extends((0,f.y)((0,p.r)((0,y.D)((0,u.A)(c.Z))))){constructor(){super(...arguments),this.type="tile-3d"}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,t=e[0].scale,r=e[e.length-1].scale;return this.levelRangeFromScaleRange(t,r)}return{minLevel:0,maxLevel:0}}initialize(){if("web-tile"===this.layer.type){const e=this.layer.get("fullExtent.spatialReference"),t=this.layer.get("tileInfo.spatialReference");if((0,s.Wi)(e)||(0,s.Wi)(t)||!(0,o.Up)(e,t)){const e="defaults"===this.layer.originOf("fullExtent")||(0,s.Wi)(this.layer.fullExtent)?"SceneView requires fullExtent to be specified by the user on WebTileLayer":"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer";this.addResolvingPromise(Promise.reject(new i.Z("layerview:incompatible-fullextent",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,t){return(0,h.K)(e,t,this.view)}async doRefresh(){this.suspended||this.emit("data-changed")}};(0,a._)([(0,n.Cb)({readOnly:!0})],m.prototype,"imageFormatIsOpaque",null),(0,a._)([(0,n.Cb)({readOnly:!0})],m.prototype,"hasMixedImageFormats",null),(0,a._)([(0,n.Cb)()],m.prototype,"layer",void 0),(0,a._)([(0,n.Cb)({readOnly:!0,aliasOf:"layer.tileInfo"})],m.prototype,"tileInfo",void 0),(0,a._)([(0,n.Cb)({readOnly:!0})],m.prototype,"dataLevelRange",null),m=(0,a._)([(0,l.j)("esri.views.3d.layers.TileLayerView3D")],m);const d=m},13107:(e,t,r)=>{r.d(t,{y:()=>u});var a=r(27366),i=r(32718),s=r(66978),n=r(94172),l=r(49861),o=(r(63780),r(93169),r(25243),r(69912));const u=e=>{let t=class extends e{initialize(){this.handles.add((0,n.on)((()=>this.layer),"refresh",(e=>{this.doRefresh(e.dataChanged).catch((e=>{(0,s.D_)(e)||i.Z.getLogger(this.declaredClass).error(e)}))})),"RefreshableLayerView")}};return(0,a._)([(0,l.Cb)()],t.prototype,"layer",void 0),t=(0,a._)([(0,o.j)("esri.layers.mixins.RefreshableLayerView")],t),t}},83561:(e,t,r)=>{r.d(t,{D:()=>p});var a=r(27366),i=r(10064),s=r(92026),n=r(66978),l=r(49861),o=(r(63780),r(93169),r(25243),r(69912)),u=r(96669);const p=e=>{let t=class extends e{async fetchPopupFeatures(e,t){const{layer:r}=this;if(!e)return Promise.reject(new i.Z("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r}));if("tile"!==r.type)return Promise.reject(new i.Z("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:r.type}));const a=this.get("view.scale"),l=r.allSublayers.toArray().filter((e=>{const t=0===e.minScale||a<=e.minScale,r=0===e.maxScale||a>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&t&&r}));return(0,n.as)(l.map((async r=>{const a=r.createQuery(),i=(0,s.pC)(t)?t.event:null,n=(0,u.k)({renderer:r.renderer,event:i});return a.geometry=this.createFetchPopupFeaturesQueryGeometry(e,n),a.outFields=await r.popupTemplate.getRequiredFields(),(await r.queryFeatures(a)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return(0,a._)([(0,l.Cb)()],t.prototype,"layer",void 0),t=(0,a._)([(0,o.j)("esri.layers.mixins.TileLayerView")],t),t}},45008:(e,t,r)=>{r.d(t,{K:()=>n});r(59486);var a=r(92026),i=r(68860),s=r(53866);function n(e,t,r){let n,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s.Z;if("2d"===r.type)n=t*r.resolution;else if("3d"===r.type){const s=r.overlayPixelSizeInMapUnits(e),l=r.basemapSpatialReference;n=(0,a.pC)(l)&&!l.equals(r.spatialReference)?(0,i.c9)(l)/(0,i.c9)(r.spatialReference):t*s}const o=e.x-n,u=e.y-n,p=e.x+n,c=e.y+n,{spatialReference:f}=r;return l.xmin=Math.min(o,p),l.ymin=Math.min(u,c),l.xmax=Math.max(o,p),l.ymax=Math.max(u,c),l.spatialReference=f,l}new s.Z}}]);
//# sourceMappingURL=1819.7cf862ac.chunk.js.map