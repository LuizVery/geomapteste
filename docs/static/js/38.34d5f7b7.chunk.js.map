{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DGraphicLikeLayerView.js","../node_modules/@arcgis/core/layers/graphics/centroid.js","../node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3DStateSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectStateSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectStates.js","../node_modules/@arcgis/core/views/3d/layers/graphics/ExtentSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DElevationAlignment.js"],"names":["v","t","graphicsCore","elevationAlignment","b","watchUpdatingTracking","S","handles","r","suspendResumeExtent","e","scaleVisibilityEnabled","w","i","f","owner","layer","preferredUpdatePolicy","graphicSymbolSupported","scaleVisibility","this","a","add","layerMinMaxScaleChangeHandler","d","addPromise","elevationInfoChange","spatialIndex","queryGraphicUIDsInExtent","setup","view","elevationProvider","basemapTerrain","_set","j","objectStates","c","destroyed","watch","updateClippingExtent","setupSuspendResumeExtent","startCreateGraphics","o","destroy","suspended","updating","loadedGraphics","find","uid","u","g","whenGraphicBounds","Promise","reject","computeAttachmentOrigin","getSymbolLayerSize","acquireSet","set","handle","setUid","m","x","highlight","s","toArray","Array","isArray","length","map","setUids","setObjectIds","clippingArea","setClippingExtent","spatialReference","recreateAllGraphics","n","C","computedExtent","y","extentPadding","setExtent","h","updateSuspendResumeExtent","p","constructOnly","prototype","readOnly","aliasOf","l","remove","pause","resume","E","N","lengths","originPosition","coords","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","T","push","sort","I","Math","sqrt","items","type","objectStateId","object","renderGeometry","_removeObjectStateItem","splice","forEach","channel","removeHighlight","removeOcclude","removeRenderGeometryObjectState","stateType","objectIdField","objectStateSet","ids","Set","paused","graphic","attributes","has","_graphicsCore","_stateSets","removeAll","releaseSet","indexOf","addObjectStateSet","removeObjectState","graphics3DGraphics","get","_addObjectStateSet","initializeSet","hasGraphic","_removeObjectStateSet","states","_extents","allocator","_tmpExtent","_dirty","clear","contains","removeContained","pushNew","mergeTight","pop","hasProgressed","done","getItemAt","delete","madeProgress","some","filterInPlace","containsPoint","arguments","dirtyExtents","globalDirty","averageExtentUpdateSize","dirtyGraphicsSet","updateElevation","layerView","events","resourceController","scheduler","on","_elevationChanged","suspendedChange","registerTask","ELEVATION_ALIGNMENT","notifyChange","running","size","empty","markAllGraphicsElevationDirty","run","merge","_updateDirtyGraphics","_updateDirtyExtents","deconflictor","setDirty","renderCoordsHelper","effectiveUpdatePolicy","keys","getGraphics3DGraphicById","alignWithElevation","emit","extent","needsElevationUpdates","context","elevationInfo","mode","xmin","xmax","ymin","ymax"],"mappings":"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","file":"static/js/38.34d5f7b7.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Graphic.js\";import i from\"../../../../core/Accessor.js\";import s from\"../../../../core/Collection.js\";import r from\"../../../../core/Handles.js\";import{isSome as a,destroyMaybe as o,isNone as n}from\"../../../../core/maybe.js\";import{isAbortError as c}from\"../../../../core/promiseUtils.js\";import{init as h}from\"../../../../core/watchUtils.js\";import{property as p}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{diff as d}from\"../../../../core/accessorSupport/diffUtils.js\";import u from\"../../../../layers/Layer.js\";import{hydrateGraphic as g}from\"../../../../layers/graphics/hydratedFeatures.js\";import m from\"../../../../rest/support/Query.js\";import{SUSPEND_RESUME_EXTENT_OPTIMISM as y}from\"./constants.js\";import{Graphics3DCore as f}from\"./Graphics3DCore.js\";import b from\"./Graphics3DElevationAlignment.js\";import{Graphics3DObjectStates as j}from\"./Graphics3DObjectStates.js\";import w from\"./Graphics3DScaleVisibility.js\";import{enlargeExtent as C}from\"./graphicUtils.js\";import{WatchUpdatingTracking as S}from\"../../../support/WatchUpdatingTracking.js\";let v=class extends i{constructor(t){super(t),this.graphicsCore=null,this.elevationAlignment=new b,this.watchUpdatingTracking=new S,this.handles=new r,this.suspendResumeExtent=null}normalizeCtorArgs(t){let e=null;t.scaleVisibilityEnabled&&(delete(t={...t}).scaleVisibilityEnabled,e=new w);const i=new f({owner:t.owner,layer:t.layer,preferredUpdatePolicy:1,graphicSymbolSupported:!0});return{...t,graphicsCore:i,scaleVisibility:e}}initialize(){const t=this.scaleVisibility;a(t)&&\"minScale\"in this.layer&&this.watchUpdatingTracking.add(this.layer,\"scaleRangeId\",(()=>t.layerMinMaxScaleChangeHandler())),\"elevationInfo\"in this.layer&&this.watchUpdatingTracking.add(this.layer,\"elevationInfo\",((t,e)=>{d(t,e)&&this.watchUpdatingTracking.addPromise(this.graphicsCore.elevationInfoChange())}))}async setup(){const t=(t,e,i)=>this.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(t,e,i);if(this.elevationAlignment.setup(this.owner,t,this.graphicsCore,this.view.elevationProvider),a(this.scaleVisibility)&&\"minScale\"in this.layer){const e=this.owner.view.basemapTerrain;this.scaleVisibility.setup(this.owner,this.layer,t,this.graphicsCore,e)}this._set(\"objectStates\",new j(this.graphicsCore));try{await this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,objectStates:this.objectStates})}catch(e){if(c(e))return;throw e}this.destroyed||(this.handles.add(this.view.watch(\"clippingArea\",(()=>this.updateClippingExtent()),!0)),this.updateClippingExtent(),this.setupSuspendResumeExtent(),this.graphicsCore.startCreateGraphics())}destroy(){this.handles=o(this.handles),this.watchUpdatingTracking.destroy(),this._set(\"elevationAlignment\",o(this.elevationAlignment)),this._set(\"scaleVisibility\",o(this.scaleVisibility)),this._set(\"objectStates\",o(this.objectStates)),this._set(\"graphicsCore\",o(this.graphicsCore))}get suspended(){return!(!a(this.scaleVisibility)||!this.scaleVisibility.suspended)}get updating(){var t,e;return!!(null!=(t=this.graphicsCore)&&t.updating||a(this.scaleVisibility)&&this.scaleVisibility.updating||null!=(e=this.watchUpdatingTracking)&&e.updating)}getGraphicFromGraphicUid(t){if(this.owner.loadedGraphics){const e=this.owner.loadedGraphics.find((e=>e.uid===t));if(e){const t=this.layer instanceof u?this.layer:null;return g(e,t)}}}whenGraphicBounds(t,e){return this.graphicsCore?this.graphicsCore.whenGraphicBounds(t,e):Promise.reject()}computeAttachmentOrigin(t,e){return this.graphicsCore?this.graphicsCore.computeAttachmentOrigin(t,e):null}getSymbolLayerSize(t,e){return this.graphicsCore?this.graphicsCore.getSymbolLayerSize(t,e):null}maskOccludee(t){const{set:e,handle:i}=this.objectStates.acquireSet(1,null);return this.objectStates.setUid(e,t.uid),i}highlight(t){if(t instanceof m)return x;if(\"number\"==typeof t)return this.highlight([t]);if(t instanceof e)return this.highlight([t]);if(t instanceof s&&(t=t.toArray()),Array.isArray(t)&&t.length>0){if(t[0]instanceof e){const e=t.map((t=>t.uid)),{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setUids(i,e),s}if(\"number\"==typeof t[0]){const e=t,{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setObjectIds(i,e),s}}return x}updateClippingExtent(){const t=this.view.clippingArea;this.graphicsCore.setClippingExtent(t,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()}updateSuspendResumeExtent(){n(this.scaleVisibility)||(this.suspendResumeExtent=C(this.graphicsCore.computedExtent,this.suspendResumeExtent,y,this.graphicsCore.extentPadding),this.scaleVisibility.setExtent(this.suspendResumeExtent))}setupSuspendResumeExtent(){n(this.scaleVisibility)||(h(this.graphicsCore,\"computedExtent\",(t=>this.updateSuspendResumeExtent()),!0),this.graphicsCore.watch(\"extentPadding\",(t=>this.updateSuspendResumeExtent())))}};t([p({constructOnly:!0})],v.prototype,\"owner\",void 0),t([p({constructOnly:!0})],v.prototype,\"layer\",void 0),t([p({readOnly:!0,aliasOf:\"owner.view\"})],v.prototype,\"view\",void 0),t([p({constructOnly:!0})],v.prototype,\"graphicsCore\",void 0),t([p({constructOnly:!0})],v.prototype,\"scaleVisibility\",void 0),t([p({readOnly:!0})],v.prototype,\"elevationAlignment\",void 0),t([p({readOnly:!0})],v.prototype,\"objectStates\",void 0),t([p({readOnly:!0})],v.prototype,\"watchUpdatingTracking\",void 0),t([p({readOnly:!0})],v.prototype,\"suspended\",null),t([p({readOnly:!0})],v.prototype,\"updating\",null),v=t([l(\"esri.views.3d.layers.graphics.Graphics3DGraphicLikeLayerView\")],v);const x={remove(){},pause(){},resume(){}};var E=v;export{E as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../core/maybe.js\";function n(t,n){return t?n?4:3:n?3:2}function e(e,o,u,l,N){if(t(o)||!o.lengths.length)return null;const s=\"upperLeft\"===(null==N?void 0:N.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,f=[],i=u?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:T,coords:h}=o,g=n(u,l);let E=0;for(const t of T){const n=r(i,h,E,t,u,l,s);n&&f.push(n),E+=t*g}if(f.sort(((t,n)=>{let e=s*t[2]-s*n[2];return 0===e&&u&&(e=t[4]-n[4]),e})),f.length){let t=6*f[0][2];c[0]=f[0][0]/t,c[1]=f[0][1]/t,u&&(t=6*f[0][4],c[2]=0!==t?f[0][3]/t:0),(c[0]<i[0]||c[0]>i[1]||c[1]<i[2]||c[1]>i[3]||u&&(c[2]<i[4]||c[2]>i[5]))&&(c.length=0)}if(!c.length){const t=o.lengths[0]?I(h,0,T[0],u,l):null;if(!t)return null;c[0]=t[0],c[1]=t[1],u&&t.length>2&&(c[2]=t[2])}return e}function r(t,e,r,I,o,u,l=1){const N=n(o,u);let s=r,c=r+N,f=0,i=0,T=0,h=0,g=0;for(let n=0,m=I-1;n<m;n++,s+=N,c+=N){const n=e[s],r=e[s+1],I=e[s+2],u=e[c],l=e[c+1],N=e[c+2];let E=n*l-u*r;h+=E,f+=(n+u)*E,i+=(r+l)*E,o&&(E=n*N-u*I,T+=(I+N)*E,g+=E),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),o&&(I<t[4]&&(t[4]=I),I>t[5]&&(t[5]=I))}if(h*l>0&&(h*=-1),g*l>0&&(g*=-1),!h)return null;const E=[f,i,.5*h];return o&&(E[3]=T,E[4]=.5*g),E}function I(t,e,r,I,s){const c=n(I,s);let f=e,i=e+c,T=0,h=0,g=0,E=0;for(let n=0,m=r-1;n<m;n++,f+=c,i+=c){const n=t[f],e=t[f+1],r=t[f+2],s=t[i],c=t[i+1],m=t[i+2],b=I?u(n,e,r,s,c,m):o(n,e,s,c);if(b)if(T+=b,I){const t=N(n,e,r,s,c,m);h+=b*t[0],g+=b*t[1],E+=b*t[2]}else{const t=l(n,e,s,c);h+=b*t[0],g+=b*t[1]}}return T>0?I?[h/T,g/T,E/T]:[h/T,g/T]:r>0?I?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function o(t,n,e,r){const I=e-t,o=r-n;return Math.sqrt(I*I+o*o)}function u(t,n,e,r,I,o){const u=r-t,l=I-n,N=o-e;return Math.sqrt(u*u+l*l+N*N)}function l(t,n,e,r){return[t+.5*(e-t),n+.5*(r-n)]}function N(t,n,e,r,I,o){return[t+.5*(r-t),n+.5*(I-n),e+.5*(o-e)]}export{e as getCentroidOptimizedGeometry,I as lineCentroid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nclass e{constructor(){this.items=[]}addObject(e,t){this.items.push({type:0,objectStateId:t,object:e})}addRenderGeometry(e,t,s){this.items.push({type:1,objectStateId:t,renderGeometry:e,owner:s})}addExternal(e,t){this.items.push({type:2,objectStateId:t,remove:e})}remove(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];s.objectStateId===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeObject(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];0===s.type&&s.object===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeRenderGeometry(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];1===s.type&&s.renderGeometry===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeAll(){this.items.forEach((e=>{this._removeObjectStateItem(e)})),this.items=[]}_removeObjectStateItem(e){switch(e.type){case 0:0===e.objectStateId.channel?e.object.removeHighlight(e.objectStateId):1===e.objectStateId.channel&&e.object.removeOcclude(e.objectStateId);break;case 1:e.owner.removeRenderGeometryObjectState(e.renderGeometry,e.objectStateId);break;case 2:e.remove(e.objectStateId)}}}export{e as Object3DStateSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{Object3DStateSet as t}from\"../../webgl-engine/lib/Object3DStateSet.js\";class e{constructor(e,i){this.stateType=e,this.objectIdField=i,this.objectStateSet=new t,this.ids=new Set,this.paused=!1}hasGraphic(t){if(this.objectIdField){const e=t.graphic.attributes[this.objectIdField];return this.ids.has(e)}return this.ids.has(t.graphic.uid)}}export{e as Graphics3DObjectStateSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{makeHandle as t}from\"../../../../core/handleUtils.js\";import{Graphics3DObjectStateSet as e}from\"./Graphics3DObjectStateSet.js\";class s{constructor(t){this._graphicsCore=t,this._stateSets=new Array}destroy(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll())),this._stateSets=null}acquireSet(s,a){const i=new e(s,a);this._stateSets.push(i);const h=t((()=>this.releaseSet(i)));return{set:i,handle:h}}releaseSet(t){t.objectStateSet.removeAll();const e=this._stateSets?this._stateSets.indexOf(t):-1;-1!==e&&this._stateSets.splice(e,1)}_addObjectStateSet(t,e){t.addObjectStateSet(e.stateType,e.objectStateSet)}_removeObjectStateSet(t,e){t.removeObjectState(e.objectStateSet)}setUid(t,e){t.ids.add(e);const s=this._graphicsCore.graphics3DGraphics.get(e);s&&this._addObjectStateSet(s,t)}setUids(t,e){e.forEach((e=>this.setUid(t,e)))}setObjectIds(t,e){e.forEach((e=>t.ids.add(e))),this.initializeSet(t)}addGraphic(t){this._stateSets.forEach((e=>{!e.paused&&e.hasGraphic(t)&&this._addObjectStateSet(t,e)}))}removeGraphic(t){this._stateSets.forEach((e=>{e.hasGraphic(t)&&this._removeObjectStateSet(t,e)}))}allGraphicsDeleted(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll()))}initializeSet(t){const e=this._graphicsCore.graphics3DGraphics;t.objectIdField?e.forEach((e=>{e&&t.hasGraphic(e)&&this._addObjectStateSet(e,t)})):t.ids.forEach((s=>{const a=e.get(s);a&&this._addObjectStateSet(a,t)}))}get test(){return{states:this._stateSets}}}export{s as Graphics3DObjectStates};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/PooledArray.js\";import{create as e,copy as r,area as s,expand as n,contains as o,containsPoint as i}from\"../../../../geometry/support/aaBoundingRect.js\";import{noBudget as h}from\"../../../support/Scheduler.js\";const a=.05;class c{constructor(){this._extents=new t({allocator:t=>t||e()}),this._tmpExtent=e(),this._dirty=!1}get empty(){return 0===this._extents.length}get size(){return this._extents.length}clear(){this._extents.clear()}add(t){this.contains(t)||(this.removeContained(t),r(this._extents.pushNew(),t),this._dirty=!0)}pop(){return this._dirty&&this.mergeTight(),this._extents.pop()}merge(t){return this.mergeTight(t),t.hasProgressed}mergeTight(t=h){const e=this._extents,o=new Set;let i=0;for(;i!==e.length;){e.sort(((t,e)=>t[0]-e[0])),i=e.length,o.clear();for(let i=0;i<e.length;++i){if(t.done)return;const h=e.getItemAt(i);for(let t=i+1;t<e.length;++t){const r=e.getItemAt(t);if(r[0]>=h[2])break;o.add(r)}o.forEach((i=>{if(h===i)return;if(i[2]<=h[0])return void o.delete(i);const c=s(h),g=s(i),m=this._tmpExtent;n(h,i,m);const d=c+g;(s(m)-d)/d<a&&(r(h,m),o.delete(i),e.remove(i),t.madeProgress())})),o.add(h)}}this._dirty=!1}contains(t){return this._extents.some((e=>o(e,t)))}removeContained(t){this._extents.filterInPlace((e=>!o(t,e)))}get test(){const t=this;return{containsPoint:e=>t._extents.some((t=>i(t,e)))}}}export{c as ExtentSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import i from\"../../../../core/Evented.js\";import s from\"../../../../core/Handles.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{ExtentSet as h}from\"./ExtentSet.js\";import{TaskPriority as o}from\"../../../support/Scheduler.js\";let p=class extends t{constructor(){super(...arguments),this.dirtyExtents=new h,this.globalDirty=!1,this.averageExtentUpdateSize=0,this.dirtyGraphicsSet=new Set,this.handles=new s,this.updateElevation=!1,this.layerView=null,this.graphicsCore=null,this.events=new i}setup(e,t,i,s){this.layerView=e,this.queryGraphicUIDsInExtent=t,this.graphicsCore=i,this.elevationProvider=s;const r=this.layerView.view.resourceController.scheduler;this.handles.add([s.on(\"elevation-change\",(e=>this._elevationChanged(e))),this.layerView.watch(\"suspended\",(()=>this.suspendedChange())),r.registerTask(o.ELEVATION_ALIGNMENT,this)])}destroy(){this.dirtyGraphicsSet.clear(),this.handles.destroy(),this.handles=null,this.layerView=null,this.graphicsCore=null,this.queryGraphicUIDsInExtent=null}clear(){this.dirtyGraphicsSet.clear(),this.notifyChange(\"updating\")}suspendedChange(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&(this.globalDirty=!0,this.notifyChange(\"updating\"))}elevationInfoChange(){this.globalDirty=!0,this.notifyChange(\"updating\")}get updating(){return this.running}get running(){return this.dirtyGraphicsSet.size>0||this.dirtyExtents&&!this.dirtyExtents.empty||this.globalDirty}get updatingRemaining(){return this.dirtyGraphicsSet.size+this.dirtyExtents.size*this.averageExtentUpdateSize}runTask(e){for(this.globalDirty&&(this.markAllGraphicsElevationDirty(),this.globalDirty=!1,e.madeProgress()),e.run((()=>this.dirtyExtents.merge(e)));this.running&&!e.done;)this._updateDirtyGraphics(e),this._updateDirtyExtents(e);this.layerView.view.deconflictor.setDirty(),this.notifyChange(\"updating\")}_updateDirtyGraphics(e){const t=this.layerView.view.renderCoordsHelper,i=0===this.graphicsCore.effectiveUpdatePolicy;for(const s of this.dirtyGraphicsSet.keys()){const a=this.graphicsCore.getGraphics3DGraphicById(s);if(this.dirtyGraphicsSet.delete(s),r(a)&&(a.alignWithElevation(this.elevationProvider,t,i),e.madeProgress()),e.done)return}}_updateDirtyExtents(e){for(;!this.dirtyExtents.empty&&!e.done;){const t=this.dirtyExtents.pop(),i=this.elevationProvider.spatialReference;this.events.emit(\"invalidate-elevation\",{extent:t,spatialReference:i});const s=this.dirtyGraphicsSet.size;this.queryGraphicUIDsInExtent(t,i,(e=>{const t=this.graphicsCore.getGraphics3DGraphicById(e);r(t)&&t.needsElevationUpdates()&&this.dirtyGraphicsSet.add(e)})),this.averageExtentUpdateSize=.1*(this.dirtyGraphicsSet.size-s)+.9*this.averageExtentUpdateSize,e.madeProgress()}}markAllGraphicsElevationDirty(){this.dirtyExtents.clear(),this.dirtyGraphicsSet.clear(),this.graphicsCore.graphics3DGraphics.forEach(((e,t)=>this.dirtyGraphicsSet.add(t)))}_elevationChanged(e){if(\"scene\"===e.context&&(!this.graphicsCore.layer.elevationInfo||\"relative-to-scene\"!==this.graphicsCore.layer.elevationInfo.mode))return;const{extent:t,spatialReference:i}=e;if(this.layerView.suspended){if(!this.updateElevation){const e=this.graphicsCore.computedExtent;e&&t[2]>e.xmin&&t[0]<e.xmax&&t[3]>e.ymin&&t[1]<e.ymax&&(this.updateElevation=!0)}this.events.emit(\"invalidate-elevation\",{extent:t,spatialReference:i})}else t[0]===-1/0?this.globalDirty=!0:this.dirtyExtents.add(t),this.notifyChange(\"updating\")}};e([a({readOnly:!0})],p.prototype,\"updating\",null),e([a({readOnly:!0})],p.prototype,\"updatingRemaining\",null),p=e([n(\"esri.views.3d.layers.graphics.Graphics3DElevationAlignment\")],p);var d=p;export{d as default};\n"],"sourceRoot":""}