(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[113],{1058:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a(3),i=a(4),n=a(6),s=a(7),o=a(0),u=a(32),c=a(185),l=a(1),h=(a(17),a(18),a(16),a(9)),p={visible:"visibleSublayers"},y=function(e){Object(n.a)(a,e);var t=Object(s.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).scale=0,i}return Object(i.a)(a,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(p[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join(",")}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,a=null==e?void 0:e.sublayers,r=[];return null==a||a.forEach((function e(a){var i=a.minScale,n=a.maxScale,s=a.sublayers;a.visible&&(0===t||(0===i||t<=i)&&(0===n||t>=n))&&(s?s.forEach(e):r.unshift(a))})),r}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency,version:e.version,layers:t}}}]),a}(Object(c.b)(u.a));Object(o.a)([Object(l.b)()],y.prototype,"layer",null),Object(o.a)([Object(l.b)({readOnly:!0})],y.prototype,"layers",null),Object(o.a)([Object(l.b)({type:Number})],y.prototype,"scale",void 0),Object(o.a)([Object(l.b)({readOnly:!0})],y.prototype,"version",null),Object(o.a)([Object(l.b)({readOnly:!0})],y.prototype,"visibleSublayers",null),y=Object(o.a)([Object(h.a)("esri.layers.support.ExportWMSImageParameters")],y)},1121:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a(3),i=a(4),n=a(6),s=a(7),o=a(0),u=a(20),c=a(1),l=(a(17),a(18),a(16),a(9)),h=a(200),p=a(1058),y=function(e){var t=function(e){Object(n.a)(a,e);var t=Object(s.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"initialize",value:function(){this.exportImageParameters=new p.a({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"exportImageVersion",get:function(){var e;return null==(e=this.exportImageParameters)||e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(e){var t=this.layer;if(!e)return Promise.reject(new u.a("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var a=t.popupEnabled;if(!a)return Promise.reject(new u.a("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:a}));var r=this.createFetchPopupFeaturesQuery(e);if(!r)return Promise.resolve([]);var i=r.extent,n=r.width,s=r.height,o=r.x,c=r.y;if(!(i&&n&&s))throw new u.a("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:i,width:n,height:s});var l=t.fetchFeatureInfo(i,n,s,o,c);return Promise.resolve(l?[l]:[])}}]),a}(e);return Object(o.a)([Object(c.b)()],t.prototype,"exportImageParameters",void 0),Object(o.a)([Object(c.b)({readOnly:!0})],t.prototype,"exportImageVersion",null),Object(o.a)([Object(c.b)()],t.prototype,"layer",void 0),Object(o.a)([Object(c.b)(h.a)],t.prototype,"timeExtent",void 0),t=Object(o.a)([Object(l.a)("esri.layers.mixins.WMSLayerView")],t)}},1288:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return S}));var r=a(14),i=a(8),n=a.n(i),s=a(15),o=a(3),u=a(4),c=a(6),l=a(7),h=a(0),p=a(20),y=a(16),b=a(23),m=a(1),v=(a(17),a(18),a(9)),f=a(61),d=a(996),g=a(897),O=a(1042),j=a(686),w=a(908),x=a(1121),k=y.a.getLogger("esri.views.2d.layers.WMSLayerView2D"),P=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"initialize",value:function(){var e=this.layer,t=this.view;e.supportsSpatialReference(t.spatialReference)||this.addResolvingPromise(Promise.reject(new p.a("layerview:spatial-reference-incompatible","The spatial references supported by this WMS layer are incompatible with the spatial reference of the view",{layer:e})))}},{key:"hitTest",value:function(){return null}},{key:"update",value:function(e){this.strategy.update(e).catch((function(e){Object(b.n)(e)||k.error(e)}))}},{key:"attach",value:function(){var e=this,t=this.layer,a=t.imageMaxHeight,r=t.imageMaxWidth;this._bitmapContainer=new d.a,this.container.addChild(this._bitmapContainer),this.strategy=new O.a({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:a,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add(this.watch("exportImageVersion",(function(){return e.requestUpdate()})),"exportImageVersion")}},{key:"detach",value:function(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"createFetchPopupFeaturesQuery",value:function(e){var t=this.view,a=this._bitmapContainer,r=e.x,i=e.y,n=t.spatialReference,s=null,o=0,u=0;if(a.children.some((function(e){var t=e.width,a=e.height,c=e.resolution,l=e.x,h=e.y,p=l+c*t,y=h-c*a;return r>=l&&r<=p&&i<=h&&i>=y&&(s=new f.a({xmin:l,ymin:y,xmax:p,ymax:h,spatialReference:n}),o=t,u=a,!0)})),!s)return null;var c=s.width/o,l=Math.round((r-s.xmin)/c),h=Math.round((s.ymax-i)/c);return{extent:s,width:o,height:u,x:l,y:h}}},{key:"doRefresh",value:function(){var e=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(e,t,a,i){return this.layer.fetchImage(e,t,a,Object(r.a)({timeExtent:this.timeExtent},i))}}]),a}(Object(x.a)(Object(w.a)(Object(g.a)(j.a))));Object(h.a)([Object(m.b)()],P.prototype,"strategy",void 0),Object(h.a)([Object(m.b)()],P.prototype,"updating",void 0);var S=P=Object(h.a)([Object(v.a)("esri.views.2d.layers.WMSLayerView2D")],P)}}]);
//# sourceMappingURL=113.e128d87a.chunk.js.map