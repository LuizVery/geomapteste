{"version":3,"file":"static/js/56.fed80d8d.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/2d/layers/BitmapTileLayerView2D.js","../node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js","../node_modules/@arcgis/core/views/2d/layers/support/imageUtils.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/layers/TileLayerView.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/set.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{BitmapTileContainer as t}from\"../engine/BitmapTileContainer.js\";const r=r=>{let s=class extends r{attach(){this.view.timeline.record(`${this.layer.title} (BitmapTileLayer) Attach`),this._bitmapView=new t(this._tileInfoView),this.container.addChild(this._bitmapView)}detach(){var e;this.container.removeChild(this._bitmapView),null==(e=this._bitmapView)||e.removeAllChildren()}};return s=e([i(\"esri.views.2d.layers.BitmapTileLayerView2D\")],s),s};export{r as BitmapTileLayerView2D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{equals as a}from\"../../../geometry/support/spatialReferenceUtils.js\";import{BitmapTileLayerView2D as o}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as h}from\"./LayerView2D.js\";import{createBlankImage as n,resampleImage as c}from\"./support/imageUtils.js\";import u from\"../tiling/TileInfoView.js\";import p from\"../tiling/TileKey.js\";import f from\"../tiling/TileQueue.js\";import m from\"../tiling/TileStrategy.js\";import y from\"../../layers/LayerView.js\";import{RefreshableLayerView as d}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as g}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as w}from\"../../support/drapedUtils.js\";const _=[0,0];let I=class extends(g(d(o(h(y))))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this.layer=null}get resampling(){return!(\"resampling\"in this.layer)||!1!==this.layer.resampling}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume()}attach(){const e=\"tileServers\"in this.layer?this.layer.tileServers:null;this._tileInfoView=new u(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new f({tileInfoView:this._tileInfoView,concurrency:e&&10*e.length||10,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new m({cachePolicy:\"keep\",resampling:this.resampling,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.requestUpdate(),this.handles.add(s((()=>this.resampling),(()=>{this.doRefresh()}))),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}supportsSpatialReference(e){var t;return a(null==(t=this.layer.tileInfo)?void 0:t.spatialReference,e)}createFetchPopupFeaturesQueryGeometry(e,t){return w(e,t,this.view)}async doRefresh(){this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>this._enqueueTileFetch(e))))}isUpdating(){var e,t;return null!=(e=null==(t=this._fetchQueue)?void 0:t.updating)&&e}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(_,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e,t={}){const s=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:r,resamplingLevel:l=0}=t;if(!s)try{return await this._fetchImage(e,r)}catch(h){if(!i(h)&&!this.resampling)return n(this._tileInfoView.tileInfo.size);if(l<3){const i=this._tileInfoView.getTileParentId(e.id);if(i){const s=new p(i),r=await this.fetchTile(s,{...t,resamplingLevel:l+1});return c(this._tileInfoView,r,s,e)}}throw h}const a=new p(0,0,0,0);let o;try{if(await s.fetchAvailabilityUpsample(e.level,e.row,e.col,a,{signal:r}),a.level!==e.level&&!this.resampling)return n(this._tileInfoView.tileInfo.size);o=await this._fetchImage(a,r)}catch(h){if(i(h))throw h;o=await this._fetchImage(e,r)}return this.resampling?c(this._tileInfoView,o,a,e):o}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(s){i(s)||t.getLogger(this.declaredClass).error(s)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchTile(e.level,e.row,e.col,{signal:t})}};e([r()],I.prototype,\"_fetchQueue\",void 0),e([r()],I.prototype,\"resampling\",null),I=e([l(\"esri.views.2d.layers.TileLayerView2D\")],I);const V=I;export{V as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction e(e){return e instanceof HTMLImageElement?e.naturalWidth:e.width}function t(e){return e instanceof HTMLImageElement?e.naturalHeight:e.height}function n(n,l,r,u){if(r.level===u.level)return l;const i=n.tileInfo.size,a=n.getTileResolution(r.level),c=n.getTileResolution(u.level);let g=n.getLODInfoAt(u.level);const h=g.getXForColumn(u.col),d=g.getYForRow(u.row);g=n.getLODInfoAt(r.level);const f=g.getXForColumn(r.col),s=g.getYForRow(r.row),m=e(l)/i[0],v=t(l)/i[1],w=Math.round(m*((h-f)/a)),I=Math.round(v*(-(d-s)/a)),M=Math.round(m*i[0]*(c/a)),F=Math.round(v*i[1]*(c/a)),L=o(i);return L.getContext(\"2d\").drawImage(l,w,I,M,F,0,0,i[0],i[1]),L}function o(e){const t=document.createElement(\"canvas\");return[t.width,t.height]=e,t}export{o as createBlankImage,n as resampleImage};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"names":["t","e","xoffset","Math","max","abs","yoffset","n","stops","length","r","s","size","filter","type","map","maxSize","minSize","o","f","floor","renderer","event","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","attach","this","view","timeline","record","layer","title","_bitmapView","_tileInfoView","container","addChild","detach","removeChild","removeAllChildren","i","_","I","g","d","h","y","constructor","super","arguments","_tileStrategy","_fetchQueue","resampling","update","pause","state","resume","tileServers","u","tileInfo","fullExtent","tileInfoView","concurrency","process","fetchTile","m","cachePolicy","acquireTile","releaseTile","requestUpdate","handles","add","doRefresh","destroy","clear","moveStart","viewChange","moveEnd","supportsSpatialReference","a","spatialReference","createFetchPopupFeaturesQueryGeometry","w","updateRequested","suspended","reset","tiles","_enqueueTileFetch","isUpdating","updating","createTile","bitmap","x","getTileCoords","key","resolution","getTileResolution","width","height","abort","id","once","tilemapCache","signal","resamplingLevel","l","_fetchImage","getTileParentId","p","c","fetchAvailabilityUpsample","level","row","col","has","push","source","declaredClass","error","prototype","V","getLODInfoAt","getXForColumn","getYForRow","HTMLImageElement","naturalWidth","v","naturalHeight","round","M","F","L","getContext","drawImage","document","createElement","initialize","dataChanged","catch","Promise","reject","get","allSublayers","toArray","minScale","maxScale","popupTemplate","popupEnabled","visible","async","createQuery","geometry","outFields","getRequiredFields","queryFeatures","features","then","concat","value","Boolean","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","xmin","min","ymin","xmax","ymax"],"sourceRoot":""}