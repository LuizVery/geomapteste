"use strict";(globalThis.webpackChunkgeowebmap=globalThis.webpackChunkgeowebmap||[]).push([[2923],{62923:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var r=s(27366),i=s(52639),n=s(40110),o=s(77178),a=s(92026),l=s(94172),h=s(49861),d=(s(63780),s(93169),s(25243),s(69912)),u=s(26279),c=s(42069),p=s(79510),y=s(61712),m=s(5198),g=s(68401),v=s(67581);let f=class extends((0,c.A)(v.Z)){constructor(){super(...arguments),this.type="route-3d",this.loadedGraphics=new m.g,this._byObjectID=new Map,this.slicePlaneEnabled=!1,this.drapeSourceType=u.Lw.Features,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("processor",new p.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.setup()),this.updatingHandles.addOnCollectionChange((()=>this._routeItems),(e=>this._routeItemsChanged(e))),this.addResolvingPromise((0,y.E)(this).then((e=>this.fullExtentInLocalViewSpatialReference=e))),this.handles.add((0,l.gx)((()=>{var e,t;return null==(e=this.view)||null==(t=e.basemapTerrain)?void 0:t.ready}),(()=>()=>this.notifyChange("updating")),{once:!0}))}destroy(){this.handles.removeAll(),this.updatingHandles.removeAll(),this._set("processor",(0,a.SC)(this.processor))}get _routeItems(){return new o.Z({getCollections:()=>[this.layer.pointBarriers,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.stops,this.layer.directionLines,this.layer.directionPoints,(0,a.pC)(this.layer.routeInfo)?new n.Z([this.layer.routeInfo]):null]})}_routeItemsChanged(e){e.removed.length&&this.loadedGraphics.removeMany(e.removed.map((e=>{const t=this._byObjectID.get(e);return this._byObjectID.delete(e),t}))),this.loadedGraphics.addMany(e.added.map((e=>{const t=i.Z.fromJSON(e.toPortalJSON());return this._byObjectID.set(e,t),t})))}get legendEnabled(){var e;return this.canResume()&&!(null!=(e=this.processor)&&e.frustumVisibilitySuspended)}getSuspendInfo(){var e,t,s,r;const i=super.getSuspendInfo();return i.outsideScaleRange=null!=(e=null==(t=this.processor)?void 0:t.scaleVisibilitySuspended)&&e,i.outsideOfView=null!=(s=null==(r=this.processor)?void 0:r.frustumVisibilitySuspended)&&s,i}async fetchPopupFeatures(e,t){return(0,a.pC)(t)?t.clientGraphics:null}getGraphicFromGraphicUid(e){return this.processor.getGraphicFromGraphicUid(e)}whenGraphicBounds(e,t){return this.processor.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){var s;return null==(s=this.processor)?void 0:s.computeAttachmentOrigin(e,t)}getSymbolLayerSize(e,t){return this.processor.getSymbolLayerSize(e,t)}async queryGraphics(){return new n.Z(this.loadedGraphics.toArray())}maskOccludee(e){return this.processor.maskOccludee(e)}highlight(e){return this.processor.highlight(e)}get updatePolicy(){var e;return(null==(e=this.processor)?void 0:e.graphicsCore.effectiveUpdatePolicy)||g.jq.SYNC}canResume(){var e;return super.canResume()&&!(null!=(e=this.processor)&&e.scaleVisibilitySuspended)}isUpdating(){var e,t,s;return!(!(null!=(e=this.processor)&&e.updating||null==(t=this.view)||null==(s=t.basemapTerrain))&&s.ready)}get performanceInfo(){var e,t,s;return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:null!=(e=null==(t=this.processor)?void 0:t.elevationAlignment.updating)&&e,visibilityFrustum:!(null!=(s=this.processor)&&s.frustumVisibilitySuspended)}}};(0,r._)([(0,h.Cb)()],f.prototype,"_routeItems",null),(0,r._)([(0,h.Cb)()],f.prototype,"loadedGraphics",void 0),(0,r._)([(0,h.Cb)({readOnly:!0})],f.prototype,"legendEnabled",null),(0,r._)([(0,h.Cb)()],f.prototype,"layer",void 0),(0,r._)([(0,h.Cb)({readOnly:!0})],f.prototype,"processor",void 0),(0,r._)([(0,h.Cb)({type:Boolean})],f.prototype,"slicePlaneEnabled",void 0),f=(0,r._)([(0,d.j)("esri.views.3d.layers.RouteLayerView3D")],f);const b=f},61712:(e,t,s)=>{s.d(t,{E:()=>o});var r=s(92026),i=s(81753),n=s(67387);function o(e){const t=e.view.spatialReference,s=e.layer.fullExtent,o=(0,r.pC)(s)&&s.spatialReference;if((0,r.Wi)(s)||!o)return Promise.resolve(null);if(o.equals(t))return Promise.resolve(s.clone());const a=(0,i.iV)(s,t);return(0,r.pC)(a)?Promise.resolve(a):e.view.state.isLocal?(0,n.projectGeometry)(s,t,e.layer.portalItem).then((t=>!e.destroyed&&t?t:void 0)).catch((()=>null)):Promise.resolve(null)}},5198:(e,t,s)=>{s.d(t,{g:()=>o});var r=s(91505),i=s(62314),n=s(92377);class o extends r.Z{constructor(){super(...arguments),this._set=new Set}clear(){if(this._set.size>0){const e=this.toArray();this._set.clear(),this.emit("after-changes",{type:i.y.REMOVE}),this.emit("change",{added:[],removed:e})}}get length(){return this._set.size}addMany(e){if(0!==e.length){for(const t of e)this._set.add(t);this.emit("after-changes",{type:i.y.ADD}),this.emit("change",{added:e,removed:[]})}}remove(e){this._set.delete(e)&&(this.emit("after-changes",{type:i.y.REMOVE}),this.emit("change",{added:[],removed:[e]}))}removeMany(e){const t=[];for(const s of e)this._set.delete(s)&&t.push(s);t.length>0&&(this.emit("after-changes",{type:i.y.REMOVE}),this.emit("change",{added:[],removed:t}))}toArray(){return[...this._set]}find(e){let t;return(0,n.f)(this._set,(s=>!!e(s)&&(t=s,!0))),t}forEach(e){this._set.forEach((t=>e(t)))}}}}]);
//# sourceMappingURL=2923.b9475aa8.chunk.js.map