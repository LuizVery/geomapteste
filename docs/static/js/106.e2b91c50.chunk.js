(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[106],{1113:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var a=i(3),n=i(4),r=i(6),s=i(7),c=i(0),u=(i(1),i(17),i(18),i(16),i(9)),o=i(1163),l=function(e){var t=function(e){Object(r.a)(i,e);var t=Object(s.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(n.a)(i,[{key:"attach",value:function(){this.view.timeline.record("".concat(this.layer.title," (BitmapTileLayer) Attach")),this._bitmapView=new o.a(this._tileInfoView),this.container.addChild(this._bitmapView)}},{key:"detach",value:function(){this.container.removeChild(this._bitmapView),this._bitmapView.removeAllChildren()}}]),i}(e);return t=Object(c.a)([Object(u.a)("esri.views.2d.layers.BitmapTileLayerView2D")],t)}},1289:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return S}));var a=i(31),n=i(8),r=i.n(n),s=i(15),c=i(3),u=i(4),o=i(47),l=i(44),h=i(6),p=i(7),d=i(0),b=i(55),f=i(23),y=i(1),v=(i(17),i(18),i(16),i(9)),j=i(1113),O=i(897),w=i(697),g=i(825),m=i(826),_=i(686),k=i(908),R=[102113,102100,3857,3785,900913],q=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(){var e;return Object(c.a)(this,i),(e=t.apply(this,arguments))._handles=new b.a,e._tileStrategy=null,e._fetchQueue=null,e._tileRequests=new Map,e.layer=null,e}return Object(u.a)(i,[{key:"tileMatrixSet",get:function(){if(this.layer.activeLayer.tileMatrixSetId)return this.layer.activeLayer.tileMatrixSet;var e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(this.layer.activeLayer.tileMatrixSetId=e.id,e):null}},{key:"hitTest",value:function(){return null}},{key:"update",value:function(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange("updating")}},{key:"attach",value:function(){var e=this;if(this.tileMatrixSet){var t=this.tileMatrixSet.tileInfo;this._tileInfoView=new w.a(t),this._fetchQueue=new g.a({tileInfoView:this._tileInfoView,process:function(t){return e.fetchTile(t)}}),this._tileStrategy=new m.a({cachePolicy:"keep",acquireTile:function(t){return e.acquireTile(t)},releaseTile:function(t){return e.releaseTile(t)},tileInfoView:this._tileInfoView}),this._handles.add(this.watch(["layer.activeLayer.styleId","tileMatrixSet"],(function(){return e._refresh()}))),Object(o.a)(Object(l.a)(i.prototype),"attach",this).call(this)}}},{key:"detach",value:function(){Object(o.a)(Object(l.a)(i.prototype),"detach",this).call(this),this._handles.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}},{key:"moveStart",value:function(){this.requestUpdate()}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"doRefresh",value:function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateRequested||this.suspended||this._refresh();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this._fetchQueue.length>0}},{key:"acquireTile",value:function(e){var t,i,n,r,s=this,c=this._bitmapView.createTile(e),u=c.bitmap;t=this._tileInfoView.getTileCoords([0,0],c.key),i=Object(a.a)(t,2),u.x=i[0],u.y=i[1],u.resolution=this._tileInfoView.getTileResolution(c.key),n=this._tileInfoView.tileInfo.size,r=Object(a.a)(n,2),u.width=r[0],u.height=r[1],this._tileInfoView.getTileCoords(u,c.key);var o={id:e.id,fulfilled:!1,promise:this._fetchQueue.push(c.key).then((function(e){c.bitmap.source=e,c.once("attach",(function(){return s.requestUpdate()})),s._bitmapView.addChild(c)})).catch((function(e){Object(f.n)(e)||(c.bitmap.source=null,c.once("attach",(function(){return s.requestUpdate()})),s._bitmapView.addChild(c))}))};return o.promise.finally((function(){return o.fulfilled=!0})),this._tileRequests.set(c,o),this.requestUpdate(),c}},{key:"releaseTile",value:function(e){var t=this._tileRequests.get(e);t.fulfilled||this._fetchQueue.abort(t.id),this._tileRequests.delete(e),this._bitmapView.removeChild(e),e.once("detach",(function(){return e.destroy()})),this.requestUpdate()}},{key:"fetchTile",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.layer.fetchTile(t.level,t.row,t.col));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e=Object(o.a)(Object(l.a)(i.prototype),"canResume",this).call(this);return e?null!==this.tileMatrixSet:e}},{key:"_refresh",value:function(){var e=this;this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((function(t){if(t.bitmap.source){var i={id:t.key.id,fulfilled:!1,promise:e._fetchQueue.push(t.key).then((function(e){t.bitmap.source=e})).catch((function(e){Object(f.n)(e)||(t.bitmap.source=null)})).finally((function(){t.requestRender(),e.notifyChange("updating"),i.fulfilled=!0}))};e._tileRequests.set(t,i)}})),this.notifyChange("updating")}},{key:"_getTileMatrixSetBySpatialReference",value:function(e){var t=this.view.spatialReference;if(!e.tileMatrixSets)return null;var i=e.tileMatrixSets.find((function(e){return e.tileInfo.spatialReference.wkid===t.wkid}));return!i&&t.isWebMercator&&(i=e.tileMatrixSets.find((function(e){return R.indexOf(e.tileInfo.spatialReference.wkid)>-1}))),i}}]),i}(Object(k.a)(Object(j.a)(Object(O.a)(_.a))));Object(d.a)([Object(y.b)()],q.prototype,"suspended",void 0),Object(d.a)([Object(y.b)({readOnly:!0})],q.prototype,"tileMatrixSet",null);var S=q=Object(d.a)([Object(v.a)("esri.views.2d.layers.WMTSLayerView2D")],q)},897:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var a,n=i(3),r=i(4),s=i(47),c=i(44),u=i(6),o=i(7),l=i(0),h=i(49),p=i(186),d=i(27),b=i(1),f=(i(17),i(18),i(16),i(9)),y=i(896),v=function(e){Object(u.a)(i,e);var t=Object(o.a)(i);function i(){return Object(n.a)(this,i),t.apply(this,arguments)}return i}(i(25).a),j=v=Object(l.a)([Object(f.a)("esri.views.layers.support.ClipArea")],v),O=a=function(e){Object(u.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).type="rect",e.left=null,e.right=null,e.top=null,e.bottom=null,e}return Object(r.a)(i,[{key:"clone",value:function(){return new a({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}},{key:"version",get:function(){return(this._get("version")||0)+1}}]),i}(j);Object(l.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],O.prototype,"left",void 0),Object(l.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],O.prototype,"right",void 0),Object(l.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],O.prototype,"top",void 0),Object(l.a)([Object(b.b)({type:[Number,String],json:{write:!0}})],O.prototype,"bottom",void 0),Object(l.a)([Object(b.b)({readOnly:!0})],O.prototype,"version",null);var w,g=O=a=Object(l.a)([Object(f.a)("esri.views.layers.support.ClipRect")],O),m=(i(112),i(173)),_=i(77),k=i(61),R=i(147),q={base:m.a,key:"type",typeMap:{extent:k.a,polygon:R.a}},S=w=function(e){Object(u.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).type="geometry",e.geometry=null,e}return Object(r.a)(i,[{key:"version",get:function(){return(this._get("version")||0)+1}},{key:"clone",value:function(){return new w({geometry:this.geometry.clone()})}}]),i}(j);Object(l.a)([Object(b.b)({types:q,json:{read:_.a,write:!0}})],S.prototype,"geometry",void 0),Object(l.a)([Object(b.b)({readOnly:!0})],S.prototype,"version",null);var V=S=w=Object(l.a)([Object(f.a)("esri.views.layers.support.Geometry")],S),x=function(e){Object(u.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).type="path",e.path=[],e}return Object(r.a)(i,[{key:"version",get:function(){return(this._get("version")||0)+1}}]),i}(j);Object(l.a)([Object(b.b)({type:[[[Number]]],json:{write:!0}})],x.prototype,"path",void 0),Object(l.a)([Object(b.b)({readOnly:!0})],x.prototype,"version",null);var M=x=Object(l.a)([Object(f.a)("esri.views.layers.support.Path")],x),T=h.a.ofType({key:"type",base:j,typeMap:{rect:g,path:M,geometry:V}}),I=function(e){var t=function(e){Object(u.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).clips=new T,e.moving=!1,e.attached=!1,e.lastUpdateId=-1,e.updateRequested=!1,e}return Object(r.a)(i,[{key:"initialize",value:function(){var e,t=this;this.container||(this.container=new y.a),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([Object(d.a)(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),Object(d.a)(this,["layer.opacity","container"],(function(){var e,i;t.container&&(t.container.opacity=null!=(e=null==(i=t.layer)?void 0:i.opacity)?e:1)}),!0),Object(d.a)(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),Object(d.a)(this,["layer.effect"],(function(e){t.container&&(t.container.effect=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))}},{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}},{key:"isVisibleAtScale",value:function(e){var t=!0,i=this.layer,a=i.minScale,n=i.maxScale;if(null!=a&&null!=n){var r=!a,s=!n;!r&&e<=a&&(r=!0),!s&&e>=n&&(s=!0),t=r&&s}return t}},{key:"requestUpdate",value:function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}},{key:"processUpdate",value:function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}},{key:"isUpdating",value:function(){return!1}},{key:"isRendering",value:function(){return!1}},{key:"canResume",value:function(){return!!Object(s.a)(Object(c.a)(i.prototype),"canResume",this).call(this)&&this.isVisibleAtScale(this.view.scale)}}]),i}(e);return Object(l.a)([Object(b.b)({type:T,set:function(e){var t=Object(p.b)(e,this._get("clips"),T);this._set("clips",t)}})],t.prototype,"clips",void 0),Object(l.a)([Object(b.b)()],t.prototype,"moving",void 0),Object(l.a)([Object(b.b)()],t.prototype,"attached",void 0),Object(l.a)([Object(b.b)()],t.prototype,"container",void 0),Object(l.a)([Object(b.b)()],t.prototype,"suspended",void 0),Object(l.a)([Object(b.b)({readOnly:!0})],t.prototype,"updateParameters",void 0),Object(l.a)([Object(b.b)()],t.prototype,"updateRequested",void 0),Object(l.a)([Object(b.b)()],t.prototype,"updating",null),Object(l.a)([Object(b.b)()],t.prototype,"view",void 0),t=Object(l.a)([Object(f.a)("esri.views.2d.layers.LayerView2D")],t)}},908:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var a=i(3),n=i(4),r=i(6),s=i(7),c=i(0),u=i(16),o=i(23),l=i(27),h=i(1),p=(i(17),i(18),i(9)),d=function(e){var t=function(e){Object(r.a)(i,e);var t=Object(s.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(n.a)(i,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(l.b)(this,"layer","refresh",(function(){e.doRefresh().catch((function(t){Object(o.n)(t)||u.a.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),i}(e);return Object(c.a)([Object(h.b)()],t.prototype,"layer",void 0),t=Object(c.a)([Object(p.a)("esri.layers.mixins.RefreshableLayerView")],t)}}}]);
//# sourceMappingURL=106.e2b91c50.chunk.js.map