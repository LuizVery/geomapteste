{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/FeatureLayerView.js","../node_modules/@arcgis/core/views/layers/support/FeatureEffect.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/layers/support/FeatureFilter.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"names":["_","r","getLogger","P","e","_updatingRequiredFieldsPromise","effect","filter","timeExtent","layer","requiredFields","view","n","this","_handleRequiredFieldsChange","l","t","fieldsIndex","outFields","d","m","error","Error","returnGeometry","outSpatialReference","spatialReference","i","createQuery","b","type","R","where","intersection","clone","get","E","_updateRequiredFields","_set","then","a","s","objectIdField","renderer","orderBy","featureReduction","u","Set","o","collectRequiredFields","c","f","y","h","F","p","timeInfo","w","startField","endField","floorInfo","floorField","g","subtypeField","sublayers","map","Promise","all","displayField","Array","from","sort","clientGraphics","popupEnabled","q","length","resolve","createPopupQuery","_loadArcadeModules","arcadeUtils","hasGeometryOperations","x","push","objectIds","attributes","queryFeatures","concat","features","catch","geometryType","I","add","returnZ","returnM","isEmpty","prototype","readOnly","v","j","Number","Boolean","arguments","includedEffect","excludedEffect","excludedLabelsVisible","json","write","handles","doRefresh","declaredClass","esriSpatialRelIntersects","esriSpatialRelContains","esriSpatialRelCrosses","esriSpatialRelDisjoint","esriSpatialRelEnvelopeIntersects","esriSpatialRelIndexIntersects","esriSpatialRelOverlaps","esriSpatialRelTouches","esriSpatialRelWithin","esriSpatialRelRelation","esriSRUnit_Meter","esriSRUnit_Kilometer","esriSRUnit_Foot","esriSRUnit_StatuteMile","esriSRUnit_NauticalMile","esriSRUnit_USNauticalMile","geometry","spatialRelationship","hiddenIds","distance","units","enabled","forEach","String","types","read","source","reader","target","writer","overridePolicy","popupTemplate","getRequiredFields","lastEditInfoEnabled","typeIdField","globalIdField","relationships","includes","has","indexOf","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate"],"mappings":"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","file":"static/js/7.57dd45d1.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{isSome as i,isNone as s}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{init as n,on as l}from\"../../core/watchUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as u}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import{fixFields as d,unpackFieldNames as m,collectLabelingFields as c,collectElevationFields as f,collectFilterFields as y,collectFeatureReductionFields as h,collectOrderByInfos as F,collectFields as w,collectField as g,featureHasFields as x}from\"../../layers/support/fieldUtils.js\";import b from\"../../rest/support/Query.js\";import{loadArcade as E}from\"../../support/arcadeOnDemand.js\";import v from\"./support/FeatureEffect.js\";import j from\"./support/FeatureFilter.js\";import{getFetchPopupTemplate as q,getRequiredFields as I}from\"./support/popupUtils.js\";import{getFloorFilterClause as R}from\"../support/floorFilterUtils.js\";const _=r.getLogger(\"esri.views.layers.FeatureLayerView\"),P=r=>{let P=class extends r{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.effect=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){n(this,[\"layer.renderer\",\"layer.labelingInfo\",\"layer.elevationInfo.featureExpressionInfo\",\"layer.displayField\",\"filter\",\"effect\",\"layer.timeInfo\",\"layer.floorInfo\",\"timeExtent\"],(()=>this._handleRequiredFieldsChange()),!0),l(this,\"view.floors\",\"change\",(()=>this._handleRequiredFieldsChange())),l(this,\"layer.sublayer\",\"change\",(()=>this._handleRequiredFieldsChange()))}get availableFields(){const{layer:e,layer:{fieldsIndex:t},requiredFields:r}=this;return\"outFields\"in e&&e.outFields?d(t,[...m(t,e.outFields),...r]):d(t,r)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){_.error(\"#maximumNumberOfFeatures=\",\"Setting maximum number of features is not supported\")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error(\"missing implementation\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=i(this.filter)?this.filter.createQuery(e):new b(e);if(\"feature\"===this.layer.type){const e=R(this);i(e)&&(t.where=t.where?`(${t.where}) AND (${e})`:e)}return i(this.timeExtent)&&(t.timeExtent=i(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}queryFeatures(e,t){throw new Error(\"missing implementation\")}queryObjectIds(e,t){throw new Error(\"missing implementation\")}queryFeatureCount(e,t){throw new Error(\"missing implementation\")}queryExtent(e,t){throw new Error(\"missing implementation\")}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return E()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set(\"_updatingRequiredFieldsPromise\",e),e.then((()=>{this._updatingRequiredFieldsPromise===e&&this._set(\"_updatingRequiredFieldsPromise\",null)}))}async _updateRequiredFields(){if(!this.layer||!this.view)return;const e=\"3d\"===this.view.type,{layer:t,layer:{fieldsIndex:r,objectIdField:s}}=this,n=\"renderer\"in t&&t.renderer,l=\"orderBy\"in t&&t.orderBy,a=t.featureReduction,u=new Set,p=await o([n?n.collectRequiredFields(u,r):null,c(u,t),e?f(u,t):null,i(this.filter)?y(u,t,this.filter):null,this.effect?y(u,t,this.effect.filter):null,a?h(u,t,a):null,l?F(u,t,l):null]);if(t.timeInfo&&this.timeExtent&&w(u,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),\"feature\"===t.type&&t.floorInfo&&w(u,t.fieldsIndex,[t.floorInfo.floorField]),\"subtype-group\"===t.type){g(u,r,t.subtypeField);const e=t.sublayers.map((e=>{var t;return Promise.all([null==(t=e.renderer)?void 0:t.collectRequiredFields(u,r),c(u,e)])}));await o(e)}for(const i of p)i.error&&_.error(i.error);g(u,r,s),e&&\"displayField\"in t&&t.displayField&&g(u,r,t.displayField);const d=Array.from(u).sort();this._set(\"requiredFields\",d)}validateFetchPopupFeatures(e){if(s(e))return null;for(const r of e.clientGraphics){const i=r.layer;if(\"popupEnabled\"in i&&!i.popupEnabled)return new t(\"featurelayerview:fetchPopupFeatures\",\"Popups are disabled\",{layer:i});if(\"popupTemplate\"in i){if(!q(i,e))return new t(\"featurelayerview:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:i})}}}async fetchClientPopupFeatures(e){const t=i(e)?e.clientGraphics:null;if(!t||0===t.length)return Promise.resolve([]);const r=[],s=[],o=await this.createPopupQuery(e);for(const n of t){const{layer:t}=n;if(!(\"popupEnabled\"in t))continue;const l=m(this.layer.fieldsIndex,o.outFields),a=q(t,e);if(!i(a))continue;const u=await this._loadArcadeModules(a);u&&u.arcadeUtils.hasGeometryOperations(a)||!x(l,n)?s.push(n):r.push(n)}return\"stream\"===this.layer.type||0===s.length?Promise.resolve(r):(o.objectIds=s.map((e=>e.attributes[this.layer.objectIdField])),this.layer.queryFeatures(o).then((e=>r.concat(e.features))).catch((()=>s)))}async createPopupQuery(e){const t=this.layer.createQuery(),r=new Set;let s=!1;const o=i(e)&&e.clientGraphics?e.clientGraphics.map((e=>e.layer)):[this.layer];for(const n of o){if(!(\"popupEnabled\"in n))continue;const t=q(n,e);if(!i(t))continue;const o=await this._loadArcadeModules(t),l=o&&o.arcadeUtils.hasGeometryOperations(t);s=!(\"point\"!==this.layer.geometryType&&!l);const a=await I(this.layer,t);for(const e of a)r.add(e)}if(t.returnGeometry=s,t.returnZ=s,t.returnM=s,t.outFields=Array.from(r),t.outSpatialReference=this.view.spatialReference,\"feature\"===this.layer.type){const e=R(this);i(e)&&(t.where=t.where?`(${t.where}) AND (${e})`:e)}return t}canResume(){return!!super.canResume()&&(!i(this.timeExtent)||!this.timeExtent.isEmpty)}};return e([a()],P.prototype,\"_updatingRequiredFieldsPromise\",void 0),e([a({readOnly:!0})],P.prototype,\"availableFields\",null),e([a({type:v})],P.prototype,\"effect\",void 0),e([a({type:j})],P.prototype,\"filter\",void 0),e([a(p)],P.prototype,\"timeExtent\",void 0),e([a()],P.prototype,\"layer\",void 0),e([a({type:Number})],P.prototype,\"maximumNumberOfFeatures\",null),e([a({readOnly:!0,type:Boolean})],P.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([a({readOnly:!0})],P.prototype,\"requiredFields\",void 0),e([a()],P.prototype,\"suspended\",void 0),e([a()],P.prototype,\"view\",void 0),P=e([u(\"esri.views.layers.FeatureLayerView\")],P),P};export{P as FeatureLayerView,P as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../../../core/JSONSupport.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./FeatureFilter.js\";var i;let c=i=class extends t{constructor(){super(...arguments),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}clone(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};e([r({type:s,json:{write:!0}})],c.prototype,\"filter\",void 0),e([r({json:{write:!0}})],c.prototype,\"includedEffect\",void 0),e([r({json:{write:!0}})],c.prototype,\"excludedEffect\",void 0),e([r({type:Boolean,json:{write:!0}})],c.prototype,\"excludedLabelsVisible\",void 0),c=i=e([o(\"esri.views.layers.support.FeatureEffect\")],c);var l=c;export{l as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";const a=a=>{let c=class extends a{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(()=>{this.doRefresh().catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([i(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{a as RefreshableLayerView,a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{geometryTypes as t}from\"../../../geometry.js\";import r from\"../../../TimeExtent.js\";import{JSONMap as i}from\"../../../core/jsonMap.js\";import{JSONSupport as s}from\"../../../core/JSONSupport.js\";import{clone as o}from\"../../../core/lang.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{writer as p}from\"../../../core/accessorSupport/decorators/writer.js\";import{fromJSON as l}from\"../../../geometry/support/jsonUtils.js\";import c from\"../../../rest/support/Query.js\";var d;const m=new i({esriSpatialRelIntersects:\"intersects\",esriSpatialRelContains:\"contains\",esriSpatialRelCrosses:\"crosses\",esriSpatialRelDisjoint:\"disjoint\",esriSpatialRelEnvelopeIntersects:\"envelope-intersects\",esriSpatialRelIndexIntersects:\"index-intersects\",esriSpatialRelOverlaps:\"overlaps\",esriSpatialRelTouches:\"touches\",esriSpatialRelWithin:\"within\",esriSpatialRelRelation:\"relation\"}),u=new i({esriSRUnit_Meter:\"meters\",esriSRUnit_Kilometer:\"kilometers\",esriSRUnit_Foot:\"feet\",esriSRUnit_StatuteMile:\"miles\",esriSRUnit_NauticalMile:\"nautical-miles\",esriSRUnit_USNauticalMile:\"us-nautical-miles\"});let h=d=class extends s{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship=\"intersects\",this.hiddenIds=new Set,this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null,this.enabled=!1}writeWhere(e,t){t.where=e||\"1=1\"}enable(){this._set(\"enabled\",!0)}createQuery(e={}){const{where:t,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:a,distance:p}=this;return new c({geometry:o(r),objectIds:o(n),spatialRelationship:i,timeExtent:o(s),where:t,units:a,distance:p,...e})}clone(){const{where:e,geometry:t,spatialRelationship:r,hiddenIds:i,timeExtent:s,objectIds:n,units:a,distance:p}=this,l=new Set;return i.forEach((e=>l.add(e))),new d({geometry:o(t),hiddenIds:l,objectIds:o(n),spatialRelationship:r,timeExtent:o(s),where:e,units:a,distance:p})}};e([n({type:String})],h.prototype,\"where\",void 0),e([p(\"where\")],h.prototype,\"writeWhere\",null),e([n({types:t,json:{read:l,write:!0}})],h.prototype,\"geometry\",void 0),e([n({type:String,json:{read:{source:\"spatialRel\",reader:m.read},write:{target:\"spatialRel\",writer:m.write}}})],h.prototype,\"spatialRelationship\",void 0),e([n({json:{write:(e,t,r)=>t[r]=Array.from(e),read:e=>new Set(e)}})],h.prototype,\"hiddenIds\",void 0),e([n({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],h.prototype,\"distance\",void 0),e([n({type:[Number],json:{write:!0}})],h.prototype,\"objectIds\",void 0),e([n({type:String,json:{read:u.read,write:{writer:u.write,overridePolicy(e){return{enabled:e&&this.distance>0}}}}})],h.prototype,\"units\",void 0),e([n({type:r,json:{write:!0}})],h.prototype,\"timeExtent\",void 0),e([n({readOnly:!0})],h.prototype,\"enabled\",void 0),h=d=e([a(\"esri.views.layers.support.FeatureFilter\")],h);var y=h;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n"],"sourceRoot":""}