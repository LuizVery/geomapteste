(function(){var e={"esri/portal/support/layersCreator":319,"esri/portal/support/portalLayers":1322,"esri/renderers/support/styleUtils":1408,"esri/layers/support/lazyLayerLoader":1411,"esri/portal/support/featureCollectionUtils":1505},r=this||window,t=r.webpackJsonp=r.webpackJsonp||[];t.registerAbsMids?t.registerAbsMids(e):(t.absMidsWaiting=t.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[49,9,80,93,100],{1322:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(0),t(33),t(11),t(4),t(1411),t(144),t(694)],void 0===(i=function(e,r,t,n,i,a,o,s,l){function c(e){switch(e.type){case"Map Service":return function(e){return function(e){return p(e.url).then((function(e){return e.tileInfo}))}(e).then((function(e){return e?{className:"TileLayer"}:{className:"MapImageLayer"}}))}(e);case"Feature Service":return function(e){return y(e).then((function(e){if("object"==typeof e){var r={};return null!=e.id&&(r.layerId=e.id),{className:"FeatureLayer",properties:r}}return{className:"GroupLayer"}}))}(e);case"Feature Collection":return function(e){return t.__awaiter(this,void 0,void 0,(function(){var r;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,e.load()];case 1:return t.sent(),l.hasTypeKeyword(e,"Map Notes")?[2,{className:"MapNotesLayer"}]:l.hasTypeKeyword(e,"Route Layer")?[2,{className:"RouteLayer"}]:[4,e.fetchData()];case 2:return(r=t.sent())&&Array.isArray(r.layers)&&1===r.layers.length?[2,{className:"FeatureLayer"}]:[2,{className:"GroupLayer"}]}}))}))}(e);case"Scene Service":return function(e){return y(e).then((function(r){if("object"==typeof r){var t={},n=void 0;if(null!=r.id?(t.layerId=r.id,n=e.url+"/layers/"+r.id):n=e.url,Array.isArray(e.typeKeywords)&&e.typeKeywords.length>0)for(var i={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];if(-1!==e.typeKeywords.indexOf(s))return{className:i[s]}}return p(n).then((function(e){var r="SceneLayer",n={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};return e&&e.layerType&&n[e.layerType]&&(r=n[e.layerType]),{className:r,properties:t}}))}return{className:"GroupLayer"}}))}(e);case"Image Service":return function(e){var r,n,i;return t.__awaiter(this,void 0,void 0,(function(){var a,o,s,l;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,e.load()];case 1:return t.sent(),(a=null!==(n=null===(r=e.typeKeywords)||void 0===r?void 0:r.map((function(e){return e.toLowerCase()})))&&void 0!==n?n:[]).indexOf("elevation 3d layer")>-1?[2,{className:"ElevationLayer"}]:a.indexOf("tiled imagery")>-1?[2,{className:"ImageryTileLayer"}]:[4,e.fetchData()];case 2:return o=t.sent(),"ArcGISTiledImageServiceLayer"===(s=null==o?void 0:o.layerType)?[2,{className:"ImageryTileLayer"}]:"ArcGISImageServiceLayer"===s?[2,{className:"ImageryLayer"}]:[4,p(e.url)];case 3:return l=t.sent(),"map"===(null===(i=l.cacheType)||void 0===i?void 0:i.toLowerCase())?[2,{className:"ImageryTileLayer"}]:[2,{className:"ImageryLayer"}]}}))}))}(e);case"Stream Service":return{className:"StreamLayer"};case"Vector Tile Service":return{className:"VectorTileLayer"};case"KML":return{className:"KMLLayer"};case"WMTS":return{className:"WMTSLayer"};case"WMS":return{className:"WMSLayer"};default:return a.reject(new i("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type}))}}function u(e){return(0,o.layerLookupMap[e.className])().then((function(r){return{constructor:r,properties:e.properties}}))}function y(e){return!e.url||e.url.match(/\/\d+$/)?a.resolve({}):e.load().then((function(){return e.fetchData()})).then((function(r){return r&&Array.isArray(r.layers)?1===r.layers.length&&{id:r.layers[0].id}:p(e.url).then((function(e){return e&&Array.isArray(e.layers)?1===e.layers.length&&{id:e.layers[0].id}:{}}))}))}function p(e){return n(e,{responseType:"json",query:{f:"json"}}).then((function(e){return e.data}))}Object.defineProperty(r,"__esModule",{value:!0}),r.fromItem=function(e){return!e.portalItem||e.portalItem instanceof s||(e=t.__assign(t.__assign({},e),{portalItem:new s(e.portalItem)})),(r=e.portalItem,r.load().then(c).then(u)).then((function(r){var n=t.__assign({portalItem:e.portalItem},r.properties),i=r.constructor;return a.resolve(new i(n))}));var r},r.selectLayerClassPath=c}.apply(null,n))||(e.exports=i)},1323:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(0),t(33),t(11),t(4),t(1411),t(69),t(711),t(1408)],void 0===(i=function(e,r,t,n,i,a,o,s,l,c){function u(e,r){return t.__awaiter(this,void 0,void 0,(function(){var n,i,a,o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:return n=e.instance,i=n.portalItem,a=i.url,o=i.title,s=l.createForItem(i),"group"===n.type?(n.read({title:o},s),[2,y(n,e)]):(a&&n.read({url:a},s),[4,d(e,r)]);case 1:return(u=t.sent())&&n.read(u,s),n.resourceReferences={portalItem:i,paths:s.readResourcePaths},n.read({title:o},s),[2,c.loadStyleRenderer(n,s)]}}))}))}function y(e,r){var t,s,l=e.portalItem.type;switch(l){case"Feature Service":t=o.layerLookupMap.FeatureLayer;break;case"Stream Service":t=o.layerLookupMap.StreamLayer;break;case"Scene Service":t=o.layerLookupMap.SceneLayer;break;case"Feature Collection":t=o.layerLookupMap.FeatureLayer;break;default:throw new i("portal:unsupported-item-type-as-group","The item type '"+l+"' is not supported as a 'GroupLayer'")}return t().then((function(e){return s=e,d(r)})).then((function(r){return r&&Array.isArray(r.layers)?p(e,s,r):function(e,r){return e.portalItem.url?n(e.portalItem.url,{responseType:"json",query:{f:"json"}}).then((function(t){var n=t.data;if(n&&Array.isArray(n.layers)){var i=n.layers.map((function(e){return{id:e.id,name:e.name}}));return p(e,r,{layers:i})}})):a.resolve()}(e,s)}))}function p(e,r,t){var n=t.showLegend,i=t.layers.slice();i.reverse(),i.forEach((function(t){var i=new r({portalItem:e.portalItem,layerId:t.id,sublayerTitleMode:"service-name"});if("Feature Collection"===e.portalItem.type){var a={origin:"portal-item",portal:e.portalItem.portal||s.getDefault()};i.read(t,a),null!=n&&i.read({showLegend:n},a)}e.add(i)}))}function d(e,r){if(!1===e.supportsData)return a.resolve();var t=e.instance;return t.portalItem.fetchData("json",r).catch((function(){return null})).then((function(e){var r,n=e;if(function(e){return"stream"!==e.type&&"layerId"in e}(t)){var i=!0;if(e&&Array.isArray(n.layers)){null==t.layerId&&(t.layerId=n.layers[0].id);for(var a=0;a<n.layers.length;a++)if(n.layers[a].id===t.layerId){r=n.layers[a];break}r&&(1===n.layers.length&&(i=!1),null!=e.showLegend&&(r.showLegend=e.showLegend))}return i&&"service-name"!==t.sublayerTitleMode&&(t.sublayerTitleMode="item-title-and-service-name"),r}return e}))}Object.defineProperty(r,"__esModule",{value:!0}),r.load=function(e,r){return t.__awaiter(this,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return(n=e.instance.portalItem)&&n.id?[4,n.load(r)]:[2,a.resolve()];case 1:return t.sent(),function(e){var r=e.instance.portalItem;if(-1===e.supportedTypes.indexOf(r.type))throw new i("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:r.type,expectedType:e.supportedTypes.join(", ")})}(e),[2,u(e,r)]}}))}))}}.apply(null,n))||(e.exports=i)},1408:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(0),t(72),t(4),t(173)],void 0===(i=function(e,r,t,n,i,a){Object.defineProperty(r,"__esModule",{value:!0}),r.loadStyleRenderer=function(e,r,o){return t.__awaiter(this,void 0,void 0,(function(){var s,l,c;return t.__generator(this,(function(t){switch(t.label){case 0:return(s=e&&e.getAtOrigin&&e.getAtOrigin("renderer",r.origin))&&"unique-value"===s.type&&s.styleOrigin?[4,n.result(s.populateFromStyle())]:[3,2];case 1:l=t.sent(),i.throwIfAborted(o),!1===l.ok&&(c=l.error,r&&r.messages&&r.messages.push(new a("renderer:style-reference","Failed to create unique value renderer from style reference: "+c.message,{error:c,context:r})),e.clear("renderer",r.origin)),t.label=2;case 2:return[2]}}))}))}}.apply(null,n))||(e.exports=i)},1411:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(14)],void 0===(i=function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.layerLookupMap={BingMapsLayer:function(){return new Promise((function(e,r){t.e(96).then(function(){var r=[t(1548)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},BuildingSceneLayer:function(){return new Promise((function(e,r){t.e(37).then(function(){var r=[t(1549)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},CSVLayer:function(){return new Promise((function(e,r){Promise.all([t.e(4),t.e(90)]).then(function(){var r=[t(1551)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},ElevationLayer:function(){return new Promise((function(e,r){Promise.resolve().then(function(){var r=[t(429)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},FeatureLayer:function(){return new Promise((function(e,r){t.e(4).then(function(){var r=[t(1321)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},GroupLayer:function(){return new Promise((function(e,r){t.e(24).then(function(){var r=[t(1494)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},GeoRSSLayer:function(){return new Promise((function(e,r){t.e(107).then(function(){var r=[t(1552)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},ImageryLayer:function(){return new Promise((function(e,r){Promise.all([t.e(10),t.e(41)]).then(function(){var r=[t(1553)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},ImageryTileLayer:function(){return new Promise((function(e,r){Promise.all([t.e(10),t.e(34)]).then(function(){var r=[t(1554)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},IntegratedMeshLayer:function(){return new Promise((function(e,r){t.e(78).then(function(){var r=[t(1555)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},KMLLayer:function(){return new Promise((function(e,r){t.e(91).then(function(){var r=[t(1556)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},MapImageLayer:function(){return new Promise((function(e,r){t.e(18).then(function(){var r=[t(1496)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},MapNotesLayer:function(){return new Promise((function(e,r){Promise.all([t.e(4),t.e(108)]).then(function(){var r=[t(1557)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},OpenStreetMapLayer:function(){return new Promise((function(e,r){t.e(92).then(function(){var r=[t(1558)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},PointCloudLayer:function(){return new Promise((function(e,r){t.e(33).then(function(){var r=[t(1559)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},RouteLayer:function(){return new Promise((function(e,r){Promise.all([t.e(4),t.e(109)]).then(function(){var r=[t(1560)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},SceneLayer:function(){return new Promise((function(e,r){Promise.all([t.e(4),t.e(79)]).then(function(){var r=[t(1561)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},StreamLayer:function(){return new Promise((function(e,r){t.e(43).then(function(){var r=[t(1562)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},TileLayer:function(){return new Promise((function(e,r){Promise.resolve().then(function(){var r=[t(696)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},UnknownLayer:function(){return new Promise((function(e,r){t.e(110).then(function(){var r=[t(1563)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},UnsupportedLayer:function(){return new Promise((function(e,r){t.e(111).then(function(){var r=[t(1564)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},VectorTileLayer:function(){return new Promise((function(e,r){Promise.resolve().then(function(){var r=[t(699)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},WebTileLayer:function(){return new Promise((function(e,r){t.e(97).then(function(){var r=[t(1451)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},WMSLayer:function(){return new Promise((function(e,r){t.e(83).then(function(){var r=[t(1565)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))},WMTSLayer:function(){return new Promise((function(e,r){t.e(68).then(function(){var r=[t(1566)];e.apply(null,r)}.bind(this)).catch(r.bind(this))}))}}}.apply(null,n))||(e.exports=i)},1463:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(11),t(1621),t(1509),t(1510),t(1511),t(1512),t(1622)],void 0===(i=function(e,r,t,n,i,a,o,s,l){Object.defineProperty(r,"__esModule",{value:!0});var c=new n({allErrors:!0,extendRefs:!0});r.validate=function(e,r){return c.validate(e,function(e){switch(e){case"building-scene":return i.json;case"integrated-mesh":return a.json;case"point-cloud":return o.json;case"scene":return s.json;default:throw new t("poratlitemlayertype:unknown","Can not validate against unknown PortalItemLayerType.")}}(r))?[]:l.convertAjvErrors(c.errors)}}.apply(null,n))||(e.exports=i)},1505:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(0),t(144),t(694)],void 0===(i=function(e,r,t,n,i){function a(e,r,a,o){return t.__awaiter(this,void 0,void 0,(function(){var s;return t.__generator(this,(function(t){switch(t.label){case 0:return e.layerType&&"ArcGISFeatureLayer"===e.layerType?e.url?[2,!1]:e.featureCollectionType&&e.featureCollectionType===a?[2,!0]:e.itemId?[4,(s=new n({id:e.itemId,portal:r})).load()]:[3,2]:[2,!1];case 1:return t.sent(),[2,"Feature Collection"===s.type&&i.hasTypeKeyword(s,o)];case 2:return[2,!1]}}))}))}Object.defineProperty(r,"__esModule",{value:!0}),r.isMapNotesLayer=function(e,r){return a(e,r,"notes","Map Notes")},r.isRouteLayer=function(e,r){return a(e,r,"route","Route Layer")}}.apply(null,n))||(e.exports=i)},1509:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(1438)],void 0===(i=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.json={title:"Scene Layer config on layer item",type:"object",properties:{layers:{type:"array",items:{properties:{activeFilterId:{type:"string",description:"specifies the id of the currently active filter"},filters:{type:"array",description:"A list of filters available for this layer. Overrides filters defined on the service.",items:{type:"object",$ref:"#/definitions/buildingSceneLayer_filter_schema.json"},uniqueItems:!0},id:{type:"number",description:"ID of the service layer."},layerDefinition:{type:"object",description:"Additional properties that can define an elevation offset for the layer.",allOf:[{$ref:"#/definitions/layerDefinition_schema.json"},{properties:{elevationInfo:{},minScale:{},maxScale:{}},additionalProperties:!1}]},listMode:{type:"string",description:"To show or hide the sublayer in the layer list. If the layer has sublayers, selecting `hide-children` will hide them in the layer list.",enum:["hide","hide-children","show"]},opacity:{type:"number",description:"The degree of transparency applied to the layer on the client side, where 0 is full transparency and 1 is no transparency.",minimum:0,maximum:1,default:1},popupInfo:{type:"object",description:"A popupInfo object defining the content of pop-up windows when you click or query a feature.",$ref:"#/definitions/popupInfo_schema.json"},sublayers:{type:"array",description:"An array of objects specifying overrides for building scene layer sublayers",items:{type:"object",$ref:"#/definitions/buildingSceneLayer_sublayer_schema.json"},uniqueItems:!0},visibility:{type:"boolean",description:"Boolean property determining whether the layer is initially visible in the web scene",default:!0}},additionalProperties:!1}}},additionalProperties:!1,definitions:t.schema_definitions}}.apply(null,n))||(e.exports=i)},1510:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(1438)],void 0===(i=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.json={title:"Integrated Mesh Layer config on layer item",type:"object",properties:{layers:{type:"array",items:{properties:{id:{type:"number",description:"ID of the service layer."},layerDefinition:{type:"object",description:"A layerDefinition object defining the attribute schema and drawing information for the layer.",allOf:[{$ref:"#/definitions/layerDefinition_schema.json"},{properties:{elevationInfo:{},minScale:{},maxScale:{}},additionalProperties:!1}]},listMode:{type:"string",enum:["hide","show"]},modifications:{type:"string",description:"URL to modifications json file, typically stored in `ITEM/resources`. Content of the file follows the $ref:[Modifications schema](modifications_schema.json)."},opacity:{type:"number",description:"The degree of transparency applied to the layer on the client side, where 0 is full transparency and 1 is no transparency.",minimum:0,maximum:1,default:1},visibility:{type:"boolean",description:"Boolean property determining whether the layer is initially visible in the web scene.",default:!0}},additionalProperties:!1}}},additionalProperties:!1,definitions:t.schema_definitions}}.apply(null,n))||(e.exports=i)},1511:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(1438)],void 0===(i=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.json={title:"PointCloud Layer config on layer item",type:"object",properties:{layers:{type:"array",items:{properties:{disablePopup:{type:"boolean",description:"disablePopups allows a client to ignore popups defined by the service item."},id:{type:"number",description:"ID of the service layer."},layerDefinition:{type:"object",description:"A layerDefinition object defining the attribute schema and drawing information for the layer.",allOf:[{$ref:"#/definitions/layerDefinition_schema.json"},{properties:{drawingInfo:{allOf:[{$ref:"#/definitions/drawingInfo_schema.json"},{properties:{renderer:{},transparency:{}},additionalProperties:!1}]},elevationInfo:{},filters:{},minScale:{},maxScale:{}},additionalProperties:!1}]},listMode:{type:"string",description:"To show or hide the layer in the layer list",enum:["hide","show"]},popupInfo:{type:"object",description:"A popupInfo object defining the content of pop-up windows when you click a point.",$ref:"#/definitions/popupInfo_schema.json"},showLegend:{type:"boolean",description:"Boolean value indicating whether to display the layer in the legend. Default value is `true`.",default:!0},visibility:{type:"boolean",description:"Boolean property determining whether the layer is initially visible",default:!0}},additionalProperties:!1}}},additionalProperties:!1,definitions:t.schema_definitions}}.apply(null,n))||(e.exports=i)},1512:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(1438)],void 0===(i=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.json={title:"Scene Layer config on layer item",type:"object",properties:{layers:{type:"array",items:{properties:{disablePopup:{type:"boolean",description:"disablePopups allows a client to ignore popups defined by the service item."},id:{type:"number",description:"ID of the service layer."},layerDefinition:{type:"object",description:"A layerDefinition object defining the attribute schema and drawing information for the layer.",allOf:[{$ref:"#/definitions/layerDefinition_schema.json"},{properties:{definitionExpression:{},drawingInfo:{},elevationInfo:{},featureReduction:{},minScale:{},maxScale:{},rangeInfos:{}},additionalProperties:!1}]},listMode:{type:"string",description:"To show or hide layers in the layer list",enum:["hide","show"]},opacity:{type:"number",description:"The degree of transparency applied to the layer on the client side, where 0 is full transparency and 1 is no transparency.",minimum:0,maximum:1,default:1},popupInfo:{type:"object",description:"A popupInfo object defining the content of pop-up windows when you click or query a feature.",$ref:"#/definitions/popupInfo_schema.json"},screenSizePerspective:{type:"boolean",description:"Apply [perspective scaling](https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-FeatureLayer.html#screenSizePerspectiveEnabled) to screen-size symbols.",default:!1},showLabels:{type:"boolean",description:"If the layer has a labelingInfo property then labels show on the scene only if the showLabels property it true.",default:!1},showLegend:{type:"boolean",description:"Boolean value indicating whether to display the layer in the legend. Default value is `true`.",default:!0},visibility:{type:"boolean",description:"Boolean property determining whether the layer is initially visible in the web scene",default:!0}},additionalProperties:!1}}},additionalProperties:!1,definitions:t.schema_definitions}}.apply(null,n))||(e.exports=i)},319:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t(0),t(23),t(25),t(4),t(1411),t(144),t(1505),t(1322),t(1408)],void 0===(i=function(e,r,t,n,i,a,o,s,l,c,u){Object.defineProperty(r,"__esModule",{value:!0});var y=i("esri-debug-messages"),p={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",BuildingSceneLayer:"BuildingSceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer",KML:"KMLLayer",RasterDataLayer:"UnsupportedLayer"},d={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer",RasterDataElevationLayer:"UnsupportedLayer"},f={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",VectorTileLayer:"VectorTileLayer",ArcGISImageServiceLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},h={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",VectorTileLayer:"VectorTileLayer",GroupLayer:"GroupLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",GeoRSS:"GeoRSSLayer",KML:"KMLLayer",WFS:"UnsupportedLayer",SubtypeGroupLayer:"UnsupportedLayer",WMS:"WMSLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",DefaultTileLayer:"TileLayer"},m={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"};function L(e,r,n){return t.__awaiter(this,void 0,void 0,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return(i=new e).read(r,n.context),"group"===i.type&&g(r)?[4,S(i,r,n.context)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,u.loadStyleRenderer(i,n.context)];case 3:return t.sent(),[2,i]}}))}))}function v(e,r){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,b(e,r)];case 1:return[2,L(t.sent(),e,r)]}}))}))}function b(e,r){return t.__awaiter(this,void 0,void 0,(function(){var n,i,a,u,y,L,v,b,I;return t.__generator(this,(function(t){switch(t.label){case 0:return n=r.context,i=function(e){var r;switch(e.origin){case"web-scene":switch(e.layerContainerType){case"basemap":r=f;break;case"ground":r=d;break;default:r=p}break;default:switch(e.layerContainerType){case"basemap":r=m;break;default:r=h}}return r}(n),!(a=e.layerType||e.type)&&r&&r.defaultLayerType&&(a=r.defaultLayerType),u=i[a],y=u?o.layerLookupMap[u]:o.layerLookupMap.UnknownLayer,L=n&&n.portal,w(e)?e.itemId?[4,(v=new s({id:e.itemId,portal:L})).load()]:[3,3]:[3,4];case 1:return t.sent(),[4,c.selectLayerClassPath(v)];case 2:b=t.sent(),I=b.className||"UnknownLayer",y=o.layerLookupMap[I],t.label=3;case 3:return[3,8];case 4:return"ArcGISFeatureLayer"!==a?[3,8]:[4,l.isMapNotesLayer(e,L)];case 5:return t.sent()?(y=o.layerLookupMap.MapNotesLayer,[3,8]):[3,6];case 6:return[4,l.isRouteLayer(e,L)];case 7:t.sent()?y=o.layerLookupMap.RouteLayer:g(e)&&(y=o.layerLookupMap.GroupLayer),t.label=8;case 8:return e.wmtsInfo&&e.wmtsInfo.url&&e.wmtsInfo.layerIdentifier&&(y=o.layerLookupMap.WMTSLayer),[2,y()]}}))}))}function g(e){if("ArcGISFeatureLayer"!==e.layerType||w(e))return!1;var r=e.featureCollection;return!!(r&&r.layers&&r.layers.length>1)}function w(e){return"Feature Collection"===e.type}function I(e,r,i){return t.__awaiter(this,void 0,void 0,(function(){var a,o,s;return t.__generator(this,(function(t){switch(t.label){case 0:return a=new n,o=M(a,Array.isArray(r.layers)?r.layers:[],i),[4,e];case 1:return s=t.sent(),[4,o];case 2:return t.sent(),"group"===s.type?(s.layers.addMany(a),[2,s]):[2,void 0]}}))}))}function S(e,r,n){return t.__awaiter(this,void 0,void 0,(function(){var i,a,s,l;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,(0,o.layerLookupMap.FeatureLayer)()];case 1:return i=t.sent(),a=r.featureCollection,s=a.showLegend,l=a.layers.map((function(e){var r=new i;return r.read(e,n),null!=s&&r.read({showLegend:s},n),r})),e.layers.addMany(l),[2]}}))}))}function M(e,r,n){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,l,c,u,p,d,f;return t.__generator(this,(function(t){switch(t.label){case 0:if(!r)return[2];for(i=[],o=0,s=r;o<s.length;o++)l=s[o],c=v(l,n),"GroupLayer"===l.layerType?i.push(I(c,l,n)):i.push(c);return[4,a.eachAlways(i)];case 1:for(u=t.sent(),p=0,d=u;p<d.length;p++)f=d[p],y&&f.error?console.error(f.error.toString?f.error.toString():f.error):!f.value||n.filter&&!n.filter(f.value)||e.add(f.value);return[2]}}))}))}r.createLayer=v,r.populateOperationalLayers=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return[2,M(e,r,n)]}))}))}}.apply(null,n))||(e.exports=i)}}]);